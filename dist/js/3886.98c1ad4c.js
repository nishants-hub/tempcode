"use strict";(self.webpackChunkconstruction_commercial_search_frontend=self.webpackChunkconstruction_commercial_search_frontend||[]).push([[3886],{53886:function(t,e,s){s.r(e),s.d(e,{default:function(){return r}});var i=(s(44114),s(17642),s(58004),s(33853),s(45876),s(32475),s(15024),s(31698),s(49659)),o=s(93518),a={props:{products:{type:Array,required:!0},quotationFiles:{type:Array,required:!0}},components:{GeneralForm:()=>s.e(6277).then(s.bind(s,76277)),GeneralCheckbox:()=>s.e(9002).then(s.bind(s,39002)),GeneralFileUpload:()=>s.e(7259).then(s.bind(s,37259)),ClassicTable:()=>s.e(440).then(s.bind(s,30440)),GeneralRemovableItem:()=>s.e(7349).then(s.bind(s,57349)),FileActions:()=>s.e(9667).then(s.bind(s,99667))},data(){return{selectedProducts:[],quotationFileData:this.quotationFiles,quotationHeaders:[{key:"file",value:"File",sortable:!1},{key:"products",value:"Products",sortable:!1},{key:"action",value:"",sortable:!1}]}},watch:{quotationFiles(){this.quotationFiles&&(this.quotationFileData=this.quotationFiles)}},computed:{getNotSelectedProducts(){const t=new Set(this.quotationFileData.flatMap((t=>t.products.map((t=>t._id)))));return this.products.filter((e=>!t.has(e?._id)))},acceptedFileTypes:()=>i.Z?.QUOTATION?.ALLOWED_FILE_EXTENSIONS},methods:{...(0,o.i0)("utils",["getFileBlob"]),handleSelect(t){this.selectedProducts.includes(t._id)?this.selectedProducts=this.selectedProducts.filter((e=>e!==t._id)):this.selectedProducts.push(t._id)},processFiles(t){if(0===this.selectedProducts?.length)return this.$toast.error("Please select at least one product for uploading quotation");t.forEach((t=>{this.quotationFileData.unshift({file:t,products:this.products.filter((t=>this.selectedProducts.includes(t?._id)))})})),this.selectedProducts=[]},removeQuotation(t){this.quotationFileData.splice(t,1)},removeProductQuotation(t){this.quotationFileData=this.quotationFileData.map((e=>({...e,products:e.products?.filter((e=>e?._id!==t?._id))})))?.filter((t=>t?.products?.length>0))},handleClose(){this.$bus.$emit("product-quotation-select-modal",!1)},handleSubmit(){this.$bus.$emit("attach-quotations-to-status-form",this.quotationFileData),this.handleClose()}}},n=a,l=(0,s(81656).A)(n,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex h-full min-h-[500px] w-full flex-col"},[e("GeneralForm",{staticClass:"flex-1",attrs:{heading:"Quotation Upload","sub-heading":"Select the products for which you want to upload quotation","show-close-button":!0,"submit-button-label":"Confirm"},on:{"close-pressed":t.handleClose,"form-submitted":t.handleSubmit},scopedSlots:t._u([{key:"form-body",fn:function(){return[e("div",{staticClass:"flex flex-wrap gap-spacing-300"},t._l(t.getNotSelectedProducts,(function(s){return e("div",{key:s?._id,staticClass:"flex cursor-pointer items-center gap-spacing-100 text-body/m/relaxed/400 text-content-on-neutral-primary",on:{click:function(e){return t.handleSelect(s)}}},[e("GeneralCheckbox",{attrs:{selected:t.selectedProducts?.includes(s._id)}}),e("p",[e("span",[t._v(t._s(s?.title))]),s?.variableName?e("span",[t._v(" - "+t._s(s?.variableName))]):t._e()])],1)})),0),t.getNotSelectedProducts?.length>0?e("GeneralFileUpload",{staticClass:"mt-spacing-300",attrs:{"accepted-file-types":t.acceptedFileTypes,"allow-multiple":!1,"aria-label":"Upload Quotation"},on:{"files-uploaded":t.processFiles}}):t._e(),t.quotationFileData?.length>0?e("ClassicTable",{staticClass:"mt-spacing-200",attrs:{headers:t.quotationHeaders,"horizontal-padding":"px-spacing-0",bgClass:"bg-transparent"},scopedSlots:t._u([{key:"table-body",fn:function(){return t._l(t.quotationFileData,(function(s,i){return e("tr",{key:i,staticClass:"border-b border-stroke-medium text-left text-body/m/relaxed/400 text-content-on-neutral-primary"},[e("td",{staticClass:"max-w-[200px] py-spacing-100 pr-spacing-100",class:s?.file?.isLink?"text-content-on-neutral-tertiary":"text-content-on-neutral-primary"},[e("p",[t._v(" "+t._s(s?.file?.name)+" "),s?.file?.isLink?t._e():e("span",{staticClass:"ml-spacing-50 rounded-04 bg-bg-status-success px-spacing-50 py-spacing-0 text-overline/s/relaxed/500 text-content-on-status-on-success"},[t._v(" NEW ")])])]),e("td",{staticClass:"py-spacing-100 pr-spacing-100"},[e("div",{staticClass:"flex flex-wrap items-center gap-spacing-50"},t._l(s?.products,(function(i){return e("div",{key:i?._id,staticClass:"text-content-on-neutral-primary"},[e("GeneralRemovableItem",{attrs:{"item-name":`${i?.title} - ${i?.variableName||"default[1]"}`,"is-disabled":s?.file?.isLink},on:{"on-item-removed":function(e){return t.removeProductQuotation(i)}}})],1)})),0)]),e("td",{staticClass:"py-spacing-100 pr-spacing-100"},[e("FileActions",{attrs:{file:s?.file},on:{remove:function(e){return t.removeQuotation(i)}}})],1)])}))},proxy:!0}],null,!1,1277690670)}):t._e()]},proxy:!0}])})],1)}),[],!1,null,null,null),r=l.exports},49659:function(t,e,s){s.d(e,{Z:function(){return i}});const i={DEFAULT:{MAX_FILE_SIZE:10485760,ALLOWED_FILE_EXTENSIONS:[".pdf",".doc",".docx",".xlsx",".xls",".png",".jpeg",".jpg",".txt",".gif",".bmp",".ppt",".pptx"],UPLOAD_DIRECTORY:"/storage/uploads"},QUOTATION:{MAX_FILE_SIZE:5242880,ALLOWED_FILE_EXTENSIONS:[".pdf",".doc",".docx",".xlsx",".xls",".png",".jpeg",".jpg",".txt",".gif",".bmp",".ppt",".pptx"],UPLOAD_DIRECTORY:"/storage/documents/quotations"},MARKET_RESEARCH_FILES:{MAX_FILE_SIZE:5242880,ALLOWED_FILE_EXTENSIONS:[".pdf",".doc",".docx",".xlsx",".xls",".png",".jpeg",".jpg",".txt",".gif",".bmp",".ppt",".pptx"],UPLOAD_DIRECTORY:"/storage/documents/files"},IMAGE:{MAX_FILE_SIZE:2097152,ALLOWED_FILE_EXTENSIONS:[".jpg",".jpeg",".png"],UPLOAD_DIRECTORY:"/storage/images"},EXTENSIONS:{DOC:[".doc",".docx",".html",".htm",".odt",".pdf",".xls",".xlsx",".ods",".ppt",".pptx",".txt"],IMAGE:[".png",".jpeg",".jpg",".gif",".bmp"]}}}}]);