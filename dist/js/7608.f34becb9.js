(self.webpackChunkconstruction_commercial_search_frontend=self.webpackChunkconstruction_commercial_search_frontend||[]).push([[7608],{47608:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var o=n(94010),r=n.n(o),i=n(77788),l={name:"SpreadsheetComponent",data:()=>({errorTracker:{},fieldValidations:{companyName:new i.s({minLength:5,maxLength:50,required:!1}),generalNumber:new i.s({minLength:19,maxLength:19,required:!1}),commercialNumber:new i.s({minLength:19,maxLength:19,required:!1}),email:new i.s({type:"EMAIL",required:!1}),annualRevenue:new i.s({type:"NUMBER",min:0})}}),mounted(){this.$bus.$on("clear-spreadsheet-data",(()=>{const e=this.$refs.spreadsheet.jexcel;if(e){const t=e.getConfig().columns,n=Array.from({length:60},(()=>Array.from({length:t.length},(()=>""))));e.setData(n)}})),this.initSpreadsheet()},components:{GeneralButton:()=>n.e(695).then(n.bind(n,90695))},methods:{initSpreadsheet(){const e=[{title:"Company Name",type:"text",width:300,key:"companyName"},{title:"General Number",type:"number",width:200,key:"generalNumber"},{title:"Commercial Number",type:"number",width:200,key:"commercialNumber"},{title:"Email",type:"text",width:200,key:"email"},{title:"Annual Revenue",type:"number",width:200,key:"annualRevenue"},{title:"Add to Main DB",type:"checkbox",width:150,key:"addToMainDB"}];r()(this.$refs.spreadsheet,{columns:e,columnSorting:!1,allowDeleteColumn:!1,allowDeletingAllRows:!1,allowInsertColumn:!1,allowRenameColumn:!1,allowManualInsertColumn:!1,about:!1,csvFileName:"Company Data",minDimensions:[6,10],wordWrap:!0,data:Array.from({length:60},(()=>Array.from({length:e.length},((e,t)=>{if(1===t||2===t)return"+0000 000 00 00 000"})))),onbeforechange:(t,n,o,r,i)=>{const l=n.getAttribute("data-x"),s=e[l]?.key,a=this.fieldValidations[s];if(["generalNumber","commercialNumber"].includes(s)){const e=this.formatPhoneNumber(i);return i!==e&&this.$refs.spreadsheet?.jexcel?.setValue(n,e),e}if(a){const e=a?.validate(i),t=`${r}-${o}`;e?(this.errorTracker[t]=e,n.style.backgroundColor="rgba(255, 0, 0, 0.6)",n.setAttribute("title",`Error: ${e}`)):(this.errorTracker[t]=void 0,delete this.errorTracker[t],n.style.backgroundColor="",n.removeAttribute("title"))}}})},getSpreadsheetData(){const e=this.$refs.spreadsheet.jexcel,t=e.getData(),n=e.getConfig().columns,o=t.map((e=>{const t=n.reduce(((t,n,o)=>(t[n.key]=e[o],t)),{});return t.companyName?t:null})).filter((e=>null!==e));return o},hasErrors(){return Object.keys(this.errorTracker)?.length>0},save(){if(this.hasErrors())return void this.$toast.error("Cannot save. Some cells have errors.");const e=this.getSpreadsheetData();this.$emit("spreadsheet-data",e)},formatPhoneNumber(e){if(!e)return"+0000 000 00 00 000";const t=e.replace(/\D/g,""),n="+0000 000 00 00 000".split("");let o=0;for(let e=0;e<n.length;e++)"0"===n[e]&&o<t.length&&(n[e]=t[o++]);return n.join("")}},beforeDestroy(){this.$bus.$off("clear-spreadsheet-data")}},s=l,a=(0,n(81656).A)(s,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex flex-col gap-spacing-200"},[t("GeneralButton",{attrs:{"button-type":"button",type:"success",size:"small",emphasis:"secondary","icon-position":"none",label:"Save"},nativeOn:{click:function(t){return e.save.apply(null,arguments)}}}),t("div",{ref:"spreadsheet"})],1)}),[],!1,null,null,null),c=a.exports},94010:function(module,__unused_webpack_exports,__webpack_require__){if(__webpack_require__(44114),__webpack_require__(16573),__webpack_require__(78100),__webpack_require__(77936),__webpack_require__(37467),__webpack_require__(44732),__webpack_require__(79577),__webpack_require__(14603),__webpack_require__(47566),__webpack_require__(98721),!jSuites)var jSuites=__webpack_require__(2397);var t;t=function(){var jspreadsheet;return function(){var __webpack_modules__={463:function(e){var t;e.exports=(function(){var e={765:function(e,t){var n;n=function(e){e.version="1.0.2";var t=Math;function n(e,t){for(var n=0,o=0;n<e.length;++n)o=t*o+e[n];return o}function o(e,t,n,o,r){if(0===t)return n;if(1===t)return o;for(var i=2/e,l=o,s=1;s<t;++s)l=o*s*i+r*n,n=o,o=l;return l}function r(e,t,n,r,i){return function(n,l){if(r){if(0===n)return 1==r?-1/0:1/0;if(n<0)return NaN}return 0===l?e(n):1===l?t(n):l<0?NaN:o(n,l|=0,e(n),t(n),i)}}var i,l,s,a,c,u,d,p,f,h,g,m,b,j=function(){var e=.636619772,r=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),s=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function a(o){var a=0,c=0,u=0,d=o*o;if(o<8)a=(c=n(r,d))/(u=n(i,d));else{var p=o-.785398164;c=n(l,d=64/d),u=n(s,d),a=t.sqrt(e/o)*(t.cos(p)*c-t.sin(p)*u*8/o)}return a}var c=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),u=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),d=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function f(o){var r=0,i=0,l=0,s=o*o,a=t.abs(o)-2.356194491;return Math.abs(o)<8?r=(i=o*n(c,s))/(l=n(u,s)):(i=n(d,s=64/s),l=n(p,s),r=t.sqrt(e/t.abs(o))*(t.cos(a)*i-t.sin(a)*l*8/t.abs(o)),o<0&&(r=-r)),r}return function e(n,r){if(r=Math.round(r),!isFinite(n))return isNaN(n)?n:0;if(r<0)return(r%2?-1:1)*e(n,-r);if(n<0)return(r%2?-1:1)*e(-n,r);if(0===r)return a(n);if(1===r)return f(n);if(0===n)return 0;var i=0;if(n>r)i=o(n,r,a(n),f(n),-1);else{for(var l=!1,s=0,c=0,u=1,d=0,p=2/n,h=2*t.floor((r+t.floor(t.sqrt(40*r)))/2);h>0;h--)d=h*p*u-s,s=u,u=d,t.abs(u)>1e10&&(u*=1e-10,s*=1e-10,i*=1e-10,c*=1e-10),l&&(c+=u),l=!l,h==r&&(i=s);i/=c=2*c-u}return i}}(),v=(i=.636619772,l=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),s=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),c=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),u=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),d=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),p=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),f=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),r((function(e){var o=0,r=0,u=0,d=e*e,p=e-.785398164;return e<8?o=(r=n(l,d))/(u=n(s,d))+i*j(e,0)*t.log(e):(r=n(a,d=64/d),u=n(c,d),o=t.sqrt(i/e)*(t.sin(p)*r+t.cos(p)*u*8/e)),o}),(function(e){var o=0,r=0,l=0,s=e*e,a=e-2.356194491;return e<8?o=(r=e*n(u,s))/(l=n(d,s))+i*(j(e,1)*t.log(e)-1/e):(r=n(p,s=64/s),l=n(f,s),o=t.sqrt(i/e)*(t.sin(a)*r+t.cos(a)*l*8/e)),o}),0,1,-1)),y=(h=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),g=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),m=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),b=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(o,r){if(0===(r=Math.round(r)))return function(e){return e<=3.75?n(h,e*e/14.0625):t.exp(t.abs(e))/t.sqrt(t.abs(e))*n(g,3.75/t.abs(e))}(o);if(1===r)return function(e){return e<3.75?e*n(m,e*e/14.0625):(e<0?-1:1)*t.exp(t.abs(e))/t.sqrt(t.abs(e))*n(b,3.75/t.abs(e))}(o);if(r<0)return NaN;if(0===t.abs(o))return 0;if(o==1/0)return 1/0;var i,l=0,s=2/t.abs(o),a=0,c=1,u=0;for(i=2*t.round((r+t.round(t.sqrt(40*r)))/2);i>0;i--)u=i*s*c+a,a=c,c=u,t.abs(c)>1e10&&(c*=1e-10,a*=1e-10,l*=1e-10),i==r&&(l=a);return l*=e(o,0)/c,o<0&&r%2?-l:l}),x=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),o=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),l=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return r((function(r){return r<=2?-t.log(r/2)*y(r,0)+n(e,r*r/4):t.exp(-r)/t.sqrt(r)*n(o,2/r)}),(function(e){return e<=2?t.log(e/2)*y(e,1)+1/e*n(i,e*e/4):t.exp(-e)/t.sqrt(e)*n(l,2/e)}),0,2,1)}();e.besselj=j,e.bessely=v,e.besseli=y,e.besselk=x},"undefined"==typeof DO_NOT_EXPORT_BESSEL?n(t):n({})},162:function(e){var t;e.exports=(t=function(e,t){var n=Array.prototype.concat,o=Array.prototype.slice,r=Object.prototype.toString;function i(t,n){var o=t>n?t:n;return e.pow(10,17-~~(e.log(o>0?o:-o)*e.LOG10E))}var l=Array.isArray||function(e){return"[object Array]"===r.call(e)};function s(e){return"[object Function]"===r.call(e)}function a(e){return"number"==typeof e&&e-e==0}function c(){return new c._init(arguments)}function u(){return 0}function d(){return 1}function p(e,t){return e===t?1:0}c.fn=c.prototype,c._init=function(e){if(l(e[0]))if(l(e[0][0])){s(e[1])&&(e[0]=c.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=s(e[1])?c.map(e[0],e[1]):e[0],this.length=1;else if(a(e[0]))this[0]=c.seq.apply(null,e),this.length=1;else{if(e[0]instanceof c)return c(e[0].toArray());this[0]=[],this.length=1}return this},c._init.prototype=c.prototype,c._init.constructor=c,c.utils={calcRdx:i,isArray:l,isFunction:s,isNumber:a,toVector:function(e){return n.apply([],e)}},c._random_fn=e.random,c.setRandom=function(e){if("function"!=typeof e)throw new TypeError("fn is not a function");c._random_fn=e},c.extend=function(e){var t,n;if(1===arguments.length){for(n in e)c[n]=e[n];return this}for(t=1;t<arguments.length;t++)for(n in arguments[t])e[n]=arguments[t][n];return e},c.rows=function(e){return e.length||1},c.cols=function(e){return e[0].length||1},c.dimensions=function(e){return{rows:c.rows(e),cols:c.cols(e)}},c.row=function(e,t){return l(t)?t.map((function(t){return c.row(e,t)})):e[t]},c.rowa=function(e,t){return c.row(e,t)},c.col=function(e,t){if(l(t)){var n=c.arange(e.length).map((function(){return new Array(t.length)}));return t.forEach((function(t,o){c.arange(e.length).forEach((function(r){n[r][o]=e[r][t]}))})),n}for(var o=new Array(e.length),r=0;r<e.length;r++)o[r]=[e[r][t]];return o},c.cola=function(e,t){return c.col(e,t).map((function(e){return e[0]}))},c.diag=function(e){for(var t=c.rows(e),n=new Array(t),o=0;o<t;o++)n[o]=[e[o][o]];return n},c.antidiag=function(e){for(var t=c.rows(e)-1,n=new Array(t),o=0;t>=0;t--,o++)n[o]=[e[o][t]];return n},c.transpose=function(e){var t,n,o,r,i,s=[];for(l(e[0])||(e=[e]),n=e.length,o=e[0].length,i=0;i<o;i++){for(t=new Array(n),r=0;r<n;r++)t[r]=e[r][i];s.push(t)}return 1===s.length?s[0]:s},c.map=function(e,t,n){var o,r,i,s,a;for(l(e[0])||(e=[e]),r=e.length,i=e[0].length,s=n?e:new Array(r),o=0;o<r;o++)for(s[o]||(s[o]=new Array(i)),a=0;a<i;a++)s[o][a]=t(e[o][a],o,a);return 1===s.length?s[0]:s},c.cumreduce=function(e,t,n){var o,r,i,s,a;for(l(e[0])||(e=[e]),r=e.length,i=e[0].length,s=n?e:new Array(r),o=0;o<r;o++)for(s[o]||(s[o]=new Array(i)),i>0&&(s[o][0]=e[o][0]),a=1;a<i;a++)s[o][a]=t(s[o][a-1],e[o][a]);return 1===s.length?s[0]:s},c.alter=function(e,t){return c.map(e,t,!0)},c.create=function(e,t,n){var o,r,i=new Array(e);for(s(t)&&(n=t,t=e),o=0;o<e;o++)for(i[o]=new Array(t),r=0;r<t;r++)i[o][r]=n(o,r);return i},c.zeros=function(e,t){return a(t)||(t=e),c.create(e,t,u)},c.ones=function(e,t){return a(t)||(t=e),c.create(e,t,d)},c.rand=function(e,t){return a(t)||(t=e),c.create(e,t,c._random_fn)},c.identity=function(e,t){return a(t)||(t=e),c.create(e,t,p)},c.symmetric=function(e){var t,n,o=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<o;t++)for(n=0;n<o;n++)if(e[n][t]!==e[t][n])return!1;return!0},c.clear=function(e){return c.alter(e,u)},c.seq=function(e,t,n,o){s(o)||(o=!1);var r,l=[],a=i(e,t),c=(t*a-e*a)/((n-1)*a),u=e;for(r=0;u<=t&&r<n;u=(e*a+c*a*++r)/a)l.push(o?o(u,r):u);return l},c.arange=function(e,n,o){var r,i=[];if(o=o||1,n===t&&(n=e,e=0),e===n||0===o)return[];if(e<n&&o<0)return[];if(e>n&&o>0)return[];if(o>0)for(r=e;r<n;r+=o)i.push(r);else for(r=e;r>n;r+=o)i.push(r);return i},c.slice=function(){function e(e,n,o,r){var i,l=[],s=e.length;if(n===t&&o===t&&r===t)return c.copy(e);if(r=r||1,(n=(n=n||0)>=0?n:s+n)===(o=(o=o||e.length)>=0?o:s+o)||0===r)return[];if(n<o&&r<0)return[];if(n>o&&r>0)return[];if(r>0)for(i=n;i<o;i+=r)l.push(e[i]);else for(i=n;i>o;i+=r)l.push(e[i]);return l}return function(t,n){var o,r;return a((n=n||{}).row)?a(n.col)?t[n.row][n.col]:e(c.rowa(t,n.row),(o=n.col||{}).start,o.end,o.step):a(n.col)?e(c.cola(t,n.col),(r=n.row||{}).start,r.end,r.step):(r=n.row||{},o=n.col||{},e(t,r.start,r.end,r.step).map((function(t){return e(t,o.start,o.end,o.step)})))}}(),c.sliceAssign=function(n,o,r){var i,l;if(a(o.row)){if(a(o.col))return n[o.row][o.col]=r;o.col=o.col||{},o.col.start=o.col.start||0,o.col.end=o.col.end||n[0].length,o.col.step=o.col.step||1,i=c.arange(o.col.start,e.min(n.length,o.col.end),o.col.step);var s=o.row;return i.forEach((function(e,t){n[s][e]=r[t]})),n}if(a(o.col)){o.row=o.row||{},o.row.start=o.row.start||0,o.row.end=o.row.end||n.length,o.row.step=o.row.step||1,l=c.arange(o.row.start,e.min(n[0].length,o.row.end),o.row.step);var u=o.col;return l.forEach((function(e,t){n[e][u]=r[t]})),n}return r[0].length===t&&(r=[r]),o.row.start=o.row.start||0,o.row.end=o.row.end||n.length,o.row.step=o.row.step||1,o.col.start=o.col.start||0,o.col.end=o.col.end||n[0].length,o.col.step=o.col.step||1,l=c.arange(o.row.start,e.min(n.length,o.row.end),o.row.step),i=c.arange(o.col.start,e.min(n[0].length,o.col.end),o.col.step),l.forEach((function(e,t){i.forEach((function(o,i){n[e][o]=r[t][i]}))})),n},c.diagonal=function(e){var t=c.zeros(e.length,e.length);return e.forEach((function(e,n){t[n][n]=e})),t},c.copy=function(e){return e.map((function(e){return a(e)?e:e.map((function(e){return e}))}))};var f=c.prototype;return f.length=0,f.push=Array.prototype.push,f.sort=Array.prototype.sort,f.splice=Array.prototype.splice,f.slice=Array.prototype.slice,f.toArray=function(){return this.length>1?o.call(this):o.call(this)[0]},f.map=function(e,t){return c(c.map(this,e,t))},f.cumreduce=function(e,t){return c(c.cumreduce(this,e,t))},f.alter=function(e){return c.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)!function(e){f[e]=function(t){var n,o=this;return t?(setTimeout((function(){t.call(o,f[e].call(o))})),this):(n=c[e](this),l(n)?c(n):n)}}(e[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){f[e]=function(t,n){var o=this;return n?(setTimeout((function(){n.call(o,f[e].call(o,t))})),this):c(c[e](this,t))}}(e[t])}("row col".split(" ")),function(e){for(var t=0;t<e.length;t++)!function(e){f[e]=function(){return c(c[e].apply(null,arguments))}}(e[t])}("create zeros ones rand identity".split(" ")),c}(Math),function(e,t){var n=e.utils.isFunction;function o(e,t){return e-t}function r(e,n,o){return t.max(n,t.min(e,o))}e.sum=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.sumsqrd=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n]*e[n];return t},e.sumsqerr=function(t){for(var n,o=e.mean(t),r=0,i=t.length;--i>=0;)r+=(n=t[i]-o)*n;return r},e.sumrow=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.product=function(e){for(var t=1,n=e.length;--n>=0;)t*=e[n];return t},e.min=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]<t&&(t=e[n]);return t},e.max=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]>t&&(t=e[n]);return t},e.unique=function(e){for(var t={},n=[],o=0;o<e.length;o++)t[e[o]]||(t[e[o]]=!0,n.push(e[o]));return n},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(n){var o=n.map(t.log),r=e.mean(o);return t.exp(r)},e.median=function(e){var t=e.length,n=e.slice().sort(o);return 1&t?n[t/2|0]:(n[t/2-1]+n[t/2])/2},e.cumsum=function(t){return e.cumreduce(t,(function(e,t){return e+t}))},e.cumprod=function(t){return e.cumreduce(t,(function(e,t){return e*t}))},e.diff=function(e){var t,n=[],o=e.length;for(t=1;t<o;t++)n.push(e[t]-e[t-1]);return n},e.rank=function(e){var t,n=[],r={};for(t=0;t<e.length;t++)r[a=e[t]]?r[a]++:(r[a]=1,n.push(a));var i=n.sort(o),l={},s=1;for(t=0;t<i.length;t++){var a,c=r[a=i[t]],u=(s+(s+c-1))/2;l[a]=u,s+=c}return e.map((function(e){return l[e]}))},e.mode=function(e){var t,n=e.length,r=e.slice().sort(o),i=1,l=0,s=0,a=[];for(t=0;t<n;t++)r[t]===r[t+1]?i++:(i>l?(a=[r[t]],l=i,s=0):i===l&&(a.push(r[t]),s++),i=1);return 0===s?a[0]:a},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,n){return e.sumsqerr(t)/(t.length-(n?1:0))},e.pooledvariance=function(t){return t.reduce((function(t,n){return t+e.sumsqerr(n)}),0)/(t.reduce((function(e,t){return e+t.length}),0)-t.length)},e.deviation=function(t){for(var n=e.mean(t),o=t.length,r=new Array(o),i=0;i<o;i++)r[i]=t[i]-n;return r},e.stdev=function(n,o){return t.sqrt(e.variance(n,o))},e.pooledstdev=function(n){return t.sqrt(e.pooledvariance(n))},e.meandev=function(n){for(var o=e.mean(n),r=[],i=n.length-1;i>=0;i--)r.push(t.abs(n[i]-o));return e.mean(r)},e.meddev=function(n){for(var o=e.median(n),r=[],i=n.length-1;i>=0;i--)r.push(t.abs(n[i]-o));return e.median(r)},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var n=e.length,r=e.slice().sort(o);return[r[t.round(n/4)-1],r[t.round(n/2)-1],r[t.round(3*n/4)-1]]},e.quantiles=function(e,n,i,l){var s,a,c,u,d,p=e.slice().sort(o),f=[n.length],h=e.length;for(void 0===i&&(i=3/8),void 0===l&&(l=3/8),s=0;s<n.length;s++)c=h*(a=n[s])+(i+a*(1-i-l)),u=t.floor(r(c,1,h-1)),d=r(c-u,0,1),f[s]=(1-d)*p[u-1]+d*p[u];return f},e.percentile=function(e,t,n){var r=e.slice().sort(o),i=t*(r.length+(n?1:-1))+(n?0:1),l=parseInt(i),s=i-l;return l+1<r.length?r[l-1]+s*(r[l]-r[l-1]):r[l-1]},e.percentileOfScore=function(e,t,n){var o,r,i=0,l=e.length,s=!1;for("strict"===n&&(s=!0),r=0;r<l;r++)o=e[r],(s&&o<t||!s&&o<=t)&&i++;return i/l},e.histogram=function(n,o){o=o||4;var r,i=e.min(n),l=(e.max(n)-i)/o,s=n.length,a=[];for(r=0;r<o;r++)a[r]=0;for(r=0;r<s;r++)a[t.min(t.floor((n[r]-i)/l),o-1)]+=1;return a},e.covariance=function(t,n){var o,r=e.mean(t),i=e.mean(n),l=t.length,s=new Array(l);for(o=0;o<l;o++)s[o]=(t[o]-r)*(n[o]-i);return e.sum(s)/(l-1)},e.corrcoeff=function(t,n){return e.covariance(t,n)/e.stdev(t,1)/e.stdev(n,1)},e.spearmancoeff=function(t,n){return t=e.rank(t),n=e.rank(n),e.corrcoeff(t,n)},e.stanMoment=function(n,o){for(var r=e.mean(n),i=e.stdev(n),l=n.length,s=0,a=0;a<l;a++)s+=t.pow((n[a]-r)/i,o);return s/n.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var i=e.prototype;!function(t){for(var o=0;o<t.length;o++)!function(t){i[t]=function(o,r){var l=[],s=0,a=this;if(n(o)&&(r=o,o=!1),r)return setTimeout((function(){r.call(a,i[t].call(a,o))})),this;if(this.length>1){for(a=!0===o?this:this.transpose();s<a.length;s++)l[s]=e[t](a[s]);return l}return e[t](this[0],o)}}(t[o])}("cumsum cumprod".split(" ")),function(t){for(var o=0;o<t.length;o++)!function(t){i[t]=function(o,r){var l=[],s=0,a=this;if(n(o)&&(r=o,o=!1),r)return setTimeout((function(){r.call(a,i[t].call(a,o))})),this;if(this.length>1){for("sumrow"!==t&&(a=!0===o?this:this.transpose());s<a.length;s++)l[s]=e[t](a[s]);return!0===o?e[t](e.utils.toVector(l)):l}return e[t](this[0],o)}}(t[o])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var o=0;o<t.length;o++)!function(t){i[t]=function(){var o,r=[],l=0,s=this,a=Array.prototype.slice.call(arguments);if(n(a[a.length-1])){o=a[a.length-1];var c=a.slice(0,a.length-1);return setTimeout((function(){o.call(s,i[t].apply(s,c))})),this}o=void 0;var u=function(n){return e[t].apply(s,[n].concat(a))};if(this.length>1){for(s=s.transpose();l<s.length;l++)r[l]=u(s[l]);return r}return u(this[0])}}(t[o])}("quantiles percentileOfScore".split(" "))}(t,Math),function(e,t){e.gammaln=function(e){var n,o,r,i=0,l=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],s=1.000000000190015;for(r=(o=n=e)+5.5,r-=(n+.5)*t.log(r);i<6;i++)s+=l[i]/++o;return t.log(2.5066282746310007*s/n)-r},e.loggam=function(e){var n,o,r,i,l,s,a,c=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(n=e,a=0,1==e||2==e)return 0;for(e<=7&&(n=e+(a=t.floor(7-e))),o=1/(n*n),r=2*t.PI,l=c[9],s=8;s>=0;s--)l*=o,l+=c[s];if(i=l/n+.5*t.log(r)+(n-.5)*t.log(n)-n,e<=7)for(s=1;s<=a;s++)i-=t.log(n-1),n-=1;return i},e.gammafn=function(e){var n,o,r,i,l=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],s=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],a=!1,c=0,u=0,d=0,p=e;if(e>171.6243769536076)return 1/0;if(p<=0){if(!(i=p%1+36e-17))return 1/0;a=(1&p?-1:1)*t.PI/t.sin(t.PI*i),p=1-p}for(r=p,o=p<1?p++:(p-=c=(0|p)-1)-1,n=0;n<8;++n)d=(d+l[n])*o,u=u*o+s[n];if(i=d/u+1,r<p)i/=r;else if(r>p)for(n=0;n<c;++n)i*=p,p++;return a&&(i=a/i),i},e.gammap=function(t,n){return e.lowRegGamma(t,n)*e.gammafn(t)},e.lowRegGamma=function(n,o){var r,i=e.gammaln(n),l=n,s=1/n,a=s,c=o+1-n,u=1/1e-30,d=1/c,p=d,f=1,h=-~(8.5*t.log(n>=1?n:1/n)+.4*n+17);if(o<0||n<=0)return NaN;if(o<n+1){for(;f<=h;f++)s+=a*=o/++l;return s*t.exp(-o+n*t.log(o)-i)}for(;f<=h;f++)p*=(d=1/(d=(r=-f*(f-n))*d+(c+=2)))*(u=c+r/u);return 1-p*t.exp(-o+n*t.log(o)-i)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(n,o){return n>170||o>170?t.exp(e.combinationln(n,o)):e.factorial(n)/e.factorial(o)/e.factorial(n-o)},e.combinationln=function(t,n){return e.factorialln(t)-e.factorialln(n)-e.factorialln(t-n)},e.permutation=function(t,n){return e.factorial(t)/e.factorial(t-n)},e.betafn=function(n,o){if(!(n<=0||o<=0))return n+o>170?t.exp(e.betaln(n,o)):e.gammafn(n)*e.gammafn(o)/e.gammafn(n+o)},e.betaln=function(t,n){return e.gammaln(t)+e.gammaln(n)-e.gammaln(t+n)},e.betacf=function(e,n,o){var r,i,l,s,a=1e-30,c=1,u=n+o,d=n+1,p=n-1,f=1,h=1-u*e/d;for(t.abs(h)<a&&(h=a),s=h=1/h;c<=100&&(h=1+(i=c*(o-c)*e/((p+(r=2*c))*(n+r)))*h,t.abs(h)<a&&(h=a),f=1+i/f,t.abs(f)<a&&(f=a),s*=(h=1/h)*f,h=1+(i=-(n+c)*(u+c)*e/((n+r)*(d+r)))*h,t.abs(h)<a&&(h=a),f=1+i/f,t.abs(f)<a&&(f=a),s*=l=(h=1/h)*f,!(t.abs(l-1)<3e-7));c++);return s},e.gammapinv=function(n,o){var r,i,l,s,a,c,u=0,d=o-1,p=e.gammaln(o);if(n>=1)return t.max(100,o+100*t.sqrt(o));if(n<=0)return 0;for(o>1?(a=t.log(d),c=t.exp(d*(a-1)-p),s=n<.5?n:1-n,r=(2.30753+.27061*(i=t.sqrt(-2*t.log(s))))/(1+i*(.99229+.04481*i))-i,n<.5&&(r=-r),r=t.max(.001,o*t.pow(1-1/(9*o)-r/(3*t.sqrt(o)),3))):r=n<(i=1-o*(.253+.12*o))?t.pow(n/i,1/o):1-t.log(1-(n-i)/(1-i));u<12;u++){if(r<=0)return 0;if((r-=i=(l=(e.lowRegGamma(o,r)-n)/(i=o>1?c*t.exp(-(r-d)+d*(t.log(r)-a)):t.exp(-r+d*t.log(r)-p)))/(1-.5*t.min(1,l*((o-1)/r-1))))<=0&&(r=.5*(r+i)),t.abs(i)<1e-8*r)break}return r},e.erf=function(e){var n,o,r,i,l=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],s=l.length-1,a=!1,c=0,u=0;for(e<0&&(e=-e,a=!0),o=4*(n=2/(2+e))-2;s>0;s--)r=c,c=o*c-u+l[s],u=r;return i=n*t.exp(-e*e+.5*(l[0]+o*c)-u),a?i-1:1-i},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(n){var o,r,i,l,s=0;if(n>=2)return-100;if(n<=0)return 100;for(l=n<1?n:2-n,o=-.70711*((2.30753+.27061*(i=t.sqrt(-2*t.log(l/2))))/(1+i*(.99229+.04481*i))-i);s<2;s++)o+=(r=e.erfc(o)-l)/(1.1283791670955126*t.exp(-o*o)-o*r);return n<1?o:-o},e.ibetainv=function(n,o,r){var i,l,s,a,c,u,d,p,f,h,g=o-1,m=r-1,b=0;if(n<=0)return 0;if(n>=1)return 1;for(o>=1&&r>=1?(s=n<.5?n:1-n,u=(2.30753+.27061*(a=t.sqrt(-2*t.log(s))))/(1+a*(.99229+.04481*a))-a,n<.5&&(u=-u),d=(u*u-3)/6,p=2/(1/(2*o-1)+1/(2*r-1)),f=u*t.sqrt(d+p)/p-(1/(2*r-1)-1/(2*o-1))*(d+5/6-2/(3*p)),u=o/(o+r*t.exp(2*f))):(i=t.log(o/(o+r)),l=t.log(r/(o+r)),u=n<(a=t.exp(o*i)/o)/(f=a+(c=t.exp(r*l)/r))?t.pow(o*f*n,1/o):1-t.pow(r*f*(1-n),1/r)),h=-e.gammaln(o)-e.gammaln(r)+e.gammaln(o+r);b<10;b++){if(0===u||1===u)return u;if((u-=a=(c=(e.ibeta(u,o,r)-n)/(a=t.exp(g*t.log(u)+m*t.log(1-u)+h)))/(1-.5*t.min(1,c*(g/u-m/(1-u)))))<=0&&(u=.5*(u+a)),u>=1&&(u=.5*(u+a+1)),t.abs(a)<1e-8*u&&b>0)break}return u},e.ibeta=function(n,o,r){var i=0===n||1===n?0:t.exp(e.gammaln(o+r)-e.gammaln(o)-e.gammaln(r)+o*t.log(n)+r*t.log(1-n));return!(n<0||n>1)&&(n<(o+1)/(o+r+2)?i*e.betacf(n,o,r)/o:1-i*e.betacf(1-n,r,o)/r)},e.randn=function(n,o){var r,i,l,s,a;if(o||(o=n),n)return e.create(n,o,(function(){return e.randn()}));do{r=e._random_fn(),i=1.7156*(e._random_fn()-.5),a=(l=r-.449871)*l+(s=t.abs(i)+.386595)*(.196*s-.25472*l)}while(a>.27597&&(a>.27846||i*i>-4*t.log(r)*r*r));return i/r},e.randg=function(n,o,r){var i,l,s,a,c,u,d=n;if(r||(r=o),n||(n=1),o)return(u=e.zeros(o,r)).alter((function(){return e.randg(n)})),u;n<1&&(n+=1),i=n-1/3,l=1/t.sqrt(9*i);do{do{a=1+l*(c=e.randn())}while(a<=0);a*=a*a,s=e._random_fn()}while(s>1-.331*t.pow(c,4)&&t.log(s)>.5*c*c+i*(1-a+t.log(a)));if(n==d)return i*a;do{s=e._random_fn()}while(0===s);return t.pow(s,1/d)*i*a},function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e.map(this,(function(n){return e[t](n)})))}}(t[n])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}}(t[n])}("randn".split(" "))}(t,Math),function(e,t){function n(e,n,o,r){for(var i,l=0,s=1,a=1,c=1,u=0,d=0;t.abs((a-d)/a)>r;)d=a,s=c+(i=-(n+u)*(n+o+u)*e/(n+2*u)/(n+2*u+1))*s,a=(l=a+i*l)+(i=(u+=1)*(o-u)*e/(n+2*u-1)/(n+2*u))*a,l/=c=s+i*c,s/=c,a/=c,c=1;return a/n}function o(n,o,r){var i=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],l=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],s=.5*n;if(s>=8)return 1;var a,c=2*e.normal.cdf(s,0,1,1,0)-1;c=c>=t.exp(-50/r)?t.pow(c,r):0;for(var u=s,d=(8-s)/(a=n>3?2:3),p=u+d,f=0,h=r-1,g=1;g<=a;g++){for(var m=0,b=.5*(p+u),j=.5*(p-u),v=1;v<=12;v++){var y,x=b+j*(6<v?i[(y=12-v+1)-1]:-i[(y=v)-1]),w=x*x;if(w>60)break;var C=2*e.normal.cdf(x,0,1,1,0)*.5-2*e.normal.cdf(x,n,1,1,0)*.5;C>=t.exp(-30/h)&&(m+=C=l[y-1]*t.exp(-.5*w)*t.pow(C,h))}f+=m*=2*j*r/t.sqrt(2*t.PI),u=p,p+=d}return(c+=f)<=t.exp(-30/o)?0:(c=t.pow(c,o))>=1?1:c}!function(t){for(var n=0;n<t.length;n++)!function(t){e[t]=function e(t,n,o){return this instanceof e?(this._a=t,this._b=n,this._c=o,this):new e(t,n,o)},e.fn[t]=function(n,o,r){var i=e[t](n,o,r);return i.data=this,i},e[t].prototype.sample=function(n){var o=this._a,r=this._b,i=this._c;return n?e.alter(n,(function(){return e[t].sample(o,r,i)})):e[t].sample(o,r,i)},function(n){for(var o=0;o<n.length;o++)!function(n){e[t].prototype[n]=function(o){var r=this._a,i=this._b,l=this._c;return o||0===o||(o=this.data),"number"!=typeof o?e.fn.map.call(o,(function(o){return e[t][n](o,r,i,l)})):e[t][n](o,r,i,l)}}(n[o])}("pdf cdf inv".split(" ")),function(n){for(var o=0;o<n.length;o++)!function(n){e[t].prototype[n]=function(){return e[t][n](this._a,this._b,this._c)}}(n[o])}("mean median mode variance".split(" "))}(t[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(n,o,r){return n>1||n<0?0:1==o&&1==r?1:o<512&&r<512?t.pow(n,o-1)*t.pow(1-n,r-1)/e.betafn(o,r):t.exp((o-1)*t.log(n)+(r-1)*t.log(1-n)-e.betaln(o,r))},cdf:function(t,n,o){return t>1||t<0?1*(t>1):e.ibeta(t,n,o)},inv:function(t,n,o){return e.ibetainv(t,n,o)},mean:function(e,t){return e/(e+t)},median:function(t,n){return e.ibetainv(.5,t,n)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,n){var o=e.randg(t);return o/(o+e.randg(n))},variance:function(e,n){return e*n/(t.pow(e+n,2)*(e+n+1))}}),e.extend(e.centralF,{pdf:function(n,o,r){var i;return n<0?0:o<=2?0===n&&o<2?1/0:0===n&&2===o?1:1/e.betafn(o/2,r/2)*t.pow(o/r,o/2)*t.pow(n,o/2-1)*t.pow(1+o/r*n,-(o+r)/2):(i=o*n/(r+n*o),o*(r/(r+n*o))/2*e.binomial.pdf((o-2)/2,(o+r-2)/2,i))},cdf:function(t,n,o){return t<0?0:e.ibeta(n*t/(n*t+o),n/2,o/2)},inv:function(t,n,o){return o/(n*(1/e.ibetainv(t,n/2,o/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,n){return 2*e.randg(t/2)/t/(2*e.randg(n/2)/n)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,n,o){return o<0?0:o/(t.pow(e-n,2)+t.pow(o,2))/t.PI},cdf:function(e,n,o){return t.atan((e-n)/o)/t.PI+.5},inv:function(e,n,o){return n+o*t.tan(t.PI*(e-.5))},median:function(e){return e},mode:function(e){return e},sample:function(n,o){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*o+n}}),e.extend(e.chisquare,{pdf:function(n,o){return n<0?0:0===n&&2===o?.5:t.exp((o/2-1)*t.log(n)-n/2-o/2*t.log(2)-e.gammaln(o/2))},cdf:function(t,n){return t<0?0:e.lowRegGamma(n/2,t/2)},inv:function(t,n){return 2*e.gammapinv(t,.5*n)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,n){return e<0?0:n*t.exp(-n*e)},cdf:function(e,n){return e<0?0:1-t.exp(-n*e)},inv:function(e,n){return-t.log(1-e)/n},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(){return 0},sample:function(n){return-1/n*t.log(e._random_fn())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(n,o,r){return n<0?0:0===n&&1===o?1/r:t.exp((o-1)*t.log(n)-n/r-e.gammaln(o)-o*t.log(r))},cdf:function(t,n,o){return t<0?0:e.lowRegGamma(n,t/o)},inv:function(t,n,o){return e.gammapinv(t,n)*o},mean:function(e,t){return e*t},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(t,n){return e.randg(t)*n},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(n,o,r){return n<=0?0:t.exp(-(o+1)*t.log(n)-r/n-e.gammaln(o)+o*t.log(r))},cdf:function(t,n,o){return t<=0?0:1-e.lowRegGamma(n,o/t)},inv:function(t,n,o){return o/e.gammapinv(1-t,n)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,n){return n/e.randg(t)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,n,o){return 0===e&&1===n?o:1===e&&1===o?n:t.exp(t.log(n)+t.log(o)+(n-1)*t.log(e)+(o-1)*t.log(1-t.pow(e,n)))},cdf:function(e,n,o){return e<0?0:e>1?1:1-t.pow(1-t.pow(e,n),o)},inv:function(e,n,o){return t.pow(1-t.pow(1-e,1/o),1/n)},mean:function(t,n){return n*e.gammafn(1+1/t)*e.gammafn(n)/e.gammafn(1+1/t+n)},median:function(e,n){return t.pow(1-t.pow(2,-1/n),1/e)},mode:function(e,n){if(e>=1&&n>=1&&1!==e&&1!==n)return t.pow((e-1)/(e*n-1),1/e)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,n,o){return e<=0?0:t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(o)-t.pow(t.log(e)-n,2)/(2*o*o))},cdf:function(n,o,r){return n<0?0:.5+.5*e.erf((t.log(n)-o)/t.sqrt(2*r*r))},inv:function(n,o,r){return t.exp(-1.4142135623730951*r*e.erfcinv(2*n)+o)},mean:function(e,n){return t.exp(e+n*n/2)},median:function(e){return t.exp(e)},mode:function(e,n){return t.exp(e-n*n)},sample:function(n,o){return t.exp(e.randn()*o+n)},variance:function(e,n){return(t.exp(n*n)-1)*t.exp(2*e+n*n)}}),e.extend(e.noncentralt,{pdf:function(n,o,r){return t.abs(r)<1e-14?e.studentt.pdf(n,o):t.abs(n)<1e-14?t.exp(e.gammaln((o+1)/2)-r*r/2-.5*t.log(t.PI*o)-e.gammaln(o/2)):o/n*(e.noncentralt.cdf(n*t.sqrt(1+2/o),o+2,r)-e.noncentralt.cdf(n,o,r))},cdf:function(n,o,r){var i=1e-14;if(t.abs(r)<i)return e.studentt.cdf(n,o);var l=!1;n<0&&(l=!0,r=-r);for(var s=e.normal.cdf(-r,0,1),a=i+1,c=a,u=n*n/(n*n+o),d=0,p=t.exp(-r*r/2),f=t.exp(-r*r/2-.5*t.log(2)-e.gammaln(1.5))*r;d<200||c>i||a>i;)c=a,d>0&&(p*=r*r/(2*d),f*=r*r/(2*(d+.5))),s+=.5*(a=p*e.beta.cdf(u,d+.5,o/2)+f*e.beta.cdf(u,d+1,o/2)),d++;return l?1-s:s}}),e.extend(e.normal,{pdf:function(e,n,o){return t.exp(-.5*t.log(2*t.PI)-t.log(o)-t.pow(e-n,2)/(2*o*o))},cdf:function(n,o,r){return.5*(1+e.erf((n-o)/t.sqrt(2*r*r)))},inv:function(t,n,o){return-1.4142135623730951*o*e.erfcinv(2*t)+n},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},sample:function(t,n){return e.randn()*n+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,n,o){return e<n?0:o*t.pow(n,o)/t.pow(e,o+1)},cdf:function(e,n,o){return e<n?0:1-t.pow(n/e,o)},inv:function(e,n,o){return n/t.pow(1-e,1/o)},mean:function(e,n){if(!(n<=1))return n*t.pow(e,n)/(n-1)},median:function(e,n){return e*(n*t.SQRT2)},mode:function(e){return e},variance:function(e,n){if(!(n<=2))return e*e*n/(t.pow(n-1,2)*(n-2))}}),e.extend(e.studentt,{pdf:function(n,o){return o=o>1e100?1e100:o,1/(t.sqrt(o)*e.betafn(.5,o/2))*t.pow(1+n*n/o,-(o+1)/2)},cdf:function(n,o){var r=o/2;return e.ibeta((n+t.sqrt(n*n+o))/(2*t.sqrt(n*n+o)),r,r)},inv:function(n,o){var r=e.ibetainv(2*t.min(n,1-n),.5*o,.5);return r=t.sqrt(o*(1-r)/r),n>.5?r:-r},mean:function(e){return e>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return e.randn()*t.sqrt(n/(2*e.randg(n/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,n,o){return e<0||n<0||o<0?0:o/n*t.pow(e/n,o-1)*t.exp(-t.pow(e/n,o))},cdf:function(e,n,o){return e<0?0:1-t.exp(-t.pow(e/n,o))},inv:function(e,n,o){return n*t.pow(-t.log(1-e),1/o)},mean:function(t,n){return t*e.gammafn(1+1/n)},median:function(e,n){return e*t.pow(t.log(2),1/n)},mode:function(e,n){return n<=1?0:e*t.pow((n-1)/n,1/n)},sample:function(n,o){return n*t.pow(-t.log(e._random_fn()),1/o)},variance:function(n,o){return n*n*e.gammafn(1+2/o)-t.pow(e.weibull.mean(n,o),2)}}),e.extend(e.uniform,{pdf:function(e,t,n){return e<t||e>n?0:1/(n-t)},cdf:function(e,t,n){return e<t?0:e<n?(e-t)/(n-t):1},inv:function(e,t,n){return t+e*(n-t)},mean:function(e,t){return.5*(e+t)},median:function(t,n){return e.mean(t,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(t,n){return t/2+n/2+(n/2-t/2)*(2*e._random_fn()-1)},variance:function(e,n){return t.pow(n-e,2)/12}}),e.extend(e.binomial,{pdf:function(n,o,r){return 0===r||1===r?o*r===n?1:0:e.combination(o,n)*t.pow(r,n)*t.pow(1-r,o-n)},cdf:function(o,r,i){var l,s=1e-10;if(o<0)return 0;if(o>=r)return 1;if(i<0||i>1||r<=0)return NaN;var a=i,c=(o=t.floor(o))+1,u=r-o,d=c+u,p=t.exp(e.gammaln(d)-e.gammaln(u)-e.gammaln(c)+c*t.log(a)+u*t.log(1-a));return l=a<(c+1)/(d+2)?p*n(a,c,u,s):1-p*n(1-a,u,c,s),t.round(1/s*(1-l))/(1/s)}}),e.extend(e.negbin,{pdf:function(n,o,r){return n===n>>>0&&(n<0?0:e.combination(n+o-1,o-1)*t.pow(1-r,n)*t.pow(r,o))},cdf:function(t,n,o){var r=0,i=0;if(t<0)return 0;for(;i<=t;i++)r+=e.negbin.pdf(i,n,o);return r}}),e.extend(e.hypgeom,{pdf:function(n,o,r,i){if(n!=n|0)return!1;if(n<0||n<r-(o-i))return 0;if(n>i||n>r)return 0;if(2*r>o)return 2*i>o?e.hypgeom.pdf(o-r-i+n,o,o-r,o-i):e.hypgeom.pdf(i-n,o,o-r,i);if(2*i>o)return e.hypgeom.pdf(r-n,o,r,o-i);if(r<i)return e.hypgeom.pdf(n,o,i,r);for(var l=1,s=0,a=0;a<n;a++){for(;l>1&&s<i;)l*=1-r/(o-s),s++;l*=(i-a)*(r-a)/((a+1)*(o-r-i+a+1))}for(;s<i;s++)l*=1-r/(o-s);return t.min(1,t.max(0,l))},cdf:function(n,o,r,i){if(n<0||n<r-(o-i))return 0;if(n>=i||n>=r)return 1;if(2*r>o)return 2*i>o?e.hypgeom.cdf(o-r-i+n,o,o-r,o-i):1-e.hypgeom.cdf(i-n-1,o,o-r,i);if(2*i>o)return 1-e.hypgeom.cdf(r-n-1,o,r,o-i);if(r<i)return e.hypgeom.cdf(n,o,i,r);for(var l=1,s=1,a=0,c=0;c<n;c++){for(;l>1&&a<i;){var u=1-r/(o-a);s*=u,l*=u,a++}l+=s*=(i-c)*(r-c)/((c+1)*(o-r-i+c+1))}for(;a<i;a++)l*=1-r/(o-a);return t.min(1,t.max(0,l))}}),e.extend(e.poisson,{pdf:function(n,o){return o<0||n%1!=0||n<0?0:t.pow(o,n)*t.exp(-o)/e.factorial(n)},cdf:function(t,n){var o=[],r=0;if(t<0)return 0;for(;r<=t;r++)o.push(e.poisson.pdf(r,n));return e.sum(o)},mean:function(e){return e},variance:function(e){return e},sampleSmall:function(n){var o=1,r=0,i=t.exp(-n);do{r++,o*=e._random_fn()}while(o>i);return r-1},sampleLarge:function(n){var o,r,i,l,s,a,c,u,d,p,f=n;for(l=t.sqrt(f),s=t.log(f),a=.02483*(c=.931+2.53*l)-.059,u=1.1239+1.1328/(c-3.4),d=.9277-3.6224/(c-2);;){if(r=t.random()-.5,i=t.random(),p=.5-t.abs(r),o=t.floor((2*a/p+c)*r+f+.43),p>=.07&&i<=d)return o;if(!(o<0||p<.013&&i>p)&&t.log(i)+t.log(u)-t.log(a/(p*p)+c)<=o*s-f-e.loggam(o+1))return o}},sample:function(e){return e<10?this.sampleSmall(e):this.sampleLarge(e)}}),e.extend(e.triangular,{pdf:function(e,t,n,o){return n<=t||o<t||o>n?NaN:e<t||e>n?0:e<o?2*(e-t)/((n-t)*(o-t)):e===o?2/(n-t):2*(n-e)/((n-t)*(n-o))},cdf:function(e,n,o,r){return o<=n||r<n||r>o?NaN:e<=n?0:e>=o?1:e<=r?t.pow(e-n,2)/((o-n)*(r-n)):1-t.pow(o-e,2)/((o-n)*(o-r))},inv:function(e,n,o,r){return o<=n||r<n||r>o?NaN:e<=(r-n)/(o-n)?n+(o-n)*t.sqrt(e*((r-n)/(o-n))):n+(o-n)*(1-t.sqrt((1-e)*(1-(r-n)/(o-n))))},mean:function(e,t,n){return(e+t+n)/3},median:function(e,n,o){return o<=(e+n)/2?n-t.sqrt((n-e)*(n-o))/t.sqrt(2):o>(e+n)/2?e+t.sqrt((n-e)*(o-e))/t.sqrt(2):void 0},mode:function(e,t,n){return n},sample:function(n,o,r){var i=e._random_fn();return i<(r-n)/(o-n)?n+t.sqrt(i*(o-n)*(r-n)):o-t.sqrt((1-i)*(o-n)*(o-r))},variance:function(e,t,n){return(e*e+t*t+n*n-e*t-e*n-t*n)/18}}),e.extend(e.arcsine,{pdf:function(e,n,o){return o<=n?NaN:e<=n||e>=o?0:2/t.PI*t.pow(t.pow(o-n,2)-t.pow(2*e-n-o,2),-.5)},cdf:function(e,n,o){return e<n?0:e<o?2/t.PI*t.asin(t.sqrt((e-n)/(o-n))):1},inv:function(e,n,o){return n+(.5-.5*t.cos(t.PI*e))*(o-n)},mean:function(e,t){return t<=e?NaN:(e+t)/2},median:function(e,t){return t<=e?NaN:(e+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,o){return(n+o)/2+(o-n)/2*t.sin(2*t.PI*e.uniform.sample(0,1))},variance:function(e,n){return n<=e?NaN:t.pow(n-e,2)/8}}),e.extend(e.laplace,{pdf:function(e,n,o){return o<=0?0:t.exp(-t.abs(e-n)/o)/(2*o)},cdf:function(e,n,o){return o<=0?0:e<n?.5*t.exp((e-n)/o):1-.5*t.exp(-(e-n)/o)},mean:function(e){return e},median:function(e){return e},mode:function(e){return e},variance:function(e,t){return 2*t*t},sample:function(n,o){var r,i=e._random_fn()-.5;return n-o*((r=i)/t.abs(r))*t.log(1-2*t.abs(i))}}),e.extend(e.tukey,{cdf:function(n,r,i){var l=r,s=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],a=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(i<2||l<2)return NaN;if(!Number.isFinite(n))return 1;if(i>25e3)return o(n,1,l);var c,u=.5*i,d=u*t.log(i)-i*t.log(2)-e.gammaln(u),p=u-1,f=.25*i;c=i<=100?1:i<=800?.5:i<=5e3?.25:.125,d+=t.log(c);for(var h=0,g=1;g<=50;g++){for(var m=0,b=(2*g-1)*c,j=1;j<=16;j++){var v,y;8<j?(v=j-8-1,y=d+p*t.log(b+s[v]*c)-(s[v]*c+b)*f):(v=j-1,y=d+p*t.log(b-s[v]*c)+(s[v]*c-b)*f),y>=-30&&(m+=o(8<j?n*t.sqrt(.5*(s[v]*c+b)):n*t.sqrt(.5*(-s[v]*c+b)),1,l)*a[v]*t.exp(y))}if(g*c>=1&&m<=1e-14)break;h+=m}if(m>1e-14)throw new Error("tukey.cdf failed to converge");return h>1&&(h=1),h},inv:function(n,o,r){if(r<2||o<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var i,l=function(e,n,o){var r=.5-.5*e,i=t.sqrt(t.log(1/(r*r))),l=i+((((-453642210148e-16*i-.204231210125)*i-.342242088547)*i-1)*i+.322232421088)/((((.0038560700634*i+.10353775285)*i+.531103462366)*i+.588581570495)*i+.099348462606);o<120&&(l+=(l*l*l+l)/o/4);var s=.8832-.2368*l;return o<120&&(s+=-1.214/o+1.208*l/o),l*(s*t.log(n-1)+1.4142)}(n,o,r),s=e.tukey.cdf(l,o,r)-n;i=s>0?t.max(0,l-1):l+1;for(var a,c=e.tukey.cdf(i,o,r)-n,u=1;u<50;u++)if(a=i-c*(i-l)/(c-s),s=c,l=i,a<0&&(a=0,c=-n),c=e.tukey.cdf(a,o,r)-n,i=a,t.abs(i-l)<1e-4)return a;throw new Error("tukey.inv failed to converge")}})}(t,Math),function(e,t){var n,o,r=Array.prototype.push,i=e.utils.isArray;function l(t){return i(t)||t instanceof e}e.extend({add:function(t,n){return l(n)?(l(n[0])||(n=[n]),e.map(t,(function(e,t,o){return e+n[t][o]}))):e.map(t,(function(e){return e+n}))},subtract:function(t,n){return l(n)?(l(n[0])||(n=[n]),e.map(t,(function(e,t,o){return e-n[t][o]||0}))):e.map(t,(function(e){return e-n}))},divide:function(t,n){return l(n)?(l(n[0])||(n=[n]),e.multiply(t,e.inv(n))):e.map(t,(function(e){return e/n}))},multiply:function(t,n){var o,r,i,s,a,c,u,d;if(void 0===t.length&&void 0===n.length)return t*n;if(a=t.length,c=t[0].length,u=e.zeros(a,i=l(n)?n[0].length:c),d=0,l(n)){for(;d<i;d++)for(o=0;o<a;o++){for(s=0,r=0;r<c;r++)s+=t[o][r]*n[r][d];u[o][d]=s}return 1===a&&1===d?u[0][0]:u}return e.map(t,(function(e){return e*n}))},outer:function(t,n){return e.multiply(t.map((function(e){return[e]})),[n])},dot:function(t,n){l(t[0])||(t=[t]),l(n[0])||(n=[n]);for(var o,r,i=1===t[0].length&&1!==t.length?e.transpose(t):t,s=1===n[0].length&&1!==n.length?e.transpose(n):n,a=[],c=0,u=i.length,d=i[0].length;c<u;c++){for(a[c]=[],o=0,r=0;r<d;r++)o+=i[c][r]*s[c][r];a[c]=o}return 1===a.length?a[0]:a},pow:function(n,o){return e.map(n,(function(e){return t.pow(e,o)}))},exp:function(n){return e.map(n,(function(e){return t.exp(e)}))},log:function(n){return e.map(n,(function(e){return t.log(e)}))},abs:function(n){return e.map(n,(function(e){return t.abs(e)}))},norm:function(e,n){var o=0,r=0;for(isNaN(n)&&(n=2),l(e[0])&&(e=e[0]);r<e.length;r++)o+=t.pow(t.abs(e[r]),n);return t.pow(o,1/n)},angle:function(n,o){return t.acos(e.dot(n,o)/(e.norm(n)*e.norm(o)))},aug:function(e,t){var n,o=[];for(n=0;n<e.length;n++)o.push(e[n].slice());for(n=0;n<o.length;n++)r.apply(o[n],t[n]);return o},inv:function(t){for(var n,o=t.length,r=t[0].length,i=e.identity(o,r),l=e.gauss_jordan(t,i),s=[],a=0;a<o;a++)for(s[a]=[],n=r;n<l[0].length;n++)s[a][n-r]=l[a][n];return s},det:function e(t){if(2===t.length)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(var n=0,o=0;o<t.length;o++){for(var r=[],i=1;i<t.length;i++){r[i-1]=[];for(var l=0;l<t.length;l++)l<o?r[i-1][l]=t[i][l]:l>o&&(r[i-1][l-1]=t[i][l])}var s=o%2?-1:1;n+=e(r)*t[0][o]*s}return n},gauss_elimination:function(n,o){var r,i,l,s,a=0,c=0,u=n.length,d=n[0].length,p=1,f=0,h=[];for(r=(n=e.aug(n,o))[0].length,a=0;a<u;a++){for(i=n[a][a],c=a,s=a+1;s<d;s++)i<t.abs(n[s][a])&&(i=n[s][a],c=s);if(c!=a)for(s=0;s<r;s++)l=n[a][s],n[a][s]=n[c][s],n[c][s]=l;for(c=a+1;c<u;c++)for(p=n[c][a]/n[a][a],s=a;s<r;s++)n[c][s]=n[c][s]-p*n[a][s]}for(a=u-1;a>=0;a--){for(f=0,c=a+1;c<=u-1;c++)f+=h[c]*n[a][c];h[a]=(n[a][r-1]-f)/n[a][a]}return h},gauss_jordan:function(n,o){var r,i,l,s=e.aug(n,o),a=s.length,c=s[0].length,u=0;for(i=0;i<a;i++){var d=i;for(l=i+1;l<a;l++)t.abs(s[l][i])>t.abs(s[d][i])&&(d=l);var p=s[i];for(s[i]=s[d],s[d]=p,l=i+1;l<a;l++)for(u=s[l][i]/s[i][i],r=i;r<c;r++)s[l][r]-=s[i][r]*u}for(i=a-1;i>=0;i--){for(u=s[i][i],l=0;l<i;l++)for(r=c-1;r>i-1;r--)s[l][r]-=s[i][r]*s[l][i]/u;for(s[i][i]/=u,r=a;r<c;r++)s[i][r]/=u}return s},triaUpSolve:function(t,n){var o,r=t[0].length,i=e.zeros(1,r)[0],l=!1;return null!=n[0].length&&(n=n.map((function(e){return e[0]})),l=!0),e.arange(r-1,-1,-1).forEach((function(l){o=e.arange(l+1,r).map((function(e){return i[e]*t[l][e]})),i[l]=(n[l]-e.sum(o))/t[l][l]})),l?i.map((function(e){return[e]})):i},triaLowSolve:function(t,n){var o,r=t[0].length,i=e.zeros(1,r)[0],l=!1;return null!=n[0].length&&(n=n.map((function(e){return e[0]})),l=!0),e.arange(r).forEach((function(r){o=e.arange(r).map((function(e){return t[r][e]*i[e]})),i[r]=(n[r]-e.sum(o))/t[r][r]})),l?i.map((function(e){return[e]})):i},lu:function(t){var n,o=t.length,r=e.identity(o),i=e.zeros(t.length,t[0].length);return e.arange(o).forEach((function(e){i[0][e]=t[0][e]})),e.arange(1,o).forEach((function(l){e.arange(l).forEach((function(o){n=e.arange(o).map((function(e){return r[l][e]*i[e][o]})),r[l][o]=(t[l][o]-e.sum(n))/i[o][o]})),e.arange(l,o).forEach((function(o){n=e.arange(l).map((function(e){return r[l][e]*i[e][o]})),i[l][o]=t[n.length][o]-e.sum(n)}))})),[r,i]},cholesky:function(n){var o,r=n.length,i=e.zeros(n.length,n[0].length);return e.arange(r).forEach((function(l){o=e.arange(l).map((function(e){return t.pow(i[l][e],2)})),i[l][l]=t.sqrt(n[l][l]-e.sum(o)),e.arange(l+1,r).forEach((function(t){o=e.arange(l).map((function(e){return i[l][e]*i[t][e]})),i[t][l]=(n[l][t]-e.sum(o))/i[l][l]}))})),i},gauss_jacobi:function(n,o,r,i){for(var l,s,a,c,u=0,d=0,p=n.length,f=[],h=[],g=[];u<p;u++)for(f[u]=[],h[u]=[],g[u]=[],d=0;d<p;d++)u>d?(f[u][d]=n[u][d],h[u][d]=g[u][d]=0):u<d?(h[u][d]=n[u][d],f[u][d]=g[u][d]=0):(g[u][d]=n[u][d],f[u][d]=h[u][d]=0);for(a=e.multiply(e.multiply(e.inv(g),e.add(f,h)),-1),s=e.multiply(e.inv(g),o),l=r,c=e.add(e.multiply(a,r),s),u=2;t.abs(e.norm(e.subtract(c,l)))>i;)l=c,c=e.add(e.multiply(a,l),s),u++;return c},gauss_seidel:function(n,o,r,i){for(var l,s,a,c,u,d=0,p=n.length,f=[],h=[],g=[];d<p;d++)for(f[d]=[],h[d]=[],g[d]=[],l=0;l<p;l++)d>l?(f[d][l]=n[d][l],h[d][l]=g[d][l]=0):d<l?(h[d][l]=n[d][l],f[d][l]=g[d][l]=0):(g[d][l]=n[d][l],f[d][l]=h[d][l]=0);for(c=e.multiply(e.multiply(e.inv(e.add(g,f)),h),-1),a=e.multiply(e.inv(e.add(g,f)),o),s=r,u=e.add(e.multiply(c,r),a),d=2;t.abs(e.norm(e.subtract(u,s)))>i;)s=u,u=e.add(e.multiply(c,s),a),d+=1;return u},SOR:function(n,o,r,i,l){for(var s,a,c,u,d,p=0,f=n.length,h=[],g=[],m=[];p<f;p++)for(h[p]=[],g[p]=[],m[p]=[],s=0;s<f;s++)p>s?(h[p][s]=n[p][s],g[p][s]=m[p][s]=0):p<s?(g[p][s]=n[p][s],h[p][s]=m[p][s]=0):(m[p][s]=n[p][s],h[p][s]=g[p][s]=0);for(u=e.multiply(e.inv(e.add(m,e.multiply(h,l))),e.subtract(e.multiply(m,1-l),e.multiply(g,l))),c=e.multiply(e.multiply(e.inv(e.add(m,e.multiply(h,l))),o),l),a=r,d=e.add(e.multiply(u,r),c),p=2;t.abs(e.norm(e.subtract(d,a)))>i;)a=d,d=e.add(e.multiply(u,a),c),p++;return d},householder:function(n){for(var o,r,i,l,s=n.length,a=n[0].length,c=0,u=[],d=[];c<s-1;c++){for(o=0,l=c+1;l<a;l++)o+=n[l][c]*n[l][c];for(o=(n[c+1][c]>0?-1:1)*t.sqrt(o),r=t.sqrt((o*o-n[c+1][c]*o)/2),(u=e.zeros(s,1))[c+1][0]=(n[c+1][c]-o)/(2*r),i=c+2;i<s;i++)u[i][0]=n[i][c]/(2*r);d=e.subtract(e.identity(s,a),e.multiply(e.multiply(u,e.transpose(u)),2)),n=e.multiply(d,e.multiply(n,d))}return n},QR:(n=e.sum,o=e.arange,function(r){var i,l,s,a=r.length,c=r[0].length,u=e.zeros(c,c);for(r=e.copy(r),l=0;l<c;l++){for(u[l][l]=t.sqrt(n(o(a).map((function(e){return r[e][l]*r[e][l]})))),i=0;i<a;i++)r[i][l]=r[i][l]/u[l][l];for(s=l+1;s<c;s++)for(u[l][s]=n(o(a).map((function(e){return r[e][l]*r[e][s]}))),i=0;i<a;i++)r[i][s]=r[i][s]-r[i][l]*u[l][s]}return[r,u]}),lstsq:function(t,n){var o=!1;void 0===n[0].length&&(n=n.map((function(e){return[e]})),o=!0);var r=e.QR(t),i=r[0],l=r[1],s=t[0].length,a=e.slice(i,{col:{end:s}}),c=function(t){var n=(t=e.copy(t)).length,o=e.identity(n);return e.arange(n-1,-1,-1).forEach((function(n){e.sliceAssign(o,{row:n},e.divide(e.slice(o,{row:n}),t[n][n])),e.sliceAssign(t,{row:n},e.divide(e.slice(t,{row:n}),t[n][n])),e.arange(n).forEach((function(r){var i=e.multiply(t[r][n],-1),l=e.slice(t,{row:r}),s=e.multiply(e.slice(t,{row:n}),i);e.sliceAssign(t,{row:r},e.add(l,s));var a=e.slice(o,{row:r}),c=e.multiply(e.slice(o,{row:n}),i);e.sliceAssign(o,{row:r},e.add(a,c))}))})),o}(e.slice(l,{row:{end:s}})),u=e.transpose(a);void 0===u[0].length&&(u=[u]);var d=e.multiply(e.multiply(c,u),n);return void 0===d.length&&(d=[[d]]),o?d.map((function(e){return e[0]})):d},jacobi:function(n){for(var o,r,i,l,s,a,c,u=1,d=n.length,p=e.identity(d,d),f=[];1===u;){for(s=n[0][1],i=0,l=1,o=0;o<d;o++)for(r=0;r<d;r++)o!=r&&s<t.abs(n[o][r])&&(s=t.abs(n[o][r]),i=o,l=r);for(a=n[i][i]===n[l][l]?n[i][l]>0?t.PI/4:-t.PI/4:t.atan(2*n[i][l]/(n[i][i]-n[l][l]))/2,(c=e.identity(d,d))[i][i]=t.cos(a),c[i][l]=-t.sin(a),c[l][i]=t.sin(a),c[l][l]=t.cos(a),p=e.multiply(p,c),n=e.multiply(e.multiply(e.inv(c),n),c),u=0,o=1;o<d;o++)for(r=1;r<d;r++)o!=r&&t.abs(n[o][r])>.001&&(u=1)}for(o=0;o<d;o++)f.push(n[o][o]);return[p,f]},rungekutta:function(e,t,n,o,r,i){var l,s,a;if(2===i)for(;o<=n;)r+=((l=t*e(o,r))+(s=t*e(o+t,r+l)))/2,o+=t;if(4===i)for(;o<=n;)r+=((l=t*e(o,r))+2*(s=t*e(o+t/2,r+l/2))+2*(a=t*e(o+t/2,r+s/2))+t*e(o+t,r+a))/6,o+=t;return r},romberg:function(e,n,o,r){for(var i,l,s,a,c,u=0,d=(o-n)/2,p=[],f=[],h=[];u<r/2;){for(c=e(n),s=n,a=0;s<=o;s+=d,a++)p[a]=s;for(i=p.length,s=1;s<i-1;s++)c+=(s%2!=0?4:2)*e(p[s]);c=d/3*(c+e(o)),h[u]=c,d/=2,u++}for(l=h.length,i=1;1!==l;){for(s=0;s<l-1;s++)f[s]=(t.pow(4,i)*h[s+1]-h[s])/(t.pow(4,i)-1);l=f.length,h=f,f=[],i++}return h},richardson:function(e,n,o,r){function i(e,t){for(var n,o=0,r=e.length;o<r;o++)e[o]===t&&(n=o);return n}for(var l,s,a,c,u,d=t.abs(o-e[i(e,o)+1]),p=0,f=[],h=[];r>=d;)l=i(e,o+r),s=i(e,o),f[p]=(n[l]-2*n[s]+n[2*s-l])/(r*r),r/=2,p++;for(c=f.length,a=1;1!=c;){for(u=0;u<c-1;u++)h[u]=(t.pow(4,a)*f[u+1]-f[u])/(t.pow(4,a)-1);c=h.length,f=h,h=[],a++}return f},simpson:function(e,t,n,o){for(var r,i=(n-t)/o,l=e(t),s=[],a=t,c=0,u=1;a<=n;a+=i,c++)s[c]=a;for(r=s.length;u<r-1;u++)l+=(u%2!=0?4:2)*e(s[u]);return i/3*(l+e(n))},hermite:function(e,t,n,o){for(var r,i=e.length,l=0,s=0,a=[],c=[],u=[],d=[];s<i;s++){for(a[s]=1,r=0;r<i;r++)s!=r&&(a[s]*=(o-e[r])/(e[s]-e[r]));for(c[s]=0,r=0;r<i;r++)s!=r&&(c[s]+=1/(e[s]-e[r]));u[s]=(1-2*(o-e[s])*c[s])*(a[s]*a[s]),d[s]=(o-e[s])*(a[s]*a[s]),l+=u[s]*t[s]+d[s]*n[s]}return l},lagrange:function(e,t,n){for(var o,r,i=0,l=0,s=e.length;l<s;l++){for(r=t[l],o=0;o<s;o++)l!=o&&(r*=(n-e[o])/(e[l]-e[o]));i+=r}return i},cubic_spline:function(t,n,o){for(var r,i,l=t.length,s=0,a=[],c=[],u=[],d=[],p=[],f=[];s<l-1;s++)d[s]=t[s+1]-t[s];for(u[0]=0,s=1;s<l-1;s++)u[s]=3/d[s]*(n[s+1]-n[s])-3/d[s-1]*(n[s]-n[s-1]);for(s=1;s<l-1;s++)a[s]=[],c[s]=[],a[s][s-1]=d[s-1],a[s][s]=2*(d[s-1]+d[s]),a[s][s+1]=d[s],c[s][0]=u[s];for(i=e.multiply(e.inv(a),c),r=0;r<l-1;r++)p[r]=(n[r+1]-n[r])/d[r]-d[r]*(i[r+1][0]+2*i[r][0])/3,f[r]=(i[r+1][0]-i[r][0])/(3*d[r]);for(r=0;r<l&&!(t[r]>o);r++);return n[r-=1]+(o-t[r])*p[r]+e.sq(o-t[r])*i[r]+(o-t[r])*e.sq(o-t[r])*f[r]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){var n,o,r,i,l,s=t.length,a=t[0].length,c=0,u=[],d=[],p=[],f=[],h=[],g=[],m=[];for(c=0;c<s;c++)u[c]=e.sum(t[c])/a;for(c=0;c<a;c++)for(h[c]=[],n=0;n<s;n++)h[c][n]=t[n][c]-u[n];for(h=e.transpose(h),c=0;c<s;c++)for(g[c]=[],n=0;n<s;n++)g[c][n]=e.dot([h[c]],[h[n]])/(a-1);for(l=(r=e.jacobi(g))[0],d=r[1],m=e.transpose(l),c=0;c<d.length;c++)for(n=c;n<d.length;n++)d[c]<d[n]&&(o=d[c],d[c]=d[n],d[n]=o,p=m[c],m[c]=m[n],m[n]=p);for(i=e.transpose(h),c=0;c<s;c++)for(f[c]=[],n=0;n<i.length;n++)f[c][n]=e.dot([m[c]],[i[n]]);return[t,d,m,f]}}),function(t){for(var n=0;n<t.length;n++)!function(t){e.fn[t]=function(n,o){var r=this;return o?(setTimeout((function(){o.call(r,e.fn[t].call(r,n))}),15),this):"number"==typeof e[t](this,n)?e[t](this,n):e(e[t](this,n))}}(t[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(t,Math),function(e,t){var n=[].slice,o=e.utils.isNumber,r=e.utils.isArray;function i(e,n,o,r){if(e>1||o>1||e<=0||o<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(e*n+o*r)/(n+r);return(e-o)/t.sqrt(i*(1-i)*(1/n+1/r))}e.extend({zscore:function(){var t=n.call(arguments);return o(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var o,i=n.call(arguments);return r(i[1])?(o=e.zscore(i[0],i[1],i[3]),1===i[2]?e.normal.cdf(-t.abs(o),0,1):2*e.normal.cdf(-t.abs(o),0,1)):i.length>2?(o=e.zscore(i[0],i[1],i[2]),1===i[3]?e.normal.cdf(-t.abs(o),0,1):2*e.normal.cdf(-t.abs(o),0,1)):(o=i[0],1===i[1]?e.normal.cdf(-t.abs(o),0,1):2*e.normal.cdf(-t.abs(o),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(n,o,r){var i=t.abs(this.zscore(n,r));return 1===o?e.normal.cdf(-i,0,1):2*e.normal.cdf(-i,0,1)}}),e.extend({tscore:function(){var o=n.call(arguments);return 4===o.length?(o[0]-o[1])/(o[2]/t.sqrt(o[3])):(o[0]-e.mean(o[1]))/(e.stdev(o[1],!0)/t.sqrt(o[1].length))},ttest:function(){var r,i=n.call(arguments);return 5===i.length?(r=t.abs(e.tscore(i[0],i[1],i[2],i[3])),1===i[4]?e.studentt.cdf(-r,i[3]-1):2*e.studentt.cdf(-r,i[3]-1)):o(i[1])?(r=t.abs(i[0]),1==i[2]?e.studentt.cdf(-r,i[1]-1):2*e.studentt.cdf(-r,i[1]-1)):(r=t.abs(e.tscore(i[0],i[1])),1==i[2]?e.studentt.cdf(-r,i[1].length-1):2*e.studentt.cdf(-r,i[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(n,o){return 1===o?1-e.studentt.cdf(t.abs(this.tscore(n)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(n)),this.cols()-1)}}),e.extend({anovafscore:function(){var o,r,i,l,s,a,c,u,d=n.call(arguments);if(1===d.length){for(s=new Array(d[0].length),c=0;c<d[0].length;c++)s[c]=d[0][c];d=s}for(r=new Array,c=0;c<d.length;c++)r=r.concat(d[c]);for(i=e.mean(r),o=0,c=0;c<d.length;c++)o+=d[c].length*t.pow(e.mean(d[c])-i,2);for(o/=d.length-1,a=0,c=0;c<d.length;c++)for(l=e.mean(d[c]),u=0;u<d[c].length;u++)a+=t.pow(d[c][u]-l,2);return o/(a/(r.length-d.length))},anovaftest:function(){var t,r,i,l,s=n.call(arguments);if(o(s[0]))return 1-e.centralF.cdf(s[0],s[1],s[2]);var a=e.anovafscore(s);for(t=s.length-1,i=0,l=0;l<s.length;l++)i+=s[l].length;return r=i-t-1,1-e.centralF.cdf(a,t,r)},ftest:function(t,n,o){return 1-e.centralF.cdf(t,n,o)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var t,n=0;for(t=0;t<this.length;t++)n+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,n-this.length)}}),e.extend({qscore:function(){var r,i,l,s,a,c=n.call(arguments);return o(c[0])?(r=c[0],i=c[1],l=c[2],s=c[3],a=c[4]):(r=e.mean(c[0]),i=e.mean(c[1]),l=c[0].length,s=c[1].length,a=c[2]),t.abs(r-i)/(a*t.sqrt((1/l+1/s)/2))},qtest:function(){var t,o=n.call(arguments);3===o.length?(t=o[0],o=o.slice(1)):7===o.length?(t=e.qscore(o[0],o[1],o[2],o[3],o[4]),o=o.slice(5)):(t=e.qscore(o[0],o[1],o[2]),o=o.slice(3));var r=o[0],i=o[1];return 1-e.tukey.cdf(t,i,r-i)},tukeyhsd:function(t){for(var n=e.pooledstdev(t),o=t.map((function(t){return e.mean(t)})),r=t.reduce((function(e,t){return e+t.length}),0),i=[],l=0;l<t.length;++l)for(var s=l+1;s<t.length;++s){var a=e.qtest(o[l],o[s],t[l].length,t[s].length,n,r,t.length);i.push([[l,s],a])}return i}}),e.extend({normalci:function(){var o,r=n.call(arguments),i=new Array(2);return o=4===r.length?t.abs(e.normal.inv(r[1]/2,0,1)*r[2]/t.sqrt(r[3])):t.abs(e.normal.inv(r[1]/2,0,1)*e.stdev(r[2])/t.sqrt(r[2].length)),i[0]=r[0]-o,i[1]=r[0]+o,i},tci:function(){var o,r=n.call(arguments),i=new Array(2);return o=4===r.length?t.abs(e.studentt.inv(r[1]/2,r[3]-1)*r[2]/t.sqrt(r[3])):t.abs(e.studentt.inv(r[1]/2,r[2].length-1)*e.stdev(r[2],!0)/t.sqrt(r[2].length)),i[0]=r[0]-o,i[1]=r[0]+o,i},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,n){return e.normalci(t,n,this.toArray())},tci:function(t,n){return e.tci(t,n,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,n,o,r){var l=i(t,n,o,r);return e.ztest(l,1)},twoSidedDifferenceOfProportions:function(t,n,o,r){var l=i(t,n,o,r);return e.ztest(l,2)}})}(t,Math),t.models=function(){function e(e,n){var o=e.length,r=n[0].length-1,i=o-r-1,l=t.lstsq(n,e),s=t.multiply(n,l.map((function(e){return[e]}))).map((function(e){return e[0]})),a=t.subtract(e,s),c=t.mean(e),u=t.sum(s.map((function(e){return Math.pow(e-c,2)}))),d=t.sum(e.map((function(e,t){return Math.pow(e-s[t],2)}))),p=u+d;return{exog:n,endog:e,nobs:o,df_model:r,df_resid:i,coef:l,predict:s,resid:a,ybar:c,SST:p,SSE:u,SSR:d,R2:u/p}}return{ols:function(n,o){var r=e(n,o),i=function(n){var o,r,i=(o=n.exog,r=o[0].length,t.arange(r).map((function(n){var i=t.arange(r).filter((function(e){return e!==n}));return e(t.col(o,n).map((function(e){return e[0]})),t.col(o,i))}))),l=Math.sqrt(n.SSR/n.df_resid),s=i.map((function(e){var t=e.SST,n=e.R2;return l/Math.sqrt(t*(1-n))})),a=n.coef.map((function(e,t){return(e-0)/s[t]})),c=a.map((function(e){var o=t.studentt.cdf(e,n.df_resid);return 2*(o>.5?1-o:o)})),u=t.studentt.inv(.975,n.df_resid),d=n.coef.map((function(e,t){var n=u*s[t];return[e-n,e+n]}));return{se:s,t:a,p:c,sigmaHat:l,interval95:d}}(r),l=function(e){var n,o,r,i=e.R2/e.df_model/((1-e.R2)/e.df_resid);return{F_statistic:i,pvalue:1-(n=i,o=e.df_model,r=e.df_resid,t.beta.cdf(n/(r/o+n),o/2,r/2))}}(r),s=1-(1-r.R2)*((r.nobs-1)/r.df_resid);return r.t=i,r.f=l,r.adjust_R2=s,r}}}(),t.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),n=0;n<arguments.length;n++)e[n]=[1].concat(arguments[n]);return t(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),n=0;n<arguments[0].length;n++)e[n]=[1].concat(arguments[0][n]);return t(e)},buildjxmatrix:function(e){for(var n=new Array(e.length),o=0;o<e.length;o++)n[o]=e[o];return t.builddxmatrix(n)},buildymatrix:function(e){return t(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,n){var o,r,i,l,s;if(e.cols()==n.rows()){if(n.rows()>1){for(l=[],o=0;o<e.rows();o++)for(l[o]=[],r=0;r<n.cols();r++){for(s=0,i=0;i<e.cols();i++)s+=e.toArray()[o][i]*n.toArray()[i][r];l[o][r]=s}return t(l)}for(l=[],o=0;o<e.rows();o++)for(l[o]=[],r=0;r<n.cols();r++){for(s=0,i=0;i<e.cols();i++)s+=e.toArray()[o][i]*n.toArray()[r];l[o][r]=s}return t(l)}},regress:function(e,n){var o=t.xtranspxinv(e),r=e.transpose(),i=t.matrixmult(t(o),r);return t.matrixmult(i,n)},regresst:function(e,n,o){var r=t.regress(e,n),i={anova:{}},l=t.jMatYBar(e,r);i.yBar=l;var s=n.mean();i.anova.residuals=t.residuals(n,l),i.anova.ssr=t.ssr(l,s),i.anova.msr=i.anova.ssr/(e[0].length-1),i.anova.sse=t.sse(n,l),i.anova.mse=i.anova.sse/(n.length-(e[0].length-1)-1),i.anova.sst=t.sst(n,s),i.anova.mst=i.anova.sst/(n.length-1),i.anova.r2=1-i.anova.sse/i.anova.sst,i.anova.r2<0&&(i.anova.r2=0),i.anova.fratio=i.anova.msr/i.anova.mse,i.anova.pvalue=t.anovaftest(i.anova.fratio,e[0].length-1,n.length-(e[0].length-1)-1),i.anova.rmse=Math.sqrt(i.anova.mse),i.anova.r2adj=1-i.anova.mse/i.anova.mst,i.anova.r2adj<0&&(i.anova.r2adj=0),i.stats=new Array(e[0].length);for(var a,c,u,d=t.xtranspxinv(e),p=0;p<r.length;p++)a=Math.sqrt(i.anova.mse*Math.abs(d[p][p])),c=Math.abs(r[p]/a),u=t.ttest(c,n.length-e[0].length-1,o),i.stats[p]=[r[p],a,c,u];return i.regress=r,i},xtranspx:function(e){return t.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var n=t.matrixmult(e.transpose(),e);return t.inv(n)},jMatYBar:function(e,n){var o=t.matrixmult(e,n);return new t(o)},residuals:function(e,n){return t.matrixsubtract(e,n)},ssr:function(e,t){for(var n=0,o=0;o<e.length;o++)n+=Math.pow(e[o]-t,2);return n},sse:function(e,t){for(var n=0,o=0;o<e.length;o++)n+=Math.pow(e[o]-t[o],2);return n},sst:function(e,t){for(var n=0,o=0;o<e.length;o++)n+=Math.pow(e[o]-t,2);return n},matrixsubtract:function(e,n){for(var o=new Array(e.length),r=0;r<e.length;r++){o[r]=new Array(e[r].length);for(var i=0;i<e[r].length;i++)o[r][i]=e[r][i]-n[r][i]}return t(o)}}),t.jStat=t,t)},960:function(e,t,n){const o=n(592);e.exports=function(e){function t(e,t){const n=t.split(".");let o=e;for(const e of n){if(null==o)return;o=o[e]}return o}for(let n=0;n<Object.keys(o).length;n++){let r,i=Object.keys(o)[n],l=[];if("object"==typeof o[i]){l=Object.keys(o[i]),r=Object.values(o[i]);for(let e=0;e<r.length;e++)if("object"==typeof r[e]){let t=l[e];o[i][t]&&(l=[...l,...Object.keys(o[i][t]).map((e=>t+"."+e))],l.splice(l.indexOf(t),1))}}if(l.length<1)e[i]=o[i];else for(let n=0;n<l.length;n++)"function"==typeof t(o[i],l[n])&&(e[i]=t(o[i],l[n]))}let n=function(e){return"number"==typeof e&&(e=parseInt(e)),e},r=null,i=null,l=null;e.TABLE=function(){return l},e.COLUMN=e.COL=function(){return l.tracking&&l.tracking.push(c.getColumnNameFromCoords(n(r),n(i))),n(r)+1},e.ROW=function(){return l.tracking&&l.tracking.push(c.getColumnNameFromCoords(n(r),n(i))),n(i)+1},e.CELL=function(){return c.getColumnNameFromCoords(r,i)},e.VALUE=function(e,t,o){return l.getValueFromCoords(n(e)-1,n(t)-1,o)},e.THISROWCELL=function(e){return l.getValueFromCoords(n(e)-1,n(i))};const s=function(e,t){for(let n=0;n<e.length;n++){let o=c.getTokensFromRange(e[n]);t=t.replace(e[n],"["+o.join(",")+"]")}return t},a=function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},c=function(e,t,n,o,c){l=c,r=n,i=o;let u="",d={};if(t)if(t.size){let e,n=null;t.forEach((function(t,n){e=n.replace(/!/g,"."),-1!==e.indexOf(".")&&(e=e.split("."),d[e[0]]=!0)})),e=Object.keys(d);for(let t=0;t<e.length;t++)u+="var "+e[t]+" = {};";t.forEach((function(o,r){e=r.replace(/!/g,"."),null===o||a(o)||(n=o.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),n&&n.length&&(o=updateRanges(n,o))),e.indexOf(".")>0?u+=e+" = "+t.get(r)+";\n":u+="var "+e+" = "+o+";\n"}))}else{let e=Object.keys(t);if(e.length){let n,o={};for(let t=0;t<e.length;t++)if(n=e[t].replace(/\!/g,"."),n.indexOf(".")>0){let e=e.split(".");o[e[0]]={}}n=Object.keys(o);for(let e=0;e<n.length;e++)u+="var "+n[e]+" = {};";for(let o=0;o<e.length;o++){if(n=e[o].replace(/!/g,"."),null!==t[e[o]]&&!a(t[e[o]])){let n=t[e[o]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);n&&n.length&&(t[e[o]]=s(n,t[e[o]]))}n.indexOf(".")>0?u+=n+" = "+t[e[o]]+";\n":u+="var "+n+" = "+t[e[o]]+";\n"}}}let p=(e=function(e){let t="",n=0,o=["=","!",">","<"];for(let r=0;r<e.length;r++)'"'===e[r]&&(n=0===n?1:0),1===n?t+=e[r]:(t+=e[r].toUpperCase(),r>0&&"="===e[r]&&-1===o.indexOf(e[r-1])&&-1===o.indexOf(e[r+1])&&(t+="="));return t=t.replace(/\^/g,"**"),t=t.replace(/<>/g,"!="),t=t.replace(/&/g,"+"),t=t.replace(/\$/g,""),t}(e=(e=e.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);p&&p.length&&(e=s(p,e));let f=new Function(u+"; return "+e)();return null===f&&(f=0),f};return c.getColumnNameFromCoords=function(e,t){return o="",(n=parseInt(e))>701?(o+=String.fromCharCode(64+parseInt(n/676)),o+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(o+=String.fromCharCode(64+parseInt(n/26))),o+String.fromCharCode(65+n%26)+(parseInt(t)+1);var n,o},c.getCoordsFromColumnName=function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,o=0;o<t[0].length;o++)n+=parseInt(t[0].charCodeAt(o)-64)*Math.pow(26,t[0].length-1-o);--n<0&&(n=0);var r=parseInt(/[0-9]+$/.exec(e))||null;return r>0&&r--,[n,r]}},c.getRangeFromTokens=function(e){e=e.filter((function(e){return"#REF!"!=e}));for(var t="",n="",o=0;o<e.length;o++)e[o].indexOf(".")>=0?t=".":e[o].indexOf("!")>=0&&(t="!"),t&&(n=e[o].split(t),e[o]=n[1],n=n[0]+t);return e.sort((function(e,t){var n=Helpers.getCoordsFromColumnName(e),o=Helpers.getCoordsFromColumnName(t);return n[1]>o[1]?1:n[1]<o[1]?-1:n[0]>o[0]?1:n[0]<o[0]?-1:0})),e.length?n+(e[0]+":")+e[e.length-1]:"#REF!"},c.getTokensFromRange=function(e){if(e.indexOf(".")>0){var t=e.split(".");e=t[1],t=t[0]+"."}else e.indexOf("!")>0?(t=e.split("!"),e=t[1],t=t[0]+"!"):t="";e=e.split(":");var n=c.getCoordsFromColumnName(e[0]),o=c.getCoordsFromColumnName(e[1]);if(n[0]<=o[0])var r=n[0],i=o[0];else r=o[0],i=n[0];if(null===n[1]&&null==o[1])for(var l=null,s=null,a=Object.keys(vars),u=0;u<a.length;u++){var d=c.getCoordsFromColumnName(a[u]);d[0]===n[0]&&(null===l||d[1]<l)&&(l=d[1]),d[0]===o[0]&&(null===s||d[1]>s)&&(s=d[1])}else n[1]<=o[1]?(l=n[1],s=o[1]):(l=o[1],s=n[1]);for(var p=[],f=l;f<=s;f++){var h=[];for(u=r;u<=i;u++)h.push(t+c.getColumnNameFromCoords(u,f));p.push(h)}return p},c.setFormula=function(t){let n=Object.keys(t);for(let o=0;o<n.length;o++)"function"==typeof t[n[o]]&&(e[n[o]]=t[n[o]])},c.basic=!0,c}("undefined"==typeof window?n.g:window)},592:function(e,t,n){"use strict";var o=n(162),r=n(765);const i=new Error("#NULL!"),l=new Error("#DIV/0!"),s=new Error("#VALUE!"),a=new Error("#REF!"),c=new Error("#NAME?"),u=new Error("#NUM!"),d=new Error("#N/A"),p=new Error("#ERROR!"),f=new Error("#GETTING_DATA");var h=Object.freeze({__proto__:null,data:f,div0:l,error:p,na:d,name:c,nil:i,num:u,ref:a,value:s});function g(e){const t=[];return m(e,(e=>{t.push(e)})),t}function m(e,t){let n=-1;const o=e.length;for(;++n<o&&!1!==t(e[n],n,e););return e}function b(e){let t,n=e.length;for(;n--;)if(t=e[n],"number"!=typeof t)if(!0!==t)if(!1!==t){if("string"==typeof t){const o=S(t);e[n]=o instanceof Error?0:o}}else e[n]=0;else e[n]=1;return e}function j(e,t){if(!e)return s;e.every((e=>Array.isArray(e)))&&0!==e.length||(e=[[...e]]),e.map(((t,n)=>{t.map(((t,o)=>{t||(e[n][o]=0)}))}));const n=e.reduce(((t,n,o)=>n.length>e[t].length?o:t),0),o=e[n].length;return e.map((e=>[...e,...Array(o-e.length).fill(t||0)]))}function v(){let e;if(1===arguments.length){const n=arguments[0];e=null!=(t=n)&&"number"==typeof t.length&&"string"!=typeof t?g.apply(null,arguments):[n]}else e=Array.from(arguments);for(var t;!x(e);)e=y(e);return e}function y(e){return e&&e.reduce?e.reduce(((e,t)=>{const n=Array.isArray(e),o=Array.isArray(t);return n&&o?e.concat(t):n?(e.push(t),e):o?[e].concat(t):[e,t]})):[e]}function x(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function w(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e}function C(e){return e?e[0].map(((t,n)=>e.map((e=>e[n])))):s}function E(e,t){let n=null;return m(e,((e,o)=>{if(e[0]===t)return n=o,!1})),null==n?s:n}function A(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function L(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function M(e){const t=1e14;return Math.round(e*t)/t}function N(){return v.apply(null,arguments).filter((e=>"number"==typeof e))}function I(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){const t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||s}function T(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?u:function(e){e<60&&(e+=1);const t=Math.floor(e-25569),n=new Date(86400*t*1e3),o=e-Math.floor(e)+1e-7;let r=Math.floor(86400*o);const i=r%60;r-=i;const l=Math.floor(r/3600),s=Math.floor(r/60)%60;let a=n.getUTCDate(),c=n.getUTCMonth();return e>=60&&e<61&&(a=29,c=1),new Date(n.getUTCFullYear(),c,a,l,s,i)}(t)}return"string"!=typeof e||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?s:e}function D(e){let t,n=e.length;for(;n--;){if(t=T(e[n]),t===s)return t;e[n]=t}return e}function S(e){return e instanceof Error?e:null==e?0:("boolean"==typeof e&&(e=+e),isNaN(e)||""===e?s:parseFloat(e))}function O(e){let t,n;if(!e||0===(t=e.length))return s;for(;t--;){if(e[t]instanceof Error)return e[t];if(n=S(e[t]),n instanceof Error)return n;e[t]=n}return e}function k(e){return e instanceof Error?e:null==e?"":e.toString()}function R(){let e=arguments.length;for(;e--;)if("string"==typeof arguments[e])return!0;return!1}function F(e){return null!=e}const H=[">",">=","<","<=","=","<>"],_="operator",B="literal",P=[_,B],V=_,q=B;function Y(e,t){if(-1===P.indexOf(t))throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function U(e){return function(e){let t="";const n=[];for(let o=0;o<e.length;o++){const r=e[o];0===o&&H.indexOf(r)>=0?n.push(Y(r,V)):t+=r}return t.length>0&&n.push(Y(function(e){return"string"!=typeof e||/^\d+(\.\d+)?$/.test(e)&&(e=-1===e.indexOf(".")?parseInt(e,10):parseFloat(e)),e}(t),q)),n.length>0&&n[0].type!==V&&n.unshift(Y("=",V)),n}(function(e){const t=e.length,n=[];let o=0,r="",i="";for(;o<t;){const t=e.charAt(o);switch(t){case">":case"<":case"=":i+=t,r.length>0&&(n.push(r),r="");break;default:i.length>0&&(n.push(i),i=""),r+=t}o++}return r.length>0&&n.push(r),i.length>0&&n.push(i),n}(e))}const z=function(e){const t=[];let n;for(let o=0;o<e.length;o++){const r=e[o];switch(r.type){case V:n=r.value;break;case q:t.push(r.value)}}return function(e,t){let n=!1;switch(t){case">":n=e[0]>e[1];break;case">=":n=e[0]>=e[1];break;case"<":n=e[0]<e[1];break;case"<=":n=e[0]<=e[1];break;case"=":n=e[0]==e[1];break;case"<>":n=e[0]!=e[1]}return n}(t,n)},W={};function X(e){return[s,a,l,u,c,i].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))}function G(e){return X(e)||e===d}function $(e){return!0===e||!1===e}function K(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function Z(e){return"string"==typeof e}function J(){const e=[];for(let t=0;t<arguments.length;++t){let n=!1;const o=arguments[t];for(let t=0;t<e.length&&(n=e[t]===o,!n);++t);n||e.push(o)}return e}function Q(e,t,n,o){if(!t||!n)return d;o=!(0===o||!1===o);let r=d;const i="number"==typeof e;let l=!1;for(let s=0;s<t.length;s++){const c=t[s];if(c[0]===e){r=n<c.length+1?c[n-1]:a;break}!l&&(i&&o&&c[0]<=e||o&&"string"==typeof c[0]&&c[0].localeCompare(e)<0)&&(r=n<c.length+1?c[n-1]:a),i&&c[0]>e&&(l=!0)}return r}function ee(){const e=v(arguments).filter(F);if(0===e.length)return l;const t=A.apply(void 0,e);if(t)return t;const n=N(e),o=n.length;let r,i=0,s=0;for(let e=0;e<o;e++)i+=n[e],s+=1;return r=i/s,isNaN(r)&&(r=u),r}function te(){const e=v(arguments).filter(F);if(0===e.length)return l;const t=A.apply(void 0,e);if(t)return t;const n=e,o=n.length;let r,i=0,s=0;for(let e=0;e<o;e++){const t=n[e];"number"==typeof t&&(i+=t),!0===t&&i++,null!==t&&s++}return r=i/s,isNaN(r)&&(r=u),r}W.TYPE=e=>{switch(e){case i:return 1;case l:return 2;case s:return 3;case a:return 4;case c:return 5;case u:return 6;case d:return 7;case f:return 8}return d};const ne={DIST:function(e,t,n,r,i,l){return arguments.length<4?s:(i=void 0===i?0:i,l=void 0===l?1:l,L(e=S(e),t=S(t),n=S(n),i=S(i),l=S(l))?s:(e=(e-i)/(l-i),r?o.beta.cdf(e,t,n):o.beta.pdf(e,t,n)))},INV:(e,t,n,r,i)=>(r=void 0===r?0:r,i=void 0===i?1:i,L(e=S(e),t=S(t),n=S(n),r=S(r),i=S(i))?s:o.beta.inv(e,t,n)*(i-r)+r)},oe={DIST:(e,t,n,r)=>L(e=S(e),t=S(t),n=S(n),r=S(r))?s:r?o.binomial.cdf(e,t,n):o.binomial.pdf(e,t,n)};oe.DIST.RANGE=(e,t,n,o)=>{if(o=void 0===o?n:o,L(e=S(e),t=S(t),n=S(n),o=S(o)))return s;let r=0;for(let i=n;i<=o;i++)r+=Ve(e,i)*Math.pow(t,i)*Math.pow(1-t,e-i);return r},oe.INV=(e,t,n)=>{if(L(e=S(e),t=S(t),n=S(n)))return s;let r=0;for(;r<=e;){if(o.binomial.cdf(r,e,t)>=n)return r;r++}};const re={DIST:(e,t,n)=>L(e=S(e),t=S(t))?s:n?o.chisquare.cdf(e,t):o.chisquare.pdf(e,t)};re.DIST.RT=(e,t)=>!e|!t?d:e<1||t>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t?s:1-o.chisquare.cdf(e,t),re.INV=(e,t)=>L(e=S(e),t=S(t))?s:o.chisquare.inv(e,t),re.INV.RT=(e,t)=>!e|!t?d:e<0||e>1||t<1||t>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t?s:o.chisquare.inv(1-e,t),re.TEST=function(e,t){if(2!==arguments.length)return d;if(!(e instanceof Array&&t instanceof Array))return s;if(e.length!==t.length)return s;if(e[0]&&t[0]&&e[0].length!==t[0].length)return s;const n=e.length;let o,r,i;for(r=0;r<n;r++)e[r]instanceof Array||(o=e[r],e[r]=[],e[r].push(o)),t[r]instanceof Array||(o=t[r],t[r]=[],t[r].push(o));const l=e[0].length,a=1===l?n-1:(n-1)*(l-1);let c=0;const u=Math.PI;for(r=0;r<n;r++)for(i=0;i<l;i++)c+=Math.pow(e[r][i]-t[r][i],2)/t[r][i];return Math.round(1e6*function(e,t){let n=Math.exp(-.5*e);t%2==1&&(n*=Math.sqrt(2*e/u));let o=t;for(;o>=2;)n=n*e/o,o-=2;let r=n,i=t;for(;r>1e-10*n;)i+=2,r=r*e/i,n+=r;return 1-n}(c,a))/1e6};const ie={};function le(){return N(v(arguments)).length}function se(){const e=v(arguments);return e.length-ae(e)}function ae(){const e=v(arguments);let t,n=0;for(let o=0;o<e.length;o++)t=e[o],null!=t&&""!==t||n++;return n}ie.NORM=(e,t,n)=>L(e=S(e),t=S(t),n=S(n))?s:o.normalci(1,e,t,n)[1]-1,ie.T=(e,t,n)=>L(e=S(e),t=S(t),n=S(n))?s:o.tci(1,e,t,n)[1]-1;const ce={P:(e,t)=>{if(L(e=O(v(e)),t=O(v(t))))return s;const n=o.mean(e),r=o.mean(t);let i=0;const l=e.length;for(let o=0;o<l;o++)i+=(e[o]-n)*(t[o]-r);return i/l},S:(e,t)=>L(e=O(v(e)),t=O(v(t)))?s:o.covariance(e,t)},ue={DIST:(e,t,n)=>L(e=S(e),t=S(t))?s:n?o.exponential.cdf(e,t):o.exponential.pdf(e,t)},de={};function pe(e,t,n){if(L(e=S(e),t=O(v(t)),n=O(v(n))))return s;const r=o.mean(n),i=o.mean(t),l=n.length;let a=0,c=0;for(let e=0;e<l;e++)a+=(n[e]-r)*(t[e]-i),c+=Math.pow(n[e]-r,2);const u=a/c;return i-u*r+u*e}function fe(e){return(e=S(e))instanceof Error?e:0===e||parseInt(e,10)===e&&e<0?u:o.gammafn(e)}function he(e){return(e=S(e))instanceof Error?e:o.gammaln(e)}de.DIST=(e,t,n,r)=>L(e=S(e),t=S(t),n=S(n))?s:r?o.centralF.cdf(e,t,n):o.centralF.pdf(e,t,n),de.DIST.RT=function(e,t,n){return 3!==arguments.length?d:e<0||t<1||n<1?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?s:1-o.centralF.cdf(e,t,n)},de.INV=(e,t,n)=>L(e=S(e),t=S(t),n=S(n))?s:e<=0||e>1?u:o.centralF.inv(e,t,n),de.INV.RT=function(e,t,n){return 3!==arguments.length?d:e<0||e>1||t<1||t>Math.pow(10,10)||n<1||n>Math.pow(10,10)?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?s:o.centralF.inv(1-e,t,n)},de.TEST=(e,t)=>{if(!e||!t)return d;if(!(e instanceof Array&&t instanceof Array))return d;if(e.length<2||t.length<2)return l;const n=(e,t)=>{let n=0;for(let o=0;o<e.length;o++)n+=Math.pow(e[o]-t,2);return n},o=$e(e)/e.length,r=$e(t)/t.length;return n(e,o)/(e.length-1)/(n(t,r)/(t.length-1))},fe.DIST=function(e,t,n,r){return 4!==arguments.length?d:e<0||t<=0||n<=0||"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?s:r?o.gamma.cdf(e,t,n,!0):o.gamma.pdf(e,t,n,!1)},fe.INV=function(e,t,n){return 3!==arguments.length?d:e<0||e>1||t<=0||n<=0?u:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?s:o.gamma.inv(e,t,n)},he.PRECISE=function(e){return 1!==arguments.length?d:e<=0?u:"number"!=typeof e?s:o.gammaln(e)};const ge={};function me(e,t){return L(e=O(v(e)),t=S(t))?e:t<0||e.length<t?s:e.sort(((e,t)=>t-e))[t-1]}function be(e,t){if(L(e=O(v(e)),t=O(v(t))))return s;const n=o.mean(e),r=o.mean(t),i=t.length;let l=0,a=0;for(let o=0;o<i;o++)l+=(t[o]-r)*(e[o]-n),a+=Math.pow(t[o]-r,2);const c=l/a;return[c,n-c*r]}ge.DIST=(e,t,n,o,r)=>{if(L(e=S(e),t=S(t),n=S(n),o=S(o)))return s;function i(e,t,n,o){return Ve(n,e)*Ve(o-n,t-e)/Ve(o,t)}return r?function(e,t,n,o){let r=0;for(let l=0;l<=e;l++)r+=i(l,t,n,o);return r}(e,t,n,o):i(e,t,n,o)};const je={};function ve(){const e=v(arguments),t=A.apply(void 0,e);if(t)return t;const n=N(e);return 0===n.length?0:Math.max.apply(Math,n)}function ye(){const e=v(arguments),t=A.apply(void 0,e);if(t)return t;const n=b(e);let r=o.median(n);return isNaN(r)&&(r=u),r}function xe(){const e=v(arguments),t=A.apply(void 0,e);if(t)return t;const n=N(e);return 0===n.length?0:Math.min.apply(Math,n)}je.DIST=(e,t,n,r)=>L(e=S(e),t=S(t),n=S(n))?s:r?o.lognormal.cdf(e,t,n):o.lognormal.pdf(e,t,n),je.INV=(e,t,n)=>L(e=S(e),t=S(t),n=S(n))?s:o.lognormal.inv(e,t,n);const we={MULT:function(){const e=O(v(arguments));if(e instanceof Error)return e;const t=e.length,n={};let o,r=[],i=0;for(let l=0;l<t;l++)o=e[l],n[o]=n[o]?n[o]+1:1,n[o]>i&&(i=n[o],r=[]),n[o]===i&&(r[r.length]=o);return r},SNGL:function(){const e=O(v(arguments));return e instanceof Error?e:we.MULT(e).sort(((e,t)=>e-t))[0]}},Ce={DIST:(e,t,n,r)=>L(e=S(e),t=S(t),n=S(n))?s:r?o.negbin.cdf(e,t,n):o.negbin.pdf(e,t,n)},Ee={};function Ae(e,t){if(L(t=O(v(t)),e=O(v(e))))return s;const n=o.mean(e),r=o.mean(t),i=e.length;let l=0,a=0,c=0;for(let o=0;o<i;o++)l+=(e[o]-n)*(t[o]-r),a+=Math.pow(e[o]-n,2),c+=Math.pow(t[o]-r,2);return l/Math.sqrt(a*c)}Ee.DIST=(e,t,n,r)=>L(e=S(e),t=S(t),n=S(n))?s:n<=0?u:r?o.normal.cdf(e,t,n):o.normal.pdf(e,t,n),Ee.INV=(e,t,n)=>L(e=S(e),t=S(t),n=S(n))?s:o.normal.inv(e,t,n),Ee.S={},Ee.S.DIST=(e,t)=>(e=S(e))instanceof Error?s:t?o.normal.cdf(e,0,1):o.normal.pdf(e,0,1),Ee.S.INV=e=>(e=S(e))instanceof Error?s:o.normal.inv(e,0,1);const Le={EXC:(e,t)=>{if(L(e=O(v(e)),t=S(t)))return s;const n=(e=e.sort(((e,t)=>e-t))).length;if(t<1/(n+1)||t>1-1/(n+1))return u;const o=t*(n+1)-1,r=Math.floor(o);return M(o===r?e[o]:e[r]+(o-r)*(e[r+1]-e[r]))},INC:(e,t)=>{if(L(e=O(v(e)),t=S(t)))return s;const n=t*((e=e.sort(((e,t)=>e-t))).length-1),o=Math.floor(n);return M(n===o?e[n]:e[o]+(n-o)*(e[o+1]-e[o]))}},Me={EXC:(e,t,n)=>{if(n=void 0===n?3:n,L(e=O(v(e)),t=S(t),n=S(n)))return s;e=e.sort(((e,t)=>e-t));const o=J.apply(null,e),r=e.length,i=o.length,l=Math.pow(10,n);let a=0,c=!1,u=0;for(;!c&&u<i;)t===o[u]?(a=(e.indexOf(o[u])+1)/(r+1),c=!0):t>=o[u]&&(t<o[u+1]||u===i-1)&&(a=(e.indexOf(o[u])+1+(t-o[u])/(o[u+1]-o[u]))/(r+1),c=!0),u++;return Math.floor(a*l)/l},INC:(e,t,n)=>{if(n=void 0===n?3:n,L(e=O(v(e)),t=S(t),n=S(n)))return s;e=e.sort(((e,t)=>e-t));const o=J.apply(null,e),r=e.length,i=o.length,l=Math.pow(10,n);let a=0,c=!1,u=0;for(;!c&&u<i;)t===o[u]?(a=e.indexOf(o[u])/(r-1),c=!0):t>=o[u]&&(t<o[u+1]||u===i-1)&&(a=(e.indexOf(o[u])+(t-o[u])/(o[u+1]-o[u]))/(r-1),c=!0),u++;return Math.floor(a*l)/l}},Ne={DIST:(e,t,n)=>L(e=S(e),t=S(t))?s:n?o.poisson.cdf(e,t):o.poisson.pdf(e,t)},Ie={EXC:(e,t)=>{if(L(e=O(v(e)),t=S(t)))return s;switch(t){case 1:return Le.EXC(e,.25);case 2:return Le.EXC(e,.5);case 3:return Le.EXC(e,.75);default:return u}},INC:(e,t)=>{if(L(e=O(v(e)),t=S(t)))return s;switch(t){case 1:return Le.INC(e,.25);case 2:return Le.INC(e,.5);case 3:return Le.INC(e,.75);default:return u}}},Te={};function De(){const e=O(v(arguments));if(e instanceof Error)return e;const t=o.mean(e),n=e.length;let r=0;for(let o=0;o<n;o++)r+=Math.pow(e[o]-t,3);return n*r/((n-1)*(n-2)*Math.pow(o.stdev(e,!0),3))}function Se(e,t){return L(e=O(v(e)),t=S(t))?e:e.sort(((e,t)=>e-t))[t-1]}Te.AVG=(e,t,n)=>{if(L(e=S(e),t=O(v(t))))return s;const o=(n=n||!1)?(e,t)=>e-t:(e,t)=>t-e,r=(t=(t=v(t)).sort(o)).length;let i=0;for(let n=0;n<r;n++)t[n]===e&&i++;return i>1?(2*t.indexOf(e)+i+1)/2:t.indexOf(e)+1},Te.EQ=(e,t,n)=>{if(L(e=S(e),t=O(v(t))))return s;const o=(n=n||!1)?(e,t)=>e-t:(e,t)=>t-e;return(t=t.sort(o)).indexOf(e)+1},De.P=function(){const e=O(v(arguments));if(e instanceof Error)return e;const t=o.mean(e),n=e.length;let r=0,i=0;for(let o=0;o<n;o++)i+=Math.pow(e[o]-t,3),r+=Math.pow(e[o]-t,2);return i/=n,r/=n,i/Math.pow(r,1.5)};const Oe={P:function(){const e=Re.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=u),t},S:function(){const e=Re.S.apply(this,arguments);return Math.sqrt(e)}},ke={DIST:(e,t,n)=>1!==n&&2!==n?u:1===n?ke.DIST.RT(e,t):ke.DIST["2T"](e,t)};ke.DIST["2T"]=function(e,t){return 2!==arguments.length?d:e<0||t<1?u:"number"!=typeof e||"number"!=typeof t?s:2*(1-o.studentt.cdf(e,t))},ke.DIST.RT=function(e,t){return 2!==arguments.length?d:e<0||t<1?u:"number"!=typeof e||"number"!=typeof t?s:1-o.studentt.cdf(e,t)},ke.INV=(e,t)=>L(e=S(e),t=S(t))?s:o.studentt.inv(e,t),ke.INV["2T"]=(e,t)=>(e=S(e),t=S(t),e<=0||e>1||t<1?u:L(e,t)?s:Math.abs(o.studentt.inv(e/2,t))),ke.TEST=(e,t)=>{if(L(e=O(v(e)),t=O(v(t))))return s;const n=o.mean(e),r=o.mean(t);let i,l=0,a=0;for(i=0;i<e.length;i++)l+=Math.pow(e[i]-n,2);for(i=0;i<t.length;i++)a+=Math.pow(t[i]-r,2);l/=e.length-1,a/=t.length-1;const c=Math.abs(n-r)/Math.sqrt(l/e.length+a/t.length);return ke.DIST["2T"](c,e.length+t.length-2)};const Re={};function Fe(){const e=v(arguments),t=e.length;let n=0,o=0;const r=te(e);for(let i=0;i<t;i++){const t=e[i];n+="number"==typeof t?Math.pow(t-r,2):!0===t?Math.pow(1-r,2):Math.pow(0-r,2),null!==t&&o++}return n/(o-1)}function He(){const e=v(arguments),t=e.length;let n=0,o=0;const r=te(e);let i;for(let i=0;i<t;i++){const t=e[i];n+="number"==typeof t?Math.pow(t-r,2):!0===t?Math.pow(1-r,2):Math.pow(0-r,2),null!==t&&o++}return i=n/o,isNaN(i)&&(i=u),i}Re.P=function(){const e=N(v(arguments)),t=e.length;let n=0;const o=ee(e);let r;for(let r=0;r<t;r++)n+=Math.pow(e[r]-o,2);return r=n/t,isNaN(r)&&(r=u),r},Re.S=function(){const e=N(v(arguments)),t=e.length;let n=0;const o=ee(e);for(let r=0;r<t;r++)n+=Math.pow(e[r]-o,2);return n/(t-1)};const _e={DIST:(e,t,n,o)=>L(e=S(e),t=S(t),n=S(n))?s:o?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},Be={};function Pe(e,t,n){const o=A(e=S(e),t=S(t),n=S(n));if(o)return o;if(0===t)return 0;t=Math.abs(t);const r=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.ceil(e/t)*t,r):0===n?-Ge(Math.floor(Math.abs(e)/t)*t,r):-Ge(Math.ceil(Math.abs(e)/t)*t,r)}function Ve(e,t){return A(e=S(e),t=S(t))||(e<t?u:Ye(e)/(Ye(t)*Ye(e-t)))}Be.TEST=(e,t,n)=>{if(L(e=O(v(e)),t=S(t)))return s;n=n||Oe.S(e);const o=e.length;return 1-Ee.S.DIST((ee(e)-t)/(n/Math.sqrt(o)),!0)},Pe.MATH=Pe,Pe.PRECISE=Pe;const qe=[];function Ye(e){if((e=S(e))instanceof Error)return e;const t=Math.floor(e);return 0===t||1===t?1:(qe[t]>0||(qe[t]=Ye(t-1)*t),qe[t])}function Ue(e,t){const n=A(e=S(e),t=S(t));if(n)return n;if(0===t)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return u;t=Math.abs(t);const o=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.floor(e/t)*t,o):-Ge(Math.ceil(Math.abs(e)/t),o)}Ue.MATH=(e,t,n)=>{if(t instanceof Error)return t;t=void 0===t?0:t;const o=A(e=S(e),t=S(t),n=S(n));if(o)return o;if(0===t)return 0;t=t?Math.abs(t):1;const r=-Math.floor(Math.log(t)/Math.log(10));return e>=0?Ge(Math.floor(e/t)*t,r):0===n||void 0===n?-Ge(Math.ceil(Math.abs(e)/t)*t,r):-Ge(Math.floor(Math.abs(e)/t)*t,r)},Ue.PRECISE=Ue.MATH;const ze={CEILING:Pe};function We(e,t){const n=A(e=S(e),t=S(t));if(n)return n;if(0===e&&0===t)return u;const o=Math.pow(e,t);return isNaN(o)?u:o}function Xe(){const e=v(arguments).filter((e=>null!=e));if(0===e.length)return 0;const t=O(e);if(t instanceof Error)return t;let n=1;for(let e=0;e<t.length;e++)n*=t[e];return n}function Ge(e,t){return A(e=S(e),t=S(t))||Number(Math.round(Number(e+"e"+t))+"e"+-1*t)}function $e(){let e=0;return m(g(arguments),(t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if("number"==typeof t)e+=t;else if("string"==typeof t){const n=parseFloat(t);!isNaN(n)&&(e+=n)}else if(Array.isArray(t)){const n=$e.apply(null,t);n instanceof Error?e=n:e+=n}})),e}var Ke=Object.freeze({__proto__:null,ADD:function(e,t){return 2!==arguments.length?d:A(e=S(e),t=S(t))||e+t},DIVIDE:function(e,t){return 2!==arguments.length?d:A(e=S(e),t=S(t))||(0===t?l:e/t)},EQ:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e===t)},GT:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(R(e,t)?(e=k(e),t=k(t)):(e=S(e),t=S(t)),A(e,t)||e>t)},GTE:function(e,t){return 2!==arguments.length?d:(R(e,t)?(e=k(e),t=k(t)):(e=S(e),t=S(t)),A(e,t)||e>=t)},LT:function(e,t){return 2!==arguments.length?d:(R(e,t)?(e=k(e),t=k(t)):(e=S(e),t=S(t)),A(e,t)||e<t)},LTE:function(e,t){return 2!==arguments.length?d:(R(e,t)?(e=k(e),t=k(t)):(e=S(e),t=S(t)),A(e,t)||e<=t)},MINUS:function(e,t){return 2!==arguments.length?d:A(e=S(e),t=S(t))||e-t},MULTIPLY:function(e,t){return 2!==arguments.length?d:A(e=S(e),t=S(t))||e*t},NE:function(e,t){return 2!==arguments.length?d:e instanceof Error?e:t instanceof Error?t:(null===e&&(e=void 0),null===t&&(t=void 0),e!==t)},POW:function(e,t){return 2!==arguments.length?d:We(e,t)}});const Ze=new Date(Date.UTC(1900,0,1)),Je=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Qe=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],et=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function tt(e,t,n){n=n.toUpperCase(),e=T(e),t=T(t);const o=e.getFullYear(),r=e.getMonth(),i=e.getDate(),l=t.getFullYear(),s=t.getMonth(),a=t.getDate();let c;switch(n){case"Y":c=Math.floor(ut(e,t));break;case"D":c=ot(t,e);break;case"M":c=s-r+12*(l-o),a<i&&c--;break;case"MD":i<=a?c=a-i:(0===s?(e.setFullYear(l-1),e.setMonth(12)):(e.setFullYear(l),e.setMonth(s-1)),c=ot(t,e));break;case"YM":c=s-r+12*(l-o),a<i&&c--,c%=12;break;case"YD":s>r||s===r&&a<i?e.setFullYear(l):e.setFullYear(l-1),c=ot(t,e)}return c}function nt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function ot(e,t){return e=T(e),t=T(t),e instanceof Error?e:t instanceof Error?t:dt(nt(e))-dt(nt(t))}function rt(e,t,n){if(n=I(n||"false"),e=T(e),t=T(t),e instanceof Error)return e;if(t instanceof Error)return t;if(n instanceof Error)return n;const o=e.getMonth();let r,i,l=t.getMonth();if(n)r=31===e.getDate()?30:e.getDate(),i=31===t.getDate()?30:t.getDate();else{const n=new Date(e.getFullYear(),o+1,0).getDate(),s=new Date(t.getFullYear(),l+1,0).getDate();r=e.getDate()===n?30:e.getDate(),t.getDate()===s?r<30?(l++,i=1):i=30:i=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(l-o)+(i-r)}function it(e){if((e=T(e))instanceof Error)return e;(e=nt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function lt(e,t,n){return lt.INTL(e,t,1,n)}function st(e,t,n){return st.INTL(e,t,1,n)}function at(e){return 1===new Date(e,1,29).getMonth()}function ct(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function ut(e,t,n){if((e=T(e))instanceof Error)return e;if((t=T(t))instanceof Error)return t;n=n||0;let o=e.getDate();const r=e.getMonth()+1,i=e.getFullYear();let l=t.getDate();const s=t.getMonth()+1,a=t.getFullYear();switch(n){case 0:return 31===o&&31===l?(o=30,l=30):31===o?o=30:30===o&&31===l&&(l=30),(l+30*s+360*a-(o+30*r+360*i))/360;case 1:{const n=(e,t)=>{const n=e.getFullYear(),o=new Date(n,2,1);if(at(n)&&e<o&&t>=o)return!0;const r=t.getFullYear(),i=new Date(r,2,1);return at(r)&&t>=i&&e<i};let c=365;if(i===a||i+1===a&&(r>s||r===s&&o>=l))return(i===a&&at(i)||n(e,t)||1===s&&29===l)&&(c=366),ct(e,t)/c;const u=a-i+1,d=(new Date(a+1,0,1)-new Date(i,0,1))/1e3/60/60/24/u;return ct(e,t)/d}case 2:return ct(e,t)/360;case 3:return ct(e,t)/365;case 4:return(l+30*s+360*a-(o+30*r+360*i))/360}}function dt(e){const t=e>-22038912e5?2:1;return Math.ceil((e-Ze)/864e5)+t}function pt(e){return 0===(e=S(e))?s:e instanceof Error?e:String.fromCharCode(e)}function ft(e){if(L(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=s),t}function ht(){const e=v(arguments),t=A.apply(void 0,e);if(t)return t;let n=0;for(;(n=e.indexOf(!0))>-1;)e[n]="TRUE";let o=0;for(;(o=e.indexOf(!1))>-1;)e[o]="FALSE";return e.join("")}lt.INTL=(e,t,n,o)=>{if((e=T(e))instanceof Error)return e;if((t=T(t))instanceof Error)return t;let r=!1;const i=[],l=[1,2,3,4,5,6,0],a=new RegExp("^[0|1]{7}$");if(void 0===n)n=et[1];else if("string"==typeof n&&a.test(n)){r=!0,n=n.split("");for(let e=0;e<n.length;e++)"1"===n[e]&&i.push(l[e])}else n=et[n];if(!(n instanceof Array))return s;void 0===o?o=[]:o instanceof Array||(o=[o]);for(let e=0;e<o.length;e++){const t=T(o[e]);if(t instanceof Error)return t;o[e]=t}const c=Math.round((t-e)/864e5)+1;let u=c;const d=e;for(let e=0;e<c;e++){const e=(new Date).getTimezoneOffset()>0?d.getUTCDay():d.getDay();let t=r?i.includes(e):e===n[0]||e===n[1];for(let e=0;e<o.length;e++){const n=o[e];if(n.getDate()===d.getDate()&&n.getMonth()===d.getMonth()&&n.getFullYear()===d.getFullYear()){t=!0;break}}t&&u--,d.setDate(d.getDate()+1)}return u},st.INTL=(e,t,n,o)=>{if((e=T(e))instanceof Error)return e;if((t=S(t))instanceof Error)return t;if(t<0)return u;if(!((n=void 0===n?et[1]:et[n])instanceof Array))return s;void 0===o?o=[]:o instanceof Array||(o=[o]);for(let e=0;e<o.length;e++){const t=T(o[e]);if(t instanceof Error)return t;o[e]=t}let r=0;for(;r<t;){e.setDate(e.getDate()+1);const t=e.getDay();if(t!==n[0]&&t!==n[1]){for(let t=0;t<o.length;t++){const n=o[t];if(n.getDate()===e.getDate()&&n.getMonth()===e.getMonth()&&n.getFullYear()===e.getFullYear()){r--;break}}r++}}return e};const gt=ht;function mt(e,t=2,n=!1){if(e=S(e),isNaN(e))return s;if(t=S(t),isNaN(t))return s;if(t<0){const n=Math.pow(10,-t);e=Math.round(e/n)*n}else e=e.toFixed(t);if(n)e=e.toString().replace(/,/g,"");else{const t=e.toString().split(".");t[0]=t[0].replace(/\B(?=(\d{3})+$)/g,","),e=t.join(".")}return e}function bt(e,t){return A(e,t)||(e=k(e),(t=S(t))instanceof Error?t:new Array(t+1).join(e))}const jt=pt,vt=ft;function yt(e){return/^[01]{1,10}$/.test(e)}function xt(e,t,n){if(L(e=S(e),t=S(t)))return e;if("i"!==(n=void 0===n?"i":n)&&"j"!==n)return s;if(0===e&&0===t)return 0;if(0===e)return 1===t?n:t.toString()+n;if(0===t)return e.toString();{const o=t>0?"+":"";return e.toString()+o+(1===t?n:t.toString()+n)}}function wt(e,t){return t=void 0===t?0:t,L(e=S(e),t=S(t))?s:o.erf(e)}function Ct(e){return isNaN(e)?s:o.erfc(e)}function Et(e){const t=Tt(e),n=At(e);return L(t,n)?s:Math.sqrt(Math.pow(t,2)+Math.pow(n,2))}function At(e){if(void 0===e||!0===e||!1===e)return s;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));const o=e.substring(e.length-1,e.length),r="i"===o||"j"===o;return t>=0||n>=0?r?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?u:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?u:-Number(e.substring(n+1,e.length-1)):u:r?isNaN(e.substring(0,e.length-1))?u:e.substring(0,e.length-1):isNaN(e)?u:0}function Lt(e){const t=Tt(e),n=At(e);return L(t,n)?s:0===t&&0===n?l:0===t&&n>0?Math.PI/2:0===t&&n<0?-Math.PI/2:0===n&&t>0?0:0===n&&t<0?-Math.PI:t>0?Math.atan(n/t):t<0&&n>=0?Math.atan(n/t)+Math.PI:Math.atan(n/t)-Math.PI}function Mt(e){const t=Tt(e),n=At(e);if(L(t,n))return s;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",xt(Math.cos(t)*(Math.exp(n)+Math.exp(-n))/2,-Math.sin(t)*(Math.exp(n)-Math.exp(-n))/2,o)}function Nt(e){const t=Tt(e),n=At(e);if(L(t,n))return s;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",xt(Math.cos(n)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)-Math.exp(-t))/2,o)}function It(e,t){const n=Tt(e),o=At(e),r=Tt(t),i=At(t);if(L(n,o,r,i))return s;const l=e.substring(e.length-1),a=t.substring(t.length-1);let c="i";if(("j"===l||"j"===a)&&(c="j"),0===r&&0===i)return u;const d=r*r+i*i;return xt((n*r+o*i)/d,(o*r-n*i)/d,c)}function Tt(e){if(void 0===e||!0===e||!1===e)return s;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));const o=e.substring(e.length-1,e.length),r="i"===o||"j"===o;return t>=0||n>=0?r?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?u:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?u:Number(e.substring(0,n)):u:r?isNaN(e.substring(0,e.length-1))?u:0:isNaN(e)?u:e}function Dt(e){const t=Tt(e),n=At(e);if(L(t,n))return s;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",xt(Math.sin(t)*(Math.exp(n)+Math.exp(-n))/2,Math.cos(t)*(Math.exp(n)-Math.exp(-n))/2,o)}function St(e){const t=Tt(e),n=At(e);if(L(t,n))return s;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",xt(Math.cos(n)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(n)*(Math.exp(t)+Math.exp(-t))/2,o)}wt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Ct.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const Ot=ne.DIST,kt=ne.INV,Rt=oe.DIST,Ft=Pe.MATH,Ht=Pe.PRECISE,_t=re.DIST,Bt=re.DIST.RT,Pt=re.INV,Vt=re.INV.RT,qt=re.TEST,Yt=ce.P,Ut=ce.P,zt=ce.S,Wt=oe.INV,Xt=Ct.PRECISE,Gt=wt.PRECISE,$t=ue.DIST,Kt=de.DIST,Zt=de.DIST.RT,Jt=de.INV,Qt=de.INV.RT,en=Ue.MATH,tn=Ue.PRECISE,nn=de.TEST,on=fe.DIST,rn=fe.INV,ln=he.PRECISE,sn=ge.DIST,an=je.INV,cn=je.DIST,un=je.INV,dn=we.MULT,pn=we.SNGL,fn=Ce.DIST,hn=lt.INTL,gn=Ee.DIST,mn=Ee.INV,bn=Ee.S.DIST,jn=Ee.S.INV,vn=Le.EXC,yn=Le.INC,xn=Me.EXC,wn=Me.INC,Cn=Ne.DIST,En=Ie.EXC,An=Ie.INC,Ln=Te.AVG,Mn=Te.EQ,Nn=De.P,In=Oe.P,Tn=Oe.S,Dn=ke.DIST,Sn=ke.DIST.RT,On=ke.INV,kn=ke.TEST,Rn=Re.P,Fn=Re.S,Hn=_e.DIST,_n=st.INTL,Bn=Be.TEST;function Pn(e){const t=[];return m(e,(e=>{e&&t.push(e)})),t}function Vn(e,t){const n={};for(let t=1;t<e[0].length;++t)n[t]=!0;let o=t[0].length;for(let e=1;e<t.length;++e)t[e].length>o&&(o=t[e].length);for(let r=1;r<e.length;++r)for(let i=1;i<e[r].length;++i){let l=!1,s=!1;for(let n=0;n<t.length;++n){const a=t[n];if(a.length<o)continue;const c=a[0];if(e[r][0]===c){s=!0;for(let t=1;t<a.length;++t)if(!l)if(void 0===a[t]||"*"===a[t])l=!0;else{const n=U(a[t]+""),o=[Y(e[r][i],q)].concat(n);l=z(o)}}}s&&(n[i]=n[i]&&l)}const r=[];for(let t=0;t<e[0].length;++t)n[t]&&r.push(t-1);return r}function qn(e){return e&&e.getTime&&!isNaN(e.getTime())}function Yn(e){return e instanceof Date?e:new Date(e)}function Un(e,t,n,o,r){if(o=o||0,r=r||0,L(e=S(e),t=S(t),n=S(n),o=S(o),r=S(r)))return s;let i;if(0===e)i=o+n*t;else{const l=Math.pow(1+e,t);i=1===r?o*l+n*(1+e)*(l-1)/e:o*l+n*(l-1)/e}return-i}function zn(e,t,n,o,r,i){if(r=r||0,i=i||0,L(e=S(e),t=S(t),n=S(n),o=S(o),r=S(r),i=S(i)))return s;const l=Xn(e,n,o,r,i);return(1===t?1===i?0:-o:1===i?Un(e,t-2,l,o,1)-l:Un(e,t-1,l,o,0))*e}function Wn(){const e=O(v(arguments));if(e instanceof Error)return e;const t=e[0];let n=0;for(let o=1;o<e.length;o++)n+=e[o]/Math.pow(1+t,o);return n}function Xn(e,t,n,o,r){if(o=o||0,r=r||0,L(e=S(e),t=S(t),n=S(n),o=S(o),r=S(r)))return s;let i;if(0===e)i=(n+o)/t;else{const l=Math.pow(1+e,t);i=1===r?(o*e/(l-1)+n*e/(1-1/l))/(1+e):o*e/(l-1)+n*e/(1-1/l)}return-i}const Gn={errors:h,symbols:Ke};t.ABS=function(e){return(e=S(e))instanceof Error?e:Math.abs(e)},t.ACCRINT=function(e,t,n,o,r,i,l){return e=Yn(e),t=Yn(t),n=Yn(n),qn(e)&&qn(t)&&qn(n)?o<=0||r<=0||-1===[1,2,4].indexOf(i)||-1===[0,1,2,3,4].indexOf(l)||n<=e?u:(r=r||0)*o*ut(e,n,l=l||0):s},t.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},t.ACOS=function(e){if((e=S(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=u),t},t.ACOSH=function(e){if((e=S(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=u),t},t.ACOT=function(e){return(e=S(e))instanceof Error?e:Math.atan(1/e)},t.ACOTH=function(e){if((e=S(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=u),t},t.AGGREGATE=function(e,t,n,o){if(L(e=S(e),S(e)))return s;switch(e){case 1:return ee(n);case 2:return le(n);case 3:return se(n);case 4:return ve(n);case 5:return xe(n);case 6:return Xe(n);case 7:return Oe.S(n);case 8:return Oe.P(n);case 9:return $e(n);case 10:return Re.S(n);case 11:return Re.P(n);case 12:return ye(n);case 13:return we.SNGL(n);case 14:return me(n,o);case 15:return Se(n,o);case 16:return Le.INC(n,o);case 17:return Ie.INC(n,o);case 18:return Le.EXC(n,o);case 19:return Ie.EXC(n,o)}},t.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},t.AND=function(){const e=v(arguments);let t=s;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===s&&(t=!0),e[n]||(t=!1))}return t},t.ARABIC=function(e){if(null==e)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return s;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(e=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]})),t},t.ASC=function(){throw new Error("ASC is not implemented")},t.ASIN=function(e){if((e=S(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=u),t},t.ASINH=function(e){return(e=S(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},t.ATAN=function(e){return(e=S(e))instanceof Error?e:Math.atan(e)},t.ATAN2=function(e,t){return A(e=S(e),t=S(t))||Math.atan2(e,t)},t.ATANH=function(e){if((e=S(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=u),t},t.AVEDEV=function(){const e=v(arguments).filter(F);if(0===e.length)return u;const t=O(e);return t instanceof Error?t:o.sum(o(t).subtract(o.mean(t)).abs()[0])/t.length},t.AVERAGE=ee,t.AVERAGEA=te,t.AVERAGEIF=function(e,t,n){if(arguments.length<=1)return d;if(n=O(v(n=n||e).filter(F)),e=v(e),n instanceof Error)return n;let o=0,r=0;const i=void 0===t||"*"===t,l=i?null:U(t+"");for(let t=0;t<e.length;t++){const s=e[t];if(i)r+=n[t],o++;else{const e=[Y(s,q)].concat(l);z(e)&&(r+=n[t],o++)}}return r/o},t.AVERAGEIFS=function(){const e=g(arguments),t=(e.length-1)/2,n=v(e[0]);let o=0,r=0;for(let i=0;i<n.length;i++){let l=!1;for(let n=0;n<t;n++){const t=e[2*n+1][i],o=e[2*n+2];let r=!1;if(void 0===o||"*"===o)r=!0;else{const e=U(o+""),n=[Y(t,q)].concat(e);r=z(n)}if(!r){l=!1;break}l=!0}l&&(r+=n[i],o++)}const i=r/o;return isNaN(i)?0:i},t.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},t.BASE=function(e,t,n){const o=A(e=S(e),t=S(t),n=S(n));if(o)return o;if(0===t)return u;const r=e.toString(t);return new Array(Math.max(n+1-r.length,0)).join("0")+r},t.BESSELI=function(e,t){return L(e=S(e),t=S(t))?s:r.besseli(e,t)},t.BESSELJ=function(e,t){return L(e=S(e),t=S(t))?s:r.besselj(e,t)},t.BESSELK=function(e,t){return L(e=S(e),t=S(t))?s:r.besselk(e,t)},t.BESSELY=function(e,t){return L(e=S(e),t=S(t))?s:r.bessely(e,t)},t.BETA=ne,t.BETADIST=Ot,t.BETAINV=kt,t.BIN2DEC=function(e){if(!yt(e))return u;const t=parseInt(e,2),n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:t},t.BIN2HEX=function(e,t){if(!yt(e))return u;const n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);const o=parseInt(e,2).toString(16);return void 0===t?o:isNaN(t)?s:t<0?u:(t=Math.floor(t))>=o.length?bt("0",t-o.length)+o:u},t.BIN2OCT=function(e,t){if(!yt(e))return u;const n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);const o=parseInt(e,2).toString(8);return void 0===t?o:isNaN(t)?s:t<0?u:(t=Math.floor(t))>=o.length?bt("0",t-o.length)+o:u},t.BINOM=oe,t.BINOMDIST=Rt,t.BITAND=function(e,t){return L(e=S(e),t=S(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e&t},t.BITLSHIFT=function(e,t){return L(e=S(e),t=S(t))?s:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?u:t>=0?e<<t:e>>-t},t.BITOR=function(e,t){return L(e=S(e),t=S(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e|t},t.BITRSHIFT=function(e,t){return L(e=S(e),t=S(t))?s:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?u:t>=0?e>>t:e<<-t},t.BITXOR=function(e,t){return L(e=S(e),t=S(t))?s:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?u:e^t},t.CEILING=Pe,t.CEILINGMATH=Ft,t.CEILINGPRECISE=Ht,t.CELL=function(){throw new Error("CELL is not implemented")},t.CHAR=pt,t.CHIDIST=_t,t.CHIDISTRT=Bt,t.CHIINV=Pt,t.CHIINVRT=Vt,t.CHISQ=re,t.CHITEST=qt,t.CHOOSE=function(){if(arguments.length<2)return d;const e=arguments[0];return e<1||e>254||arguments.length<e+1?s:arguments[e]},t.CLEAN=function(e){return L(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},t.CODE=ft,t.COLUMN=function(e,t){return 2!==arguments.length?d:t<0?u:e instanceof Array&&"number"==typeof t?0!==e.length?o.col(e,t):void 0:s},t.COLUMNS=function(e){return 1!==arguments.length?d:e instanceof Array?0===e.length?0:o.cols(e):s},t.COMBIN=Ve,t.COMBINA=function(e,t){return A(e=S(e),t=S(t))||(e<t?u:0===e&&0===t?1:Ve(e+t-1,e-1))},t.COMPLEX=xt,t.CONCAT=gt,t.CONCATENATE=ht,t.CONFIDENCE=ie,t.CONVERT=function(e,t,n){if((e=S(e))instanceof Error)return e;const o=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],r={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},i={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let l,s=null,a=null,c=t,u=n,p=1,f=1;for(let e=0;e<o.length;e++)l=null===o[e][2]?[]:o[e][2],(o[e][1]===c||l.indexOf(c)>=0)&&(s=o[e]),(o[e][1]===u||l.indexOf(u)>=0)&&(a=o[e]);if(null===s){const e=r[t.substring(0,2)];let n=i[t.substring(0,1)];"da"===t.substring(0,2)&&(n=["dekao",10,"da"]),e?(p=e[2],c=t.substring(2)):n&&(p=n[1],c=t.substring(n[2].length));for(let e=0;e<o.length;e++)l=null===o[e][2]?[]:o[e][2],(o[e][1]===c||l.indexOf(c)>=0)&&(s=o[e])}if(null===a){const e=r[n.substring(0,2)];let t=i[n.substring(0,1)];"da"===n.substring(0,2)&&(t=["dekao",10,"da"]),e?(f=e[2],u=n.substring(2)):t&&(f=t[1],u=n.substring(t[2].length));for(let e=0;e<o.length;e++)l=null===o[e][2]?[]:o[e][2],(o[e][1]===u||l.indexOf(u)>=0)&&(a=o[e])}return null===s||null===a||s[3]!==a[3]?d:e*s[6]*p/(a[6]*f)},t.CORREL=function(e,t){return L(e=O(v(e)),t=O(v(t)))?s:o.corrcoeff(e,t)},t.COS=function(e){return(e=S(e))instanceof Error?e:Math.cos(e)},t.COSH=function(e){return(e=S(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},t.COT=function(e){return(e=S(e))instanceof Error?e:0===e?l:1/Math.tan(e)},t.COTH=function(e){if((e=S(e))instanceof Error)return e;if(0===e)return l;const t=Math.exp(2*e);return(t+1)/(t-1)},t.COUNT=le,t.COUNTA=se,t.COUNTBLANK=ae,t.COUNTIF=function(e,t){if(e=v(e),void 0===t||"*"===t)return e.length;let n=0;const o=U(t+"");for(let t=0;t<e.length;t++){const r=[Y(e[t],q)].concat(o);z(r)&&n++}return n},t.COUNTIFS=function(){const e=g(arguments),t=new Array(v(e[0]).length);for(let e=0;e<t.length;e++)t[e]=!0;for(let n=0;n<e.length;n+=2){const o=v(e[n]),r=e[n+1];if(void 0!==r&&"*"!==r){const e=U(r+"");for(let n=0;n<o.length;n++){const r=[Y(o[n],q)].concat(e);t[n]=t[n]&&z(r)}}}let n=0;for(let e=0;e<t.length;e++)t[e]&&n++;return n},t.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},t.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},t.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},t.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},t.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},t.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},t.COVAR=Yt,t.COVARIANCE=ce,t.COVARIANCEP=Ut,t.COVARIANCES=zt,t.CRITBINOM=Wt,t.CSC=function(e){return(e=S(e))instanceof Error?e:0===e?l:1/Math.sin(e)},t.CSCH=function(e){return(e=S(e))instanceof Error?e:0===e?l:2/(Math.exp(e)-Math.exp(-e))},t.CUMIPMT=function(e,t,n,o,r,i){if(L(e=S(e),t=S(t),n=S(n)))return s;if(e<=0||t<=0||n<=0)return u;if(o<1||r<1||o>r)return u;if(0!==i&&1!==i)return u;const l=Xn(e,t,n,0,i);let a=0;1===o&&(0===i&&(a=-n),o++);for(let t=o;t<=r;t++)a+=1===i?Un(e,t-2,l,n,1)-l:Un(e,t-1,l,n,0);return a*=e,a},t.CUMPRINC=function(e,t,n,o,r,i){if(L(e=S(e),t=S(t),n=S(n)))return s;if(e<=0||t<=0||n<=0)return u;if(o<1||r<1||o>r)return u;if(0!==i&&1!==i)return u;const l=Xn(e,t,n,0,i);let a=0;1===o&&(a=0===i?l+n*e:l,o++);for(let t=o;t<=r;t++)a+=i>0?l-(Un(e,t-2,l,n,1)-l)*e:l-Un(e,t-1,l,n,0)*e;return a},t.DATE=function(e,t,n){let o;return L(e=S(e),t=S(t),n=S(n))?o=s:(o=new Date(e,t-1,n),o.getFullYear()<0&&(o=u)),o},t.DATEDIF=tt,t.DATEVALUE=function(e){if("string"!=typeof e)return s;const t=Date.parse(e);return isNaN(t)?s:new Date(e)},t.DAVERAGE=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];if("string"==typeof t){const n=E(e,t);r=w(e[n])}else r=w(e[t]);let i=0;return m(o,(e=>{i+=r[e]})),0===o.length?l:i/o.length},t.DAY=function(e){const t=T(e);return t instanceof Error?t:t.getDate()},t.DAYS=ot,t.DAYS360=rt,t.DB=function(e,t,n,o,r){if(r=void 0===r?12:r,L(e=S(e),t=S(t),n=S(n),o=S(o),r=S(r)))return s;if(e<0||t<0||n<0||o<0)return u;if(-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(r))return u;if(o>n)return u;if(t>=e)return 0;const i=(1-Math.pow(t/e,1/n)).toFixed(3),l=e*i*r/12;let a=l,c=0;const d=o===n?n-1:o;for(let t=2;t<=d;t++)c=(e-a)*i,a+=c;return 1===o?l:o===n?(e-a)*i:c},t.DBCS=function(){throw new Error("DBCS is not implemented")},t.DCOUNT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];if("string"==typeof t){const n=E(e,t);r=w(e[n])}else r=w(e[t]);const i=[];return m(o,(e=>{i.push(r[e])})),le(i)},t.DCOUNTA=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];if("string"==typeof t){const n=E(e,t);r=w(e[n])}else r=w(e[t]);const i=[];return m(o,(e=>{i.push(r[e])})),se(i)},t.DDB=function(e,t,n,o,r){if(r=void 0===r?2:r,L(e=S(e),t=S(t),n=S(n),o=S(o),r=S(r)))return s;if(e<0||t<0||n<0||o<0||r<=0)return u;if(o>n)return u;if(t>=e)return 0;let i=0,l=0;for(let s=1;s<=o;s++)l=Math.min(r/n*(e-i),e-t-i),i+=l;return l},t.DEC2BIN=function(e,t){if((e=S(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return u;if(e<0)return"1"+bt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const n=parseInt(e,10).toString(2);return void 0===t?n:isNaN(t)?s:t<0?u:(t=Math.floor(t))>=n.length?bt("0",t-n.length)+n:u},t.DEC2HEX=function(e,t){if((e=S(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return u;if(e<0)return(1099511627776+e).toString(16);const n=parseInt(e,10).toString(16);return void 0===t?n:isNaN(t)?s:t<0?u:(t=Math.floor(t))>=n.length?bt("0",t-n.length)+n:u},t.DEC2OCT=function(e,t){if((e=S(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return u;if(e<0)return(1073741824+e).toString(8);const n=parseInt(e,10).toString(8);return void 0===t?n:isNaN(t)?s:t<0?u:(t=Math.floor(t))>=n.length?bt("0",t-n.length)+n:u},t.DECIMAL=function(e,t){return arguments.length<1?s:A(e=S(e),t=S(t))||(0===t?u:parseInt(e,t))},t.DEGREES=function(e){return(e=S(e))instanceof Error?e:180*e/Math.PI},t.DELTA=function(e,t){return t=void 0===t?0:t,L(e=S(e),t=S(t))?s:e===t?1:0},t.DEVSQ=function(){const e=O(v(arguments));if(e instanceof Error)return e;const t=o.mean(e);let n=0;for(let o=0;o<e.length;o++)n+=Math.pow(e[o]-t,2);return n},t.DGET=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];return r=w("string"==typeof t?e[E(e,t)]:e[t]),0===o.length?s:o.length>1?u:r[o[0]]},t.DISC=function(e,t,n,o,r){if(L(e=T(e),t=T(t),n=S(n),o=S(o),r=(r=S(r))||0))return s;if(n<=0||o<=0)return u;if(e>=t)return s;let i,l;switch(r){case 0:i=360,l=rt(e,t,!1);break;case 1:case 3:i=365,l=tt(e,t,"D");break;case 2:i=360,l=tt(e,t,"D");break;case 4:i=360,l=rt(e,t,!0);break;default:return u}return(o-n)/o*i/l},t.DMAX=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];if("string"==typeof t){const n=E(e,t);r=w(e[n])}else r=w(e[t]);let i=r[o[0]];return m(o,(e=>{i<r[e]&&(i=r[e])})),i},t.DMIN=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];if("string"==typeof t){const n=E(e,t);r=w(e[n])}else r=w(e[t]);let i=r[o[0]];return m(o,(e=>{i>r[e]&&(i=r[e])})),i},t.DOLLAR=function(e,t=2){if(e=S(e),isNaN(e))return s;const n={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},o=(e=Ge(e,t)).toLocaleString("en-US",n);return e<0?"$("+o.slice(2)+")":o},t.DOLLARDE=function(e,t){if(L(e=S(e),t=S(t)))return s;if(t<0)return u;if(t>=0&&t<1)return l;t=parseInt(t,10);let n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const o=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return n=Math.round(n*o)/o,n},t.DOLLARFR=function(e,t){if(L(e=S(e),t=S(t)))return s;if(t<0)return u;if(t>=0&&t<1)return l;t=parseInt(t,10);let n=parseInt(e,10);return n+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,n},t.DPRODUCT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];if("string"==typeof t){const n=E(e,t);r=w(e[n])}else r=w(e[t]);let i=[];m(o,(e=>{i.push(r[e])})),i=Pn(i);let l=1;return m(i,(e=>{l*=e})),l},t.DSTDEV=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];if("string"==typeof t){const n=E(e,t);r=w(e[n])}else r=w(e[t]);let i=[];return m(o,(e=>{i.push(r[e])})),i=Pn(i),Oe.S(i)},t.DSTDEVP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];if("string"==typeof t){const n=E(e,t);r=w(e[n])}else r=w(e[t]);let i=[];return m(o,(e=>{i.push(r[e])})),i=Pn(i),Oe.P(i)},t.DSUM=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];if("string"==typeof t){const n=E(e,t);r=w(e[n])}else r=w(e[t]);const i=[];return m(o,(e=>{i.push(r[e])})),$e(i)},t.DURATION=function(){throw new Error("DURATION is not implemented")},t.DVAR=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];if("string"==typeof t){const n=E(e,t);r=w(e[n])}else r=w(e[t]);const i=[];return m(o,(e=>{i.push(r[e])})),Re.S(i)},t.DVARP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return s;const o=Vn(e,n);let r=[];if("string"==typeof t){const n=E(e,t);r=w(e[n])}else r=w(e[t]);const i=[];return m(o,(e=>{i.push(r[e])})),Re.P(i)},t.EDATE=function(e,t){return(e=T(e))instanceof Error?e:isNaN(t)?s:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},t.EFFECT=function(e,t){return L(e=S(e),t=S(t))?s:e<=0||t<1?u:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},t.EOMONTH=function(e,t){return(e=T(e))instanceof Error?e:isNaN(t)?s:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},t.ERF=wt,t.ERFC=Ct,t.ERFCPRECISE=Xt,t.ERFPRECISE=Gt,t.ERROR=W,t.EVEN=function(e){return(e=S(e))instanceof Error?e:Pe(e,-2,-1)},t.EXACT=function(e,t){return 2!==arguments.length?d:A(e,t)||(e=k(e))===k(t)},t.EXP=function(e){return arguments.length<1?d:arguments.length>1?p:(e=S(e))instanceof Error?e:e=Math.exp(e)},t.EXPON=ue,t.EXPONDIST=$t,t.F=de,t.FACT=Ye,t.FACTDOUBLE=function e(t){if((t=S(t))instanceof Error)return t;const n=Math.floor(t);return n<=0?1:n*e(n-2)},t.FALSE=function(){return!1},t.FDIST=Kt,t.FDISTRT=Zt,t.FIND=function(e,t,n){if(arguments.length<2)return d;e=k(e),n=void 0===n?0:n;const o=(t=k(t)).indexOf(e,n-1);return-1===o?s:o+1},t.FINV=Jt,t.FINVRT=Qt,t.FISHER=function(e){return(e=S(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},t.FISHERINV=function(e){if((e=S(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},t.FIXED=mt,t.FLOOR=Ue,t.FLOORMATH=en,t.FLOORPRECISE=tn,t.FORECAST=pe,t.FREQUENCY=function(e,t){if(L(e=O(v(e)),t=O(v(t))))return s;const n=e.length,o=t.length,r=[];for(let i=0;i<=o;i++){r[i]=0;for(let l=0;l<n;l++)0===i?e[l]<=t[0]&&(r[0]+=1):i<o?e[l]>t[i-1]&&e[l]<=t[i]&&(r[i]+=1):i===o&&e[l]>t[o-1]&&(r[o]+=1)}return r},t.FTEST=nn,t.FV=Un,t.FVSCHEDULE=function(e,t){if(L(e=S(e),t=O(v(t))))return s;const n=t.length;let o=e;for(let e=0;e<n;e++)o*=1+t[e];return o},t.GAMMA=fe,t.GAMMADIST=on,t.GAMMAINV=rn,t.GAMMALN=he,t.GAMMALNPRECISE=ln,t.GAUSS=function(e){return(e=S(e))instanceof Error?e:o.normal.cdf(e,0,1)-.5},t.GCD=function(){const e=O(v(arguments));if(e instanceof Error)return e;const t=e.length,n=e[0];let o=n<0?-n:n;for(let n=1;n<t;n++){const t=e[n];let r=t<0?-t:t;for(;o&&r;)o>r?o%=r:r%=o;o+=r}return o},t.GEOMEAN=function(){const e=O(v(arguments));return e instanceof Error?e:o.geomean(e)},t.GESTEP=function(e,t){return L(t=t||0,e=S(e))?e:e>=t?1:0},t.GROWTH=function(e,t,n,o){if((e=O(e))instanceof Error)return e;let r;if(void 0===t)for(t=[],r=1;r<=e.length;r++)t.push(r);if(void 0===n)for(n=[],r=1;r<=e.length;r++)n.push(r);if(L(t=O(t),n=O(n)))return s;void 0===o&&(o=!0);const i=e.length;let l,a,c=0,u=0,d=0,p=0;for(r=0;r<i;r++){const n=t[r],o=Math.log(e[r]);c+=n,u+=o,d+=n*o,p+=n*n}c/=i,u/=i,d/=i,p/=i,o?(l=(d-c*u)/(p-c*c),a=u-l*c):(l=d/p,a=0);const f=[];for(r=0;r<n.length;r++)f.push(Math.exp(a+l*n[r]));return f},t.HARMEAN=function(){const e=O(v(arguments));if(e instanceof Error)return e;const t=e.length;let n=0;for(let o=0;o<t;o++)n+=1/e[o];return t/n},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const n=!(10!==e.length||"f"!==e.substring(0,1).toLowerCase()),o=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(o<-512||o>511)return u;if(n)return"1"+bt("0",9-(512+o).toString(2).length)+(512+o).toString(2);const r=o.toString(2);return void 0===t?r:isNaN(t)?s:t<0?u:(t=Math.floor(t))>=r.length?bt("0",t-r.length)+r:u},t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return u;const n=parseInt(e,16);if(n>536870911&&n<0xffe0000000)return u;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);const o=n.toString(8);return void 0===t?o:isNaN(t)?s:t<0?u:(t=Math.floor(t))>=o.length?bt("0",t-o.length)+o:u},t.HLOOKUP=function(e,t,n,o){return Q(e,C(t),n,o)},t.HOUR=function(e){return(e=T(e))instanceof Error?e:e.getHours()},t.HYPGEOM=ge,t.HYPGEOMDIST=sn,t.IF=function(e,t,n){return e instanceof Error?e:(null==(t=!(arguments.length>=2)||t)&&(t=0),null==(n=3===arguments.length&&n)&&(n=0),e?t:n)},t.IFERROR=function(e,t){return G(e)?t:e},t.IFNA=function(e,t){return e===d?t:e},t.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return d},t.IMABS=Et,t.IMAGINARY=At,t.IMARGUMENT=Lt,t.IMCONJUGATE=function(e){const t=Tt(e),n=At(e);if(L(t,n))return s;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",0!==n?xt(t,-n,o):e},t.IMCOS=Mt,t.IMCOSH=Nt,t.IMCOT=function(e){return L(Tt(e),At(e))?s:It(Mt(e),Dt(e))},t.IMCSC=function(e){return!0===e||!1===e?s:L(Tt(e),At(e))?u:It("1",Dt(e))},t.IMCSCH=function(e){return!0===e||!1===e?s:L(Tt(e),At(e))?u:It("1",St(e))},t.IMDIV=It,t.IMEXP=function(e){const t=Tt(e),n=At(e);if(L(t,n))return s;let o=e.substring(e.length-1);o="i"===o||"j"===o?o:"i";const r=Math.exp(t);return xt(r*Math.cos(n),r*Math.sin(n),o)},t.IMLN=function(e){const t=Tt(e),n=At(e);if(L(t,n))return s;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",xt(Math.log(Math.sqrt(t*t+n*n)),Math.atan(n/t),o)},t.IMLOG10=function(e){const t=Tt(e),n=At(e);if(L(t,n))return s;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",xt(Math.log(Math.sqrt(t*t+n*n))/Math.log(10),Math.atan(n/t)/Math.log(10),o)},t.IMLOG2=function(e){const t=Tt(e),n=At(e);if(L(t,n))return s;let o=e.substring(e.length-1);return o="i"===o||"j"===o?o:"i",xt(Math.log(Math.sqrt(t*t+n*n))/Math.log(2),Math.atan(n/t)/Math.log(2),o)},t.IMPOWER=function(e,t){if(L(t=S(t),Tt(e),At(e)))return s;let n=e.substring(e.length-1);n="i"===n||"j"===n?n:"i";const o=Math.pow(Et(e),t),r=Lt(e);return xt(o*Math.cos(t*r),o*Math.sin(t*r),n)},t.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return s;for(let t=1;t<arguments.length;t++){const n=Tt(e),o=At(e),r=Tt(arguments[t]),i=At(arguments[t]);if(L(n,o,r,i))return s;e=xt(n*r-o*i,n*i+o*r)}return e},t.IMREAL=Tt,t.IMSEC=function(e){return!0===e||!1===e||L(Tt(e),At(e))?s:It("1",Mt(e))},t.IMSECH=function(e){return L(Tt(e),At(e))?s:It("1",Nt(e))},t.IMSIN=Dt,t.IMSINH=St,t.IMSQRT=function(e){if(L(Tt(e),At(e)))return s;let t=e.substring(e.length-1);t="i"===t||"j"===t?t:"i";const n=Math.sqrt(Et(e)),o=Lt(e);return xt(n*Math.cos(o/2),n*Math.sin(o/2),t)},t.IMSUB=function(e,t){const n=Tt(e),o=At(e),r=Tt(t),i=At(t);if(L(n,o,r,i))return s;const l=e.substring(e.length-1),a=t.substring(t.length-1);let c="i";return("j"===l||"j"===a)&&(c="j"),xt(n-r,o-i,c)},t.IMSUM=function(){if(!arguments.length)return s;const e=v(arguments);let t=e[0];for(let n=1;n<e.length;n++){const o=Tt(t),r=At(t),i=Tt(e[n]),l=At(e[n]);if(L(o,r,i,l))return s;t=xt(o+i,r+l)}return t},t.IMTAN=function(e){return!0===e||!1===e||L(Tt(e),At(e))?s:It(Dt(e),Mt(e))},t.INDEX=function(e,t,n){const o=A(e,t,n);if(o)return o;if(!Array.isArray(e))return s;const r=e.length>0&&!Array.isArray(e[0]);return r&&!n?(n=t,t=1):(n=n||1,t=t||1),n<0||t<0?s:r&&1===t&&n<=e.length?e[n-1]:t<=e.length&&n<=e[t-1].length?e[t-1][n-1]:a},t.INFO=function(){throw new Error("INFO is not implemented")},t.INT=function(e){return(e=S(e))instanceof Error?e:Math.floor(e)},t.INTERCEPT=function(e,t){return L(e=O(e),t=O(t))?s:e.length!==t.length?d:pe(0,e,t)},t.INTRATE=function(){throw new Error("INTRATE is not implemented")},t.IPMT=zn,t.IRR=function(e,t){if(t=t||0,L(e=O(v(e)),t=S(t)))return s;const n=(e,t,n)=>{const o=n+1;let r=e[0];for(let n=1;n<e.length;n++)r+=e[n]/Math.pow(o,(t[n]-t[0])/365);return r},o=(e,t,n)=>{const o=n+1;let r=0;for(let n=1;n<e.length;n++){const i=(t[n]-t[0])/365;r-=i*e[n]/Math.pow(o,i+1)}return r},r=[];let i=!1,l=!1;for(let t=0;t<e.length;t++)r[t]=0===t?0:r[t-1]+365,e[t]>0&&(i=!0),e[t]<0&&(l=!0);if(!i||!l)return u;let a,c,d,p=t=void 0===t?.1:t,f=!0;do{d=n(e,r,p),a=p-d/o(e,r,p),c=Math.abs(a-p),p=a,f=c>1e-10&&Math.abs(d)>1e-10}while(f);return p},t.ISBLANK=function(e){return null===e},t.ISERR=X,t.ISERROR=G,t.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},t.ISLOGICAL=$,t.ISNA=function(e){return e===d},t.ISNONTEXT=function(e){return"string"!=typeof e},t.ISNUMBER=K,t.ISO=ze,t.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},t.ISOWEEKNUM=it,t.ISPMT=function(e,t,n,o){return L(e=S(e),t=S(t),n=S(n),o=S(o))?s:o*e*(t/n-1)},t.ISREF=function(){throw new Error("ISREF is not implemented")},t.ISTEXT=Z,t.KURT=function(){const e=O(v(arguments));if(e instanceof Error)return e;const t=o.mean(e),n=e.length;let r=0;for(let o=0;o<n;o++)r+=Math.pow(e[o]-t,4);return r/=Math.pow(o.stdev(e,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*r-3*(n-1)*(n-1)/((n-2)*(n-3))},t.LARGE=me,t.LCM=function(){const e=O(v(arguments));if(e instanceof Error)return e;for(var t,n,o,r,i=1;void 0!==(o=e.pop());){if(0===o)return 0;for(;o>1;){if(o%2){for(t=3,n=Math.floor(Math.sqrt(o));t<=n&&o%t;t+=2);r=t<=n?t:o}else r=2;for(o/=r,i*=r,t=e.length;t;e[--t]%r==0&&1==(e[t]/=r)&&e.splice(t,1));}}return i},t.LEFT=function(e,t){return A(e,t)||(e=k(e),(t=S(t=void 0===t?1:t))instanceof Error||"string"!=typeof e?s:e.substring(0,t))},t.LEN=function(e){return 0===arguments.length?p:e instanceof Error?e:Array.isArray(e)?s:k(e).length},t.LINEST=be,t.LN=function(e){return(e=S(e))instanceof Error?e:0===e?u:Math.log(e)},t.LOG=function(e,t){return A(e=S(e),t=S(t))||(0===e||0===t?u:Math.log(e)/Math.log(t))},t.LOG10=function(e){return(e=S(e))instanceof Error?e:0===e?u:Math.log(e)/Math.log(10)},t.LOGEST=function(e,t){if(L(e=O(v(e)),t=O(v(t))))return s;if(e.length!==t.length)return s;for(let t=0;t<e.length;t++)e[t]=Math.log(e[t]);const n=be(e,t);return n[0]=Math.round(1e6*Math.exp(n[0]))/1e6,n[1]=Math.round(1e6*Math.exp(n[1]))/1e6,n},t.LOGINV=an,t.LOGNORM=je,t.LOGNORMDIST=cn,t.LOGNORMINV=un,t.LOOKUP=function(e,t,n){t=v(t),n=n?v(n):t;const o="number"==typeof e;let r=d;for(let i=0;i<t.length;i++){if(t[i]===e)return n[i];if(o&&t[i]<=e||"string"==typeof t[i]&&t[i].localeCompare(e)<0)r=n[i];else if(o&&t[i]>e)return r}return r},t.LOWER=function(e){return 1!==arguments.length?s:L(e=k(e))?e:e.toLowerCase()},t.MATCH=function(e,t,n){if(!e||!t)return d;if(2===arguments.length&&(n=1),!((t=v(t))instanceof Array))return d;if(-1!==n&&0!==n&&1!==n)return d;let o,r;for(let i=0;i<t.length;i++)if(1===n){if(t[i]===e)return i+1;t[i]<e&&(r?t[i]>r&&(o=i+1,r=t[i]):(o=i+1,r=t[i]))}else if(0===n){if("string"==typeof e&&"string"==typeof t[i]){const n=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+n+"$").test(t[i].toLowerCase()))return i+1}else if(t[i]===e)return i+1}else if(-1===n){if(t[i]===e)return i+1;t[i]>e&&(r?t[i]<r&&(o=i+1,r=t[i]):(o=i+1,r=t[i]))}return o||d},t.MAX=ve,t.MAXA=function(){const e=v(arguments),t=A.apply(void 0,e);if(t)return t;let n=b(e);return n=n.map((e=>null==e?0:e)),0===n.length?0:Math.max.apply(Math,n)},t.MDURATION=function(){throw new Error("MDURATION is not implemented")},t.MEDIAN=ye,t.MID=function(e,t,n){if(null==t)return s;if(L(t=S(t),n=S(n))||"string"!=typeof e)return n;const o=t-1,r=o+n;return e.substring(o,r)},t.MIN=xe,t.MINA=function(){const e=v(arguments),t=A.apply(void 0,e);if(t)return t;let n=b(e);return n=n.map((e=>null==e?0:e)),0===n.length?0:Math.min.apply(Math,n)},t.MINUTE=function(e){return(e=T(e))instanceof Error?e:e.getMinutes()},t.MIRR=function(e,t,n){if(L(e=O(v(e)),t=S(t),n=S(n)))return s;const o=e.length,r=[],i=[];for(let t=0;t<o;t++)e[t]<0?r.push(e[t]):i.push(e[t]);const l=-Wn(n,i)*Math.pow(1+n,o-1),a=Wn(t,r)*(1+t);return Math.pow(l/a,1/(o-1))-1},t.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some((e=>!e.length))||t.some((e=>!e.length))||y(e).some((e=>"number"!=typeof e))||y(t).some((e=>"number"!=typeof e))||e[0].length!==t.length?s:Array(e.length).fill(0).map((()=>Array(t[0].length).fill(0))).map(((n,o)=>n.map(((n,r)=>e[o].reduce(((e,n,o)=>e+n*t[o][r]),0)))))},t.MOD=function(e,t){const n=A(e=S(e),t=S(t));if(n)return n;if(0===t)return l;let o=Math.abs(e%t);return o=e<0?t-o:o,t>0?o:-o},t.MODE=we,t.MODEMULT=dn,t.MODESNGL=pn,t.MONTH=function(e){return(e=T(e))instanceof Error?e:e.getMonth()+1},t.MROUND=function(e,t){return A(e=S(e),t=S(t))||(e*t==0?0:e*t<0?u:Math.round(e/t)*t)},t.MULTINOMIAL=function(){const e=O(v(arguments));if(e instanceof Error)return e;let t=0,n=1;for(let o=0;o<e.length;o++)t+=e[o],n*=Ye(e[o]);return Ye(t)/n},t.MUNIT=function(e){return arguments.length>1?d:!(e=parseInt(e))||e<=0?s:Array(e).fill(0).map((()=>Array(e).fill(0))).map(((e,t)=>(e[t]=1,e)))},t.N=function(e){return K(e)?e:e instanceof Date?e.getTime():!0===e?1:!1===e?0:G(e)?e:0},t.NA=function(){return d},t.NEGBINOM=Ce,t.NEGBINOMDIST=fn,t.NETWORKDAYS=lt,t.NETWORKDAYSINTL=hn,t.NOMINAL=function(e,t){return L(e=S(e),t=S(t))?s:e<=0||t<1?u:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},t.NORM=Ee,t.NORMDIST=gn,t.NORMINV=mn,t.NORMSDIST=bn,t.NORMSINV=jn,t.NOT=function(e){return"string"==typeof e?s:e instanceof Error?e:!e},t.NOW=function(){return new Date},t.NPER=function(e,t,n,o,r){if(r=void 0===r?0:r,o=void 0===o?0:o,L(e=S(e),t=S(t),n=S(n),o=S(o),r=S(r)))return s;if(0===e)return-(n+o)/t;{const i=t*(1+e*r)-o*e,l=n*e+t*(1+e*r);return Math.log(i/l)/Math.log(1+e)}},t.NPV=Wn,t.NUMBERVALUE=function(e,t,n){return"number"==typeof(e=F(e)?e:"")?e:"string"!=typeof e?d:(t=void 0===t?".":t,n=void 0===n?",":n,Number(e.replace(t,".").replace(n,"")))},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return u;const n=!(10!==e.length||"7"!==e.substring(0,1)),o=n?parseInt(e,8)-1073741824:parseInt(e,8);if(o<-512||o>511)return u;if(n)return"1"+bt("0",9-(512+o).toString(2).length)+(512+o).toString(2);const r=o.toString(2);return void 0===t?r:isNaN(t)?s:t<0?u:(t=Math.floor(t))>=r.length?bt("0",t-r.length)+r:u},t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return u;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return u;const n=parseInt(e,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);const o=n.toString(16);return void 0===t?o:isNaN(t)?s:t<0?u:(t=Math.floor(t))>=o.length?bt("0",t-o.length)+o:u},t.ODD=function(e){if((e=S(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},t.OR=function(){const e=v(arguments);let t=s;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===s&&(t=!1),e[n]&&(t=!0))}return t},t.PDURATION=function(e,t,n){return L(e=S(e),t=S(t),n=S(n))?s:e<=0?u:(Math.log(n)-Math.log(t))/Math.log(1+e)},t.PEARSON=Ae,t.PERCENTILE=Le,t.PERCENTILEEXC=vn,t.PERCENTILEINC=yn,t.PERCENTRANK=Me,t.PERCENTRANKEXC=xn,t.PERCENTRANKINC=wn,t.PERMUT=function(e,t){return L(e=S(e),t=S(t))?s:Ye(e)/Ye(e-t)},t.PERMUTATIONA=function(e,t){return L(e=S(e),t=S(t))?s:Math.pow(e,t)},t.PHI=function(e){return(e=S(e))instanceof Error?s:Math.exp(-.5*e*e)/2.5066282746310002},t.PI=function(){return Math.PI},t.PMT=Xn,t.POISSON=Ne,t.POISSONDIST=Cn,t.POWER=We,t.PPMT=function(e,t,n,o,r,i){return r=r||0,i=i||0,L(e=S(e),n=S(n),o=S(o),r=S(r),i=S(i))?s:Xn(e,n,o,r,i)-zn(e,t,n,o,r,i)},t.PRICE=function(){throw new Error("PRICE is not implemented")},t.PRICEDISC=function(e,t,n,o,r){if(L(e=T(e),t=T(t),n=S(n),o=S(o),r=(r=S(r))||0))return s;if(n<=0||o<=0)return u;if(e>=t)return s;let i,l;switch(r){case 0:i=360,l=rt(e,t,!1);break;case 1:case 3:i=365,l=tt(e,t,"D");break;case 2:i=360,l=tt(e,t,"D");break;case 4:i=360,l=rt(e,t,!0);break;default:return u}return o-n*o*l/i},t.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},t.PROB=function(e,t,n,o){if(void 0===n)return 0;if(o=void 0===o?n:o,L(e=O(v(e)),t=O(v(t)),n=S(n),o=S(o)))return s;if(n===o)return e.indexOf(n)>=0?t[e.indexOf(n)]:0;const r=e.sort(((e,t)=>e-t)),i=r.length;let l=0;for(let s=0;s<i;s++)r[s]>=n&&r[s]<=o&&(l+=t[e.indexOf(r[s])]);return l},t.PRODUCT=Xe,t.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},t.PROPER=function(e){return L(e)?e:isNaN(e)&&"number"==typeof e?s:(e=k(e)).replace(/\w\S*/g,(e=>e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()))},t.PV=function(e,t,n,o,r){return o=o||0,r=r||0,L(e=S(e),t=S(t),n=S(n),o=S(o),r=S(r))?s:0===e?-n*t-o:((1-Math.pow(1+e,t))/e*n*(1+e*r)-o)/Math.pow(1+e,t)},t.QUARTILE=Ie,t.QUARTILEEXC=En,t.QUARTILEINC=An,t.QUOTIENT=function(e,t){return A(e=S(e),t=S(t))||parseInt(e/t,10)},t.RADIANS=function(e){return(e=S(e))instanceof Error?e:e*Math.PI/180},t.RAND=function(){return Math.random()},t.RANDBETWEEN=function(e,t){return A(e=S(e),t=S(t))||e+Math.ceil((t-e+1)*Math.random())-1},t.RANK=Te,t.RANKAVG=Ln,t.RANKEQ=Mn,t.RATE=function(e,t,n,o,r,i){if(i=void 0===i?.01:i,o=void 0===o?0:o,r=void 0===r?0:r,L(e=S(e),t=S(t),n=S(n),o=S(o),r=S(r),i=S(i)))return s;const l=1e-10;let a=i;r=r?1:0;for(let i=0;i<20;i++){if(a<=-1)return u;let i,s,c;if(Math.abs(a)<l?i=n*(1+e*a)+t*(1+a*r)*e+o:(s=Math.pow(1+a,e),i=n*s+t*(1/a+r)*(s-1)+o),Math.abs(i)<l)return a;if(Math.abs(a)<l)c=n*e+t*r*e;else{s=Math.pow(1+a,e);const o=e*Math.pow(1+a,e-1);c=n*o+t*(1/a+r)*o+t*(-1/(a*a))*(s-1)}a-=i/c}return a},t.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},t.REPLACE=function(e,t,n,o){return L(t=S(t),n=S(n))||"string"!=typeof e||"string"!=typeof o?s:e.substr(0,t-1)+o+e.substr(t-1+n)},t.REPT=bt,t.RIGHT=function(e,t){return A(e,t)||(e=k(e),(t=S(t=void 0===t?1:t))instanceof Error?t:e.substring(e.length-t))},t.ROMAN=function(e){if((e=S(e))instanceof Error)return e;const t=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let o="",r=3;for(;r--;)o=(n[+t.pop()+10*r]||"")+o;return new Array(+t.join("")+1).join("M")+o},t.ROUND=Ge,t.ROUNDDOWN=function(e,t){return A(e=S(e),t=S(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROUNDUP=function(e,t){return A(e=S(e),t=S(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.ROW=function(e,t){return 2!==arguments.length?d:t<0?u:e instanceof Array&&"number"==typeof t?0!==e.length?o.row(e,t):void 0:s},t.ROWS=function(e){return 1!==arguments.length?d:e instanceof Array?0===e.length?0:o.rows(e):s},t.RRI=function(e,t,n){return L(e=S(e),t=S(t),n=S(n))?s:0===e||0===t?u:Math.pow(n/t,1/e)-1},t.RSQ=function(e,t){return L(e=O(v(e)),t=O(v(t)))?s:Math.pow(Ae(e,t),2)},t.SEARCH=function(e,t,n){let o;return"string"!=typeof e||"string"!=typeof t?s:(n=void 0===n?0:n,o=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1,0===o?s:o)},t.SEC=function(e){return(e=S(e))instanceof Error?e:1/Math.cos(e)},t.SECH=function(e){return(e=S(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},t.SECOND=function(e){return(e=T(e))instanceof Error?e:e.getSeconds()},t.SERIESSUM=function(e,t,n,o){if(L(e=S(e),t=S(t),n=S(n),o=O(o)))return s;let r=o[0]*Math.pow(e,t);for(let i=1;i<o.length;i++)r+=o[i]*Math.pow(e,t+i*n);return r},t.SHEET=function(){throw new Error("SHEET is not implemented")},t.SHEETS=function(){throw new Error("SHEETS is not implemented")},t.SIGN=function(e){return(e=S(e))instanceof Error?e:e<0?-1:0===e?0:1},t.SIN=function(e){return(e=S(e))instanceof Error?e:Math.sin(e)},t.SINH=function(e){return(e=S(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},t.SKEW=De,t.SKEWP=Nn,t.SLN=function(e,t,n){return L(e=S(e),t=S(t),n=S(n))?s:0===n?u:(e-t)/n},t.SLOPE=function(e,t){if(L(e=O(v(e)),t=O(v(t))))return s;const n=o.mean(t),r=o.mean(e),i=t.length;let l=0,a=0;for(let o=0;o<i;o++)l+=(t[o]-n)*(e[o]-r),a+=Math.pow(t[o]-n,2);return l/a},t.SMALL=Se,t.SORT=function(e,t=1,n=1,o=!1){if(!e||!Array.isArray(e))return d;if(0===e.length)return 0;if(!(t=S(t))||t<1)return s;if(1!==(n=S(n))&&-1!==n)return s;if("boolean"!=typeof(o=I(o)))return c;const r=e=>e.sort(((e,o)=>(e=k(e[t-1]),o=k(o[t-1]),1===n?e<o?-1*n:n:e>o?n:-1*n))),i=j(e),l=o?C(i):i;return t>=1&&t<=l[0].length?o?C(r(l)):r(l):s},t.SQRT=function(e){return(e=S(e))instanceof Error?e:e<0?u:Math.sqrt(e)},t.SQRTPI=function(e){return(e=S(e))instanceof Error?e:Math.sqrt(e*Math.PI)},t.STANDARDIZE=function(e,t,n){return L(e=S(e),t=S(t),n=S(n))?s:(e-t)/n},t.STDEV=Oe,t.STDEVA=function(){const e=Fe.apply(this,arguments);return Math.sqrt(e)},t.STDEVP=In,t.STDEVPA=function(){const e=He.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=u),t},t.STDEVS=Tn,t.STEYX=function(e,t){if(L(e=O(v(e)),t=O(v(t))))return s;const n=o.mean(t),r=o.mean(e),i=t.length;let l=0,a=0,c=0;for(let o=0;o<i;o++)l+=Math.pow(e[o]-r,2),a+=(t[o]-n)*(e[o]-r),c+=Math.pow(t[o]-n,2);return Math.sqrt((l-a*a/c)/(i-2))},t.SUBSTITUTE=function(e,t,n,o){if(arguments.length<3)return d;if(e&&t){if(void 0===o)return e.split(t).join(n);{if(o=Math.floor(Number(o)),Number.isNaN(o)||o<=0)return s;let r=0,i=0;for(;r>-1&&e.indexOf(t,r)>-1;)if(r=e.indexOf(t,r+1),i++,r>-1&&i===o)return e.substring(0,r)+n+e.substring(r+t.length);return e}}return e},t.SUBTOTAL=function(e,t){if((e=S(e))instanceof Error)return e;switch(e){case 1:case 101:return ee(t);case 2:case 102:return le(t);case 3:case 103:return se(t);case 4:case 104:return ve(t);case 5:case 105:return xe(t);case 6:case 106:return Xe(t);case 7:case 107:return Oe.S(t);case 8:case 108:return Oe.P(t);case 9:case 109:return $e(t);case 10:case 110:return Re.S(t);case 11:case 111:return Re.P(t)}},t.SUM=$e,t.SUMIF=function(e,t,n){if(e=v(e),n=n?v(n):e,e instanceof Error)return e;if(null==t||t instanceof Error)return 0;let o=0;const r="*"===t,i=r?null:U(t+"");for(let t=0;t<e.length;t++){const l=e[t],s=n[t];if(r)o+=l;else{const e=[Y(l,q)].concat(i);o+=z(e)?s:0}}return o},t.SUMIFS=function(){const e=g(arguments),t=O(v(e.shift()));if(t instanceof Error)return t;const n=e,o=n.length/2;for(let e=0;e<o;e++)n[2*e]=v(n[2*e]);let r=0;for(let e=0;e<t.length;e++){let i=!1;for(let t=0;t<o;t++){const o=n[2*t][e],r=n[2*t+1];let l=!1;if(void 0===r||"*"===r)l=!0;else{const e=U(r+""),t=[Y(o,q)].concat(e);l=z(t)}if(!l){i=!1;break}i=!0}i&&(r+=t[e])}return r},t.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return s;const e=arguments.length+1;let t,n,o,r,i=0;for(let l=0;l<arguments[0].length;l++)if(arguments[0][l]instanceof Array)for(let o=0;o<arguments[0][l].length;o++){for(t=1,n=1;n<e;n++){const e=arguments[n-1][l][o];if(e instanceof Error)return e;if(r=S(e),r instanceof Error)return r;t*=r}i+=t}else{for(t=1,n=1;n<e;n++){const e=arguments[n-1][l];if(e instanceof Error)return e;if(o=S(e),o instanceof Error)return o;t*=o}i+=t}return i},t.SUMSQ=function(){const e=O(v(arguments));if(e instanceof Error)return e;let t=0;const n=e.length;for(let o=0;o<n;o++)t+=K(e[o])?e[o]*e[o]:0;return t},t.SUMX2MY2=function(e,t){if(L(e=O(v(e)),t=O(v(t))))return s;let n=0;for(let o=0;o<e.length;o++)n+=e[o]*e[o]-t[o]*t[o];return n},t.SUMX2PY2=function(e,t){if(L(e=O(v(e)),t=O(v(t))))return s;let n=0;e=O(v(e)),t=O(v(t));for(let o=0;o<e.length;o++)n+=e[o]*e[o]+t[o]*t[o];return n},t.SUMXMY2=function(e,t){if(L(e=O(v(e)),t=O(v(t))))return s;let n=0;e=v(e),t=v(t);for(let o=0;o<e.length;o++)n+=Math.pow(e[o]-t[o],2);return n},t.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],n=arguments.length-1,o=Math.floor(n/2);let r=!1;const i=n%2!=0,l=n%2==0?null:arguments[arguments.length-1];if(o)for(let n=0;n<o;n++)if(t===arguments[2*n+1]){e=arguments[2*n+2],r=!0;break}r||(e=i?l:d)}else e=s;return e},t.SYD=function(e,t,n,o){return L(e=S(e),t=S(t),n=S(n),o=S(o))?s:0===n||o<1||o>n?u:(e-t)*(n-(o=parseInt(o,10))+1)*2/(n*(n+1))},t.T=function(e){return e instanceof Error||"string"==typeof e?e:""},t.TAN=function(e){return(e=S(e))instanceof Error?e:Math.tan(e)},t.TANH=function(e){if((e=S(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},t.TBILLEQ=function(e,t,n){return L(e=T(e),t=T(t),n=S(n))?s:n<=0||e>t||t-e>31536e6?u:365*n/(360-n*rt(e,t,!1))},t.TBILLPRICE=function(e,t,n){return L(e=T(e),t=T(t),n=S(n))?s:n<=0||e>t||t-e>31536e6?u:100*(1-n*rt(e,t,!1)/360)},t.TBILLYIELD=function(e,t,n){return L(e=T(e),t=T(t),n=S(n))?s:n<=0||e>t||t-e>31536e6?u:360*(100-n)/(n*rt(e,t,!1))},t.TDIST=Dn,t.TDISTRT=Sn,t.TEXT=function(e,t){if(void 0===e||e instanceof Error||t instanceof Error)return d;if(null==t)return"";if("number"==typeof t)return String(t);if("string"!=typeof t)return s;const n=t.startsWith("$")?"$":"",o=t.endsWith("%");return o&&(e*=100),e=(e=mt(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+n+(e=e.replace("-","")):n+e,o&&(e+="%"),e},t.TEXTJOIN=function(e,t,...n){if("boolean"!=typeof t&&(t=I(t)),arguments.length<3)return d;e=null!=e?e:"";let o=v(n),r=t?o.filter((e=>e)):o;if(Array.isArray(e)){e=v(e);let t=r.map((e=>[e])),n=0;for(let o=0;o<t.length-1;o++)t[o].push(e[n]),n++,n===e.length&&(n=0);return r=v(t),r.join("")}return r.join(e)},t.TIME=function(e,t,n){return L(e=S(e),t=S(t),n=S(n))?s:e<0||t<0||n<0?u:(3600*e+60*t+n)/86400},t.TIMEVALUE=function(e){return(e=T(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},t.TINV=On,t.TODAY=function(){return nt(new Date)},t.TRANSPOSE=function(e){return e?C(j(e)):d},t.TREND=function(e,t,n){if(L(e=O(v(e)),t=O(v(t)),n=O(v(n))))return s;const o=be(e,t),r=o[0],i=o[1],l=[];return n.forEach((e=>{l.push(r*e+i)})),l},t.TRIM=function(e){return(e=k(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},t.TRIMMEAN=function(e,t){if(L(e=O(v(e)),t=S(t)))return s;const n=Ue(e.length*t,2)/2;return o.mean((i=(i=n)||1,(r=w(e.sort(((e,t)=>e-t)),n))&&"function"==typeof r.slice?r.slice(0,r.length-i):r));var r,i},t.TRUE=function(){return!0},t.TRUNC=function(e,t){return A(e=S(e),t=S(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},t.TTEST=kn,t.TYPE=function(e){return K(e)?1:Z(e)?2:$(e)?4:G(e)?16:Array.isArray(e)?64:void 0},t.UNICHAR=jt,t.UNICODE=vt,t.UNIQUE=J,t.UPPER=function(e){return(e=k(e))instanceof Error?e:e.toUpperCase()},t.VALUE=function(e){const t=A(e);if(t)return t;if("number"==typeof e)return e;if(F(e)||(e=""),"string"!=typeof e)return s;const n=/(%)$/.test(e)||/^(%)/.test(e);if(""===(e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,"")))return 0;let o=Number(e);return isNaN(o)?s:(o=o||0,n&&(o*=.01),o)},t.VAR=Re,t.VARA=Fe,t.VARP=Rn,t.VARPA=He,t.VARS=Fn,t.VDB=function(){throw new Error("VDB is not implemented")},t.VLOOKUP=Q,t.WEEKDAY=function(e,t){if((e=T(e))instanceof Error)return e;void 0===t&&(t=1);const n=e.getDay();return Qe[t][n]},t.WEEKNUM=function(e,t){if((e=T(e))instanceof Error)return e;if(void 0===t&&(t=1),21===t)return it(e);const n=Je[t];let o=new Date(e.getFullYear(),0,1);const r=o.getDay()<n?1:0;return o-=24*Math.abs(o.getDay()-n)*60*60*1e3,Math.floor((e-o)/864e5/7+1)+r},t.WEIBULL=_e,t.WEIBULLDIST=Hn,t.WORKDAY=st,t.WORKDAYINTL=_n,t.XIRR=function(e,t,n){if(L(e=O(v(e)),t=D(v(t)),n=S(n)))return s;const o=(e,t,n)=>{const o=n+1;let r=e[0];for(let n=1;n<e.length;n++)r+=e[n]/Math.pow(o,ot(t[n],t[0])/365);return r},r=(e,t,n)=>{const o=n+1;let r=0;for(let n=1;n<e.length;n++){const i=ot(t[n],t[0])/365;r-=i*e[n]/Math.pow(o,i+1)}return r};let i=!1,l=!1;for(let t=0;t<e.length;t++)e[t]>0&&(i=!0),e[t]<0&&(l=!0);if(!i||!l)return u;let a,c,d,p=n=n||.1,f=!0;do{d=o(e,t,p),a=p-d/r(e,t,p),c=Math.abs(a-p),p=a,f=c>1e-10&&Math.abs(d)>1e-10}while(f);return p},t.XNPV=function(e,t,n){if(L(e=S(e),t=O(v(t)),n=D(v(n))))return s;let o=0;for(let r=0;r<t.length;r++)o+=t[r]/Math.pow(1+e,ot(n[r],n[0])/365);return o},t.XOR=function(){const e=v(arguments);let t=s;for(let n=0;n<e.length;n++){if(e[n]instanceof Error)return e[n];void 0!==e[n]&&null!==e[n]&&"string"!=typeof e[n]&&(t===s&&(t=0),e[n]&&t++)}return t===s?t:!!(1&Math.floor(Math.abs(t)))},t.YEAR=function(e){return(e=T(e))instanceof Error?e:e.getFullYear()},t.YEARFRAC=ut,t.YIELD=function(){throw new Error("YIELD is not implemented")},t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},t.Z=Be,t.ZTEST=Bn,t.utils=Gn}},n={};function o(t){var r=n[t];if(void 0!==r)return r.exports;var i=n[t]={exports:{}};return e[t].call(i.exports,i,i.exports,o),i.exports}o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}();var r=o(960);t=r}(),t)},44:function(module,__unused_webpack_exports,__nested_webpack_require_293504__){if(!formula)var formula=__nested_webpack_require_293504__(463);var factory;factory=function(){"use strict";var Version=(info={title:"Jspreadsheet",version:"4.15.0",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join("\r\n")}},function(){return info}),info,isFormula=function(e){var t=(""+e)[0];return"="==t||"#"==t},getMask=function(e){if(e.format||e.mask||e.locale){var t={};return e.mask?t.mask=e.mask:e.format?t.mask=e.format:(t.locale=e.locale,t.options=e.options),e.decimal&&(t.options||(t.options={}),t.options={decimal:e.decimal}),t}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if("TABLE"==el.tagName){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if("text"===property)for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,1==obj.options.lazyLoading&&0==obj.options.tableOverflow&&0==obj.options.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){null==e&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(obj.options.fullscreen=e,1==e?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){if(!obj.ignoreEvents){if("function"==typeof obj.options.onevent)var t=obj.options.onevent.apply(this,arguments);"function"==typeof obj.options[e]&&(t=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1)))}if("onafterchanges"==e&&obj.options.persistance){var n=1==obj.options.persistance?obj.options.url:obj.options.persistance,o=obj.prepareJson(arguments[2]);obj.save(n,o)}return t},obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&void 0!==obj.options.data[0]){var t=Object.keys(obj.options.data[0]);t.length>e&&(e=t.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);for(var n=[],o=0;o<e;o++)obj.options.colHeaders[o]||(obj.options.colHeaders[o]=""),obj.options.colWidths[o]||(obj.options.colWidths[o]=obj.options.defaultColWidth),obj.options.colAlignments[o]||(obj.options.colAlignments[o]=obj.options.defaultColAlign),obj.options.columns[o]?obj.options.columns[o].type||(obj.options.columns[o].type="text"):obj.options.columns[o]={type:"text"},obj.options.columns[o].name||(obj.options.columns[o].name=t&&t[o]?t[o]:o),obj.options.columns[o].source||(obj.options.columns[o].source=[]),obj.options.columns[o].options||(obj.options.columns[o].options=[]),obj.options.columns[o].editor||(obj.options.columns[o].editor=null),obj.options.columns[o].allowEmpty||(obj.options.columns[o].allowEmpty=!1),obj.options.columns[o].title||(obj.options.columns[o].title=obj.options.colHeaders[o]?obj.options.colHeaders[o]:""),obj.options.columns[o].width||(obj.options.columns[o].width=obj.options.colWidths[o]?obj.options.colWidths[o]:obj.options.defaultColWidth),obj.options.columns[o].align||(obj.options.columns[o].align=obj.options.colAlignments[o]?obj.options.colAlignments[o]:"center"),"autocomplete"==obj.options.columns[o].type||"dropdown"==obj.options.columns[o].type?obj.options.columns[o].url&&n.push({url:obj.options.columns[o].url,index:o,method:"GET",dataType:"json",success:function(e){for(var t=0;t<e.length;t++)obj.options.columns[this.index].source.push(e[t])}}):"calendar"==obj.options.columns[o].type&&(obj.options.columns[o].options.format||(obj.options.columns[o].options.format="DD/MM/YYYY"));n.length?jSuites.ajax(n,(function(){obj.createTable()})):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(e){obj.scrollControls(e)},obj.content.onwheel=function(e){obj.wheelControls(e)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),t=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(t),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var n=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var o=0;o<obj.options.paginationOptions.length;o++){var r=document.createElement("option");r.value=obj.options.paginationOptions[o],r.innerHTML=obj.options.paginationOptions[o],obj.paginationDropdown.appendChild(r)}obj.paginationDropdown.value=obj.options.pagination,n.appendChild(document.createTextNode(obj.options.text.show)),n.appendChild(obj.paginationDropdown),n.appendChild(document.createTextNode(obj.options.text.entries))}var i,l=document.createElement("div");if(l.classList.add("jexcel_filter"),l.appendChild(n),l.appendChild(e),obj.colgroupContainer=document.createElement("colgroup"),(i=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(i),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var s=0;s<obj.options.nestedHeaders.length;s++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[s]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(i=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(i),o=0;o<obj.options.columns.length;o++)obj.createCellHeader(o),obj.headerContainer.appendChild(obj.headers[o]),obj.colgroupContainer.appendChild(obj.colgroup[o]);if(obj.thead.appendChild(obj.headerContainer),1==obj.options.filters){obj.filter=document.createElement("tr");var a=document.createElement("td");for(obj.filter.appendChild(a),o=0;o<obj.options.columns.length;o++)(a=document.createElement("td")).innerHTML="&nbsp;",a.setAttribute("data-x",o),a.className="jexcel_column_filter","hidden"==obj.options.columns[o].type&&(a.style.display="none"),obj.filter.appendChild(a);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),0==obj.options.selectionCopy&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var c=document.createElement("a");c.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";var u=document.createElement("span");u.innerHTML="Jspreadsheet CE",c.appendChild(u),obj.ads.appendChild(c),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var d=document.createElement("div"),p=document.createElement("div");if(obj.pagination.appendChild(d),obj.pagination.appendChild(p),obj.options.pagination||(obj.pagination.style.display="none"),1==obj.options.search&&el.appendChild(l),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),1==obj.options.fullscreen?el.classList.add("fullscreen"):1==obj.options.tableOverflow&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),1!=obj.options.tableOverflow&&obj.options.toolbar&&el.classList.add("with-toolbar"),1==obj.options.columnDrag&&obj.thead.classList.add("draggable"),1==obj.options.columnResize&&obj.thead.classList.add("resizable"),1==obj.options.rowDrag&&obj.tbody.classList.add("draggable"),1==obj.options.rowResize&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var f=Object.keys(obj.options.classes);for(o=0;o<f.length;o++){var h=jexcel.getIdFromColumnName(f[o],!0);obj.records[h[1]][h[0]].classList.add(obj.options.classes[f[o]])}}},obj.refresh=function(){obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.setData(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&("string"==typeof e&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){e=[];for(var t=0;t<obj.options.data.length;t++){for(var n=[],o=0;o<obj.options.columns.length;o++)n[o]=obj.options.data[t][obj.options.columns[o].name];e.push(n)}obj.options.data=e}t=0,o=0;var r=obj.options.columns.length,i=obj.options.data.length,l=obj.options.minDimensions[0],s=obj.options.minDimensions[1],a=l>r?l:r,c=s>i?s:i;for(t=0;t<c;t++)for(o=0;o<a;o++)null==obj.options.data[t]&&(obj.options.data[t]=[]),null==obj.options.data[t][o]&&(obj.options.data[t][o]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",1==obj.options.lazyLoading){var u=0,d=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,u=obj.options.pagination*obj.pageNumber,d=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<d&&(d=obj.options.data.length)):(u=0,d=obj.options.data.length);for(t=0;t<obj.options.data.length;t++){var p=obj.createRow(t,obj.options.data[t]);t>=u&&t<d&&obj.tbody.appendChild(p)}if(1==obj.options.lazyLoading||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var f=Object.keys(obj.options.mergeCells);for(o=0;o<f.length;o++){var h=obj.options.mergeCells[f[o]];obj.setMerge(f[o],h[0],h[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,t){for(var n=[],o=0,r=0,i=1==t||0==obj.options.copyCompatibility,l=obj.options.columns.length,s=obj.options.data.length,a=0;a<s;a++){o=0;for(var c=0;c<l;c++)e&&!obj.records[a][c].classList.contains("highlight")||(n[r]||(n[r]=[]),n[r][o]=i?obj.options.data[a][c]:obj.records[a][c].innerHTML,o++);o>0&&r++}return n},obj.getJsonRow=function(e){for(var t=obj.options.data[e],n=obj.options.columns.length,o={},r=0;r<n;r++)obj.options.columns[r].name||(obj.options.columns[r].name=r),o[obj.options.columns[r].name]=t[r];return o},obj.getJson=function(e){for(var t=[],n=obj.options.columns.length,o=obj.options.data.length,r=0;r<o;r++){for(var i=null,l=0;l<n;l++)e&&!obj.records[r][l].classList.contains("highlight")||(null==i&&(i={}),obj.options.columns[l].name||(obj.options.columns[l].name=l),i[obj.options.columns[l].name]=obj.options.data[r][l]);null!=i&&t.push(i)}return t},obj.prepareJson=function(e){for(var t=[],n=0;n<e.length;n++){var o=e[n].x,r=e[n].y,i=obj.options.columns[o].name?obj.options.columns[o].name:o;t[r]||(t[r]={row:r,data:{}}),t[r].data[i]=e[n].newValue}return t.filter((function(e){return null!=e}))},obj.save=function(e,t){var n=obj.dispatch("onbeforesave",el,obj,t);if(n)t=n;else if(!1===n)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(t)},success:function(e){obj.dispatch("onsave",el,obj,t)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,t){for(var n=0;n<obj.headers.length;n++){var o=jexcel.getColumnNameFromId([n,e]);null!=t[n]&&obj.setValue(o,t[n])}},obj.getColumnData=function(e){for(var t=[],n=0;n<obj.options.data.length;n++)t.push(obj.options.data[n][e]);return t},obj.setColumnData=function(e,t){for(var n=0;n<obj.rows.length;n++){var o=jexcel.getColumnNameFromId([e,n]);null!=t[n]&&obj.setValue(o,t[n])}},obj.createRow=function(e,t){obj.records[e]||(obj.records[e]=[]),t||(t=obj.options.data[e]),obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var n=null;obj.options.defaultRowHeight&&(obj.rows[e].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title&&(n=obj.options.rows[e].title)),n||(n=parseInt(e+1));var o=document.createElement("td");o.innerHTML=n,o.setAttribute("data-y",e),o.className="jexcel_row",obj.rows[e].appendChild(o);for(var r=0;r<obj.options.columns.length;r++)obj.records[e][r]=obj.createCell(r,e,t[r]),obj.rows[e].appendChild(obj.records[e][r]);return obj.rows[e]},obj.parseValue=function(e,t,n,o){"="==(""+n).substr(0,1)&&1==obj.options.parseFormulas&&(n=obj.executeFormula(n,e,t));var r=obj.options.columns[e];if(r&&!isFormula(n)){var i=null;if(i=getMask(r)){n&&n==Number(n)&&(n=Number(n));var l=jSuites.mask.render(n,i,!0);if(o&&i.mask){var s=i.mask.split(";");s[1]&&(s[1].match(new RegExp("\\[Red\\]","gi"))&&(n<0?o.classList.add("red"):o.classList.remove("red")),s[1].match(new RegExp("\\(","gi"))&&n<0&&(l="("+l+")"))}l&&(n=l)}}return n};var validDate=function(e){return"-"==(e=""+e).substr(4,1)&&"-"==e.substr(7,1)||4==(e=e.split("-"))[0].length&&e[0]==Number(e[0])&&2==e[1].length&&e[1]==Number(e[1])};obj.createCell=function(e,t,n){var o=document.createElement("td");if(o.setAttribute("data-x",e),o.setAttribute("data-y",t),"="==(""+n).substr(0,1)&&1==obj.options.secureFormulas){var r=secureFormula(n);r!=n&&(n=r)}if(obj.options.columns[e].editor)!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?o.innerHTML=n:o.textContent=n,"function"==typeof obj.options.columns[e].editor.createCell&&(o=obj.options.columns[e].editor.createCell(o));else if("hidden"==obj.options.columns[e].type)o.style.display="none",o.textContent=n;else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){var i=document.createElement("input");i.type=obj.options.columns[e].type,i.name="c"+e,i.checked=1==n||1==n||"true"==n,i.onclick=function(){obj.setValue(o,this.checked)},1!=obj.options.columns[e].readOnly&&0!=obj.options.editable||i.setAttribute("disabled","disabled"),o.appendChild(i),obj.options.data[t][e]=i.checked}else if("calendar"==obj.options.columns[e].type){var l=null;if(!validDate(n)){var s=jSuites.calendar.extractDateFromString(n,obj.options.columns[e].options.format);s&&(l=s)}o.textContent=jSuites.calendar.getDateString(l||n,obj.options.columns[e].options.format)}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type)o.classList.add("jexcel_dropdown"),o.textContent=obj.getDropDownValue(e,n);else if("color"==obj.options.columns[e].type)if("square"==obj.options.columns[e].render){var a=document.createElement("div");a.className="color",a.style.backgroundColor=n,o.appendChild(a)}else o.style.color=n,o.textContent=n;else if("image"==obj.options.columns[e].type){if(n&&"data:image"==n.substr(0,10)){var c=document.createElement("img");c.src=n,o.appendChild(c)}}else"html"==obj.options.columns[e].type||!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?o.innerHTML=stripScript(obj.parseValue(e,t,n,o)):o.textContent=obj.parseValue(e,t,n,o);1==obj.options.columns[e].readOnly&&(o.className="readonly");var u=obj.options.columns[e].align?obj.options.columns[e].align:"center";return o.style.textAlign=u,0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||o.innerHTML.length>200)&&(o.style.whiteSpace="pre-wrap"),e>0&&1==this.options.textOverflow&&(n||o.innerHTML?obj.records[t][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(o.style.overflow="hidden")),o},obj.createCellHeader=function(e){var t=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth,n=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].textContent=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=n,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.headers[e].innerText),obj.options.columns[e].id&&obj.headers[e].setAttribute("id",obj.options.columns[e].id),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",t),"hidden"==obj.options.columns[e].type&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,t,n){obj.options.nestedHeaders[t][e].title&&(obj.options.nestedHeaders[t][e].title=n,obj.options.nestedHeaders[t].element.children[e+1].textContent=n)},obj.createNestedHeader=function(e){var t=document.createElement("tr");t.classList.add("jexcel_nested");var n=document.createElement("td");t.appendChild(n),e.element=t;for(var o=0,r=0;r<e.length;r++){e[r].colspan||(e[r].colspan=1),e[r].align||(e[r].align="center"),e[r].title||(e[r].title=""),e[r].id||(e[r].id="");for(var i=e[r].colspan,l=[],s=0;s<i;s++)obj.options.columns[o]&&"hidden"==obj.options.columns[o].type&&i++,l.push(o),o++;(n=document.createElement("td")).setAttribute("data-column",l.join(",")),n.setAttribute("colspan",e[r].colspan),n.setAttribute("align",e[r].align),n.setAttribute("id",e[r].id),n.textContent=e[r].title,t.appendChild(n)}return t},obj.createToolbar=function(e){e?obj.options.toolbar=e:e=obj.options.toolbar;for(var t=0;t<e.length;t++)if("i"==e[t].type)(i=document.createElement("i")).classList.add("jexcel_toolbar_item"),i.classList.add("material-icons"),i.setAttribute("data-k",e[t].k),i.setAttribute("data-v",e[t].v),i.setAttribute("id",e[t].id),e[t].tooltip&&i.setAttribute("title",e[t].tooltip),e[t].onclick&&(e[t].onclick,1)?i.onclick=function(t){var n=t;return function(){e[n].onclick(el,obj,this)}}(t):i.onclick=function(){var e=this.getAttribute("data-k"),t=this.getAttribute("data-v");obj.setStyle(obj.highlighted,e,t)},i.textContent=e[t].content,obj.toolbar.appendChild(i);else if("select"==e[t].type){var n=!1;(i=document.createElement("select")).classList.add("jexcel_toolbar_item"),i.setAttribute("data-k",e[t].k),e[t].tooltip&&i.setAttribute("title",e[t].tooltip),e[t].onchange&&(e[t].onchange,1)?(i.onchange=e[t].onchange,n=!0):i.onchange=function(){var e=this.getAttribute("data-k");obj.setStyle(obj.highlighted,e,this.value)};for(var o=0;o<e[t].v.length;o++){var r=document.createElement("option");r.value=e[t].v[o],r.textContent=e[t].v[o],e[t].selectedValue&&r.value===e[t].selectedValue&&(r.selected=!0),i.appendChild(r)}n&&i.dispatchEvent(new Event("change")),obj.toolbar.appendChild(i)}else if("color"==e[t].type){var i;(i=document.createElement("i")).classList.add("jexcel_toolbar_item"),i.classList.add("material-icons"),i.setAttribute("data-k",e[t].k),i.setAttribute("data-v",""),e[t].tooltip&&i.setAttribute("title",e[t].tooltip),obj.toolbar.appendChild(i),i.textContent=e[t].content,jSuites.color(i,{onchange:function(e,t){var n=e.getAttribute("data-k");obj.setStyle(obj.highlighted,n,t)}})}},obj.setMerge=function(e,t,n,o){var r=!1;if(!e){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var i=parseInt(obj.highlighted[0].getAttribute("data-x")),l=parseInt(obj.highlighted[0].getAttribute("data-y")),s=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),a=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));e=jexcel.getColumnNameFromId([i,l]),t=s-i+1,n=a-l+1}var c=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[c[1]][c[0]].getAttribute("data-merged")&&(r=obj.options.text.cellAlreadyMerged);else if((!t||t<2)&&(!n||n<2))r=obj.options.text.invalidMergeProperties;else for(var u=c[1];u<c[1]+n;u++)for(var d=c[0];d<c[0]+t;d++)jexcel.getColumnNameFromId([d,u]),obj.records[u][d].getAttribute("data-merged")&&(r=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(r)alert(r);else{t>1?obj.records[c[1]][c[0]].setAttribute("colspan",t):t=1,n>1?obj.records[c[1]][c[0]].setAttribute("rowspan",n):n=1,obj.options.mergeCells[e]=[t,n,[]],obj.records[c[1]][c[0]].setAttribute("data-merged","true"),obj.records[c[1]][c[0]].style.overflow="hidden";for(var p=[],f=c[1];f<c[1]+n;f++)for(var h=c[0];h<c[0]+t;h++)c[0]==h&&c[1]==f||(p.push(obj.options.data[f][h]),obj.updateCell(h,f,"",!0),obj.options.mergeCells[e][2].push(obj.records[f][h]),obj.records[f][h].style.display="none",obj.records[f][h]=obj.records[c[1]][c[0]]);obj.updateSelection(obj.records[c[1]][c[0]]),o||(obj.setHistory({action:"setMerge",column:e,colspan:t,rowspan:n,data:p}),obj.dispatch("onmerge",el,e,t,n))}},obj.getMerge=function(e){var t={};if(e)t=obj.options.mergeCells[e]?[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var n=Object.keys(obj.options.mergeCells),o=0;o<n.length;o++)t[n[o]]=[obj.options.mergeCells[n[o]][0],obj.options.mergeCells[n[o]][1]]}return t},obj.removeMerge=function(e,t,n){if(obj.options.mergeCells[e]){var o=jexcel.getIdFromColumnName(e,!0);obj.records[o[1]][o[0]].removeAttribute("colspan"),obj.records[o[1]][o[0]].removeAttribute("rowspan"),obj.records[o[1]][o[0]].removeAttribute("data-merged");for(var r=obj.options.mergeCells[e],i=0,l=0;l<r[1];l++)for(var s=0;s<r[0];s++)(l>0||s>0)&&(obj.records[o[1]+l][o[0]+s]=r[2][i],obj.records[o[1]+l][o[0]+s].style.display="",t&&t[i]&&obj.updateCell(o[0]+s,o[1]+l,t[i]),i++);obj.updateSelection(obj.records[o[1]][o[0]],obj.records[o[1]+l-1][o[0]+s-1]),n||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var t=Object.keys(obj.options.mergeCells),n=0;n<t.length;n++)obj.removeMerge(t[n],null,e)}},obj.isColMerged=function(e,t){var n=[];if(obj.options.mergeCells)for(var o=Object.keys(obj.options.mergeCells),r=0;r<o.length;r++){var i=jexcel.getIdFromColumnName(o[r],!0),l=obj.options.mergeCells[o[r]][0],s=i[0],a=i[0]+(l>1?l-1:0);null==t?s<=e&&a>=e&&n.push(o[r]):t?s<e&&a>=e&&n.push(o[r]):s<=e&&a>e&&n.push(o[r])}return n},obj.isRowMerged=function(e,t){var n=[];if(obj.options.mergeCells)for(var o=Object.keys(obj.options.mergeCells),r=0;r<o.length;r++){var i=jexcel.getIdFromColumnName(o[r],!0),l=obj.options.mergeCells[o[r]][1],s=i[1],a=i[1]+(l>1?l-1:0);null==t?s<=e&&a>=e&&n.push(o[r]):t?s<e&&a>=e&&n.push(o[r]):s<=e&&a>e&&n.push(o[r])}return n},obj.openFilter=function(e){if(obj.options.filters){e=parseInt(e),obj.resetSelection();var t=[];if("checkbox"==obj.options.columns[e].type)t.push({id:"true",name:"True"}),t.push({id:"false",name:"False"});else{for(var n=[],o=!1,r=0;r<obj.options.data.length;r++){var i=obj.options.data[r][e],l=obj.records[r][e].innerHTML;i&&l?n[i]=l:o=!0}var s=Object.keys(n);for(t=[],r=0;r<s.length;r++)t.push({id:s[r],name:n[s[r]]});o&&t.push({value:"",id:"",name:"(Blanks)"})}var a=document.createElement("div");obj.filter.children[e+1].innerHTML="",obj.filter.children[e+1].appendChild(a),obj.filter.children[e+1].style.paddingLeft="0px",obj.filter.children[e+1].style.paddingRight="0px",obj.filter.children[e+1].style.overflow="initial";var c={data:t,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==obj.filters[e]?obj.filters[e]:null,width:"100%",position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(t){obj.resetFilters(),obj.filters[e]=t.dropdown.getValue(!0),obj.filter.children[e+1].innerHTML=t.dropdown.getText(),obj.filter.children[e+1].style.paddingLeft="",obj.filter.children[e+1].style.paddingRight="",obj.filter.children[e+1].style.overflow="",obj.closeFilter(e),obj.refreshSelection()}};jSuites.dropdown(a,c)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(e){if(!e)for(var t=0;t<obj.filter.children.length;t++)obj.filters[t]&&(e=t);var n=function(e,t,n){for(var o=0;o<e.length;o++){var r=""+obj.options.data[n][t],i=""+obj.records[n][t].innerHTML;if(e[o]==r||e[o]==i)return!0}return!1},o=obj.filters[e];obj.results=[];for(var r=0;r<obj.options.data.length;r++)n(o,e,r)&&obj.results.push(r);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(e,t,n){var o=e.getAttribute("data-y"),r=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,r,o),r>0&&(obj.records[o][r-1].style.overflow="hidden");var i=function(t){var n=e.getBoundingClientRect(),i=document.createElement(t);return i.style.width=n.width+"px",i.style.height=n.height-2+"px",i.style.minHeight=n.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(i),obj.dispatch("oncreateeditor",el,e,r,o,i),i};if(1==e.classList.contains("readonly"));else if(obj.edition=[obj.records[o][r],obj.records[o][r].innerHTML,r,o],obj.options.columns[r].editor)obj.options.columns[r].editor.openEditor(e,el,t,n);else if("hidden"==obj.options.columns[r].type);else if("checkbox"==obj.options.columns[r].type||"radio"==obj.options.columns[r].type){var l=!e.children[0].checked;obj.setValue(e,l),obj.edition=null}else if("dropdown"==obj.options.columns[r].type||"autocomplete"==obj.options.columns[r].type){if(l=obj.options.data[o][r],obj.options.columns[r].multiple&&!Array.isArray(l)&&(l=l.split(";")),"function"==typeof obj.options.columns[r].filter)var s=obj.options.columns[r].filter(el,e,r,o,obj.options.columns[r].source);else s=obj.options.columns[r].source;for(var a=[],c=0;c<s.length;c++)a.push(s[c]);var u=i("div"),d={data:a,multiple:!!obj.options.columns[r].multiple,autocomplete:!(!obj.options.columns[r].autocomplete&&"autocomplete"!=obj.options.columns[r].type),opened:!0,value:l,width:"100%",height:u.style.minHeight,position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(){obj.closeEditor(e,!0)}};obj.options.columns[r].options&&obj.options.columns[r].options.type&&(d.type=obj.options.columns[r].options.type),jSuites.dropdown(u,d)}else if("calendar"==obj.options.columns[r].type||"color"==obj.options.columns[r].type)l=obj.options.data[o][r],(u=i("input")).value=l,1!=obj.options.tableOverflow&&1!=obj.options.fullscreen||(obj.options.columns[r].options.position=!0),obj.options.columns[r].options.value=obj.options.data[o][r],obj.options.columns[r].options.opened=!0,obj.options.columns[r].options.onclose=function(t,n){obj.closeEditor(e,!0)},"color"==obj.options.columns[r].type?jSuites.color(u,obj.options.columns[r].options):jSuites.calendar(u,obj.options.columns[r].options),u.focus();else if("html"==obj.options.columns[r].type){l=obj.options.data[o][r],(u=i("div")).style.position="relative",(h=document.createElement("div")).classList.add("jexcel_richtext"),u.appendChild(h),jSuites.editor(h,{focus:!0,value:l});var p=e.getBoundingClientRect(),f=h.getBoundingClientRect();window.innerHeight<p.bottom+f.height?h.style.top=p.top-(f.height+2)+"px":h.style.top=p.top+"px"}else if("image"==obj.options.columns[r].type){var h,g=e.children[0];(u=i("div")).style.position="relative",(h=document.createElement("div")).classList.add("jclose"),g&&g.src&&h.appendChild(g),u.appendChild(h),jSuites.image(h,obj.options.imageOptions),p=e.getBoundingClientRect(),f=h.getBoundingClientRect(),window.innerHeight<p.bottom+f.height?h.style.top=p.top-(f.height+2)+"px":h.style.top=p.top+"px"}else{l=1==t?"":obj.options.data[o][r],(u=0==obj.options.columns[r].wordWrap||1!=obj.options.wordWrap&&1!=obj.options.columns[r].wordWrap?i("input"):i("textarea")).focus(),u.value=l,d=obj.options.columns[r];var m=null;if(!isFormula(l)&&(m=getMask(d))){if(!d.disabledMaskOnEdition)if(d.mask){var b=d.mask.split(";");u.setAttribute("data-mask",b[0])}else d.locale&&u.setAttribute("data-locale",d.locale);m.input=u,u.mask=m,jSuites.mask.render(l,m,!1)}u.onblur=function(){obj.closeEditor(e,!0)},u.scrollLeft=u.scrollWidth}},obj.closeEditor=function(e,t){var n=parseInt(e.getAttribute("data-x")),o=parseInt(e.getAttribute("data-y"));if(1==t){if(obj.options.columns[n].editor)var r=obj.options.columns[n].editor.closeEditor(e,t);else if("checkbox"==obj.options.columns[n].type||"radio"==obj.options.columns[n].type||"hidden"==obj.options.columns[n].type);else if("dropdown"==obj.options.columns[n].type||"autocomplete"==obj.options.columns[n].type)r=e.children[0].dropdown.close(!0);else if("calendar"==obj.options.columns[n].type)r=e.children[0].calendar.close(!0);else if("color"==obj.options.columns[n].type)r=e.children[0].color.close(!0);else if("html"==obj.options.columns[n].type)r=e.children[0].children[0].editor.getData();else if("image"==obj.options.columns[n].type){var i=e.children[0].children[0].children[0];r=i&&"IMG"==i.tagName?i.src:""}else if("numeric"==obj.options.columns[n].type)"="!=(""+(r=e.children[0].value)).substr(0,1)&&""==r&&(r=obj.options.columns[n].allowEmpty?"":0),e.children[0].onblur=null;else{r=e.children[0].value,e.children[0].onblur=null;var l,s=obj.options.columns[n];if((l=getMask(s))&&""!==r&&!isFormula(r)&&"number"!=typeof r){var a=jSuites.mask.extract(r,l,!0);a&&""!==a.value&&(r=a.value)}}obj.options.data[o][n]==r?e.innerHTML=obj.edition[1]:obj.setValue(e,r)}else obj.options.columns[n].editor?obj.options.columns[n].editor.closeEditor(e,t):"dropdown"==obj.options.columns[n].type||"autocomplete"==obj.options.columns[n].type?e.children[0].dropdown.close(!0):"calendar"==obj.options.columns[n].type?e.children[0].calendar.close(!0):"color"==obj.options.columns[n].type?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,e,n,o,r,t),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],n=e[1];return obj.records[n][t]},obj.getColumnOptions=function(e,t){var n=obj.options.columns[e];return n||(n={type:"text"}),n},obj.getCellFromCoords=function(e,t){return obj.records[t][e]},obj.getLabel=function(e){var t=(e=jexcel.getIdFromColumnName(e,!0))[0],n=e[1];return obj.records[n][t].innerHTML},obj.getLabelFromCoords=function(e,t){return obj.records[t][e].innerHTML},obj.getValue=function(e,t){if("object"==typeof e)var n=e.getAttribute("data-x"),o=e.getAttribute("data-y");else n=(e=jexcel.getIdFromColumnName(e,!0))[0],o=e[1];var r=null;return null!=n&&null!=o&&(obj.records[o]&&obj.records[o][n]&&(t||1==obj.options.copyCompatibility)?r=obj.records[o][n].innerHTML:obj.options.data[o]&&"undefined"!=obj.options.data[o][n]&&(r=obj.options.data[o][n])),r},obj.getValueFromCoords=function(e,t,n){var o=null;return null!=e&&null!=t&&(obj.records[t]&&obj.records[t][e]&&n||1==obj.options.copyCompatibility?o=obj.records[t][e].innerHTML:obj.options.data[t]&&"undefined"!=obj.options.data[t][e]&&(o=obj.options.data[t][e])),o},obj.setValue=function(e,t,n){var o=[];if("string"==typeof e){var r=(a=jexcel.getIdFromColumnName(e,!0))[0],i=a[1];o.push(obj.updateCell(r,i,t,n)),obj.updateFormulaChain(r,i,o)}else if(r=null,i=null,e&&e.getAttribute&&(r=e.getAttribute("data-x"),i=e.getAttribute("data-y")),null!=r&&null!=i)o.push(obj.updateCell(r,i,t,n)),obj.updateFormulaChain(r,i,o);else{var l=Object.keys(e);if(l.length>0)for(var s=0;s<l.length;s++){var a;"string"==typeof e[s]?(r=(a=jexcel.getIdFromColumnName(e[s],!0))[0],i=a[1]):null!=e[s].x&&null!=e[s].y?(r=e[s].x,i=e[s].y,null!=e[s].newValue?t=e[s].newValue:null!=e[s].value&&(t=e[s].value)):(r=e[s].getAttribute("data-x"),i=e[s].getAttribute("data-y")),null!=r&&null!=i&&(o.push(obj.updateCell(r,i,t,n)),obj.updateFormulaChain(r,i,o))}}obj.setHistory({action:"setValue",records:o,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,o)},obj.setValueFromCoords=function(e,t,n,o){var r=[];r.push(obj.updateCell(e,t,n,o)),obj.updateFormulaChain(e,t,r),obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,r)},obj.setCheckRadioValue=function(){for(var e=[],t=Object.keys(obj.highlighted),n=0;n<t.length;n++){var o=obj.highlighted[n].getAttribute("data-x"),r=obj.highlighted[n].getAttribute("data-y");"checkbox"!=obj.options.columns[o].type&&"radio"!=obj.options.columns[o].type||e.push(obj.updateCell(o,r,!obj.options.data[r][o]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))};var stripScript=function(e){var t=new Option;t.innerHTML=e;var n=null;for(e=t.getElementsByTagName("script");n=e[0];)n.parentNode.removeChild(n);return t.innerHTML};obj.updateCell=function(e,t,n,o){if(1!=obj.records[t][e].classList.contains("readonly")||o){var r;"="==(""+n).substr(0,1)&&1==obj.options.secureFormulas&&(r=secureFormula(n))!=n&&(n=r),null!=(r=obj.dispatch("onbeforechange",el,obj.records[t][e],e,t,n))&&(n=r),obj.options.columns[e].editor&&"function"==typeof obj.options.columns[e].editor.updateCell&&(n=obj.options.columns[e].editor.updateCell(obj.records[t][e],n,o)),u={x:e,y:t,col:e,row:t,newValue:n,oldValue:obj.options.data[t][e]};let d=obj.options.columns[e].editor;if(d)obj.options.data[t][e]=n,"function"==typeof d.setValue&&d.setValue(obj.records[t][e],n);else if("checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type){if("radio"==obj.options.columns[e].type)for(var i=0;i<obj.options.data.length;i++)obj.options.data[i][e]=!1;obj.records[t][e].children[0].checked=1==n||1==n||"true"==n||"TRUE"==n,obj.options.data[t][e]=obj.records[t][e].children[0].checked}else if("dropdown"==obj.options.columns[e].type||"autocomplete"==obj.options.columns[e].type)obj.options.data[t][e]=n,obj.records[t][e].textContent=obj.getDropDownValue(e,n);else if("calendar"==obj.options.columns[e].type){var l=null;if(!validDate(n)){var s=jSuites.calendar.extractDateFromString(n,obj.options.columns[e].options.format);s&&(l=s)}obj.options.data[t][e]=n,obj.records[t][e].textContent=jSuites.calendar.getDateString(l||n,obj.options.columns[e].options.format)}else if("color"==obj.options.columns[e].type)if(obj.options.data[t][e]=n,"square"==obj.options.columns[e].render){var a=document.createElement("div");a.className="color",a.style.backgroundColor=n,obj.records[t][e].textContent="",obj.records[t][e].appendChild(a)}else obj.records[t][e].style.color=n,obj.records[t][e].textContent=n;else if("image"==obj.options.columns[e].type){if(n=""+n,obj.options.data[t][e]=n,obj.records[t][e].innerHTML="",n&&"data:image"==n.substr(0,10)){var c=document.createElement("img");c.src=n,obj.records[t][e].appendChild(c)}}else obj.options.data[t][e]=n,"html"==obj.options.columns[e].type?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,n)):!1===obj.options.stripHTML||!1===obj.options.columns[e].stripHTML?obj.records[t][e].innerHTML=stripScript(obj.parseValue(e,t,n,obj.records[t][e])):obj.records[t][e].textContent=obj.parseValue(e,t,n,obj.records[t][e]),0!=obj.options.columns[e].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[e].wordWrap||obj.records[t][e].innerHTML.length>200)?obj.records[t][e].style.whiteSpace="pre-wrap":obj.records[t][e].style.whiteSpace="";e>0&&(obj.records[t][e-1].style.overflow=n?"hidden":""),obj.dispatch("onchange",el,obj.records[t]&&obj.records[t][e]?obj.records[t][e]:null,e,t,n,u.oldValue)}else var u={x:e,y:t,col:e,row:t};return u},obj.copyData=function(e,t){var n=obj.getData(!0,!0),o=obj.selectedContainer,r=parseInt(e.getAttribute("data-x")),i=parseInt(e.getAttribute("data-y")),l=parseInt(t.getAttribute("data-x")),s=parseInt(t.getAttribute("data-y")),a=[],c=!1;if(o[0]==r){if(i<o[1])var u=i-o[1];else u=1;var d=0}else d=r<o[0]?r-o[0]:1,u=0;for(var p=0,f=0,h=i;h<=s;h++)if(!obj.rows[h]||"none"!=obj.rows[h].style.display){null==n[f]&&(f=0),p=0,o[0]!=r&&(d=r<o[0]?r-o[0]:1);for(var g=r;g<=l;g++){if(obj.records[h][g]&&!obj.records[h][g].classList.contains("readonly")&&"none"!=obj.records[h][g].style.display&&0==c){if(!obj.selection.length&&""!=obj.options.data[h][g]){c=!0;continue}(null==n[f]||null==n[f][p])&&(p=0);var m=n[f][p];if(m&&!n[1]&&1==obj.options.autoIncrement)if("text"==obj.options.columns[g].type||"number"==obj.options.columns[g].type)if("="==(""+m).substr(0,1)){var b=m.match(/([A-Z]+[0-9]+)/g);if(b){for(var j=[],v=0;v<b.length;v++){var y=jexcel.getIdFromColumnName(b[v],1);y[0]+=d,y[1]+=u,y[1]<0&&(y[1]=0);var x=jexcel.getColumnNameFromId([y[0],y[1]]);x!=b[v]&&(j[b[v]]=x)}j&&(m=obj.updateFormula(m,j))}}else m==Number(m)&&(m=Number(m)+u);else if("calendar"==obj.options.columns[g].type){var w=new Date(m);w.setDate(w.getDate()+u),m=w.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(w.getMonth()+1))+"-"+jexcel.doubleDigitFormat(w.getDate())+" 00:00:00"}a.push(obj.updateCell(g,h,m)),obj.updateFormulaChain(g,h,a)}p++,o[0]!=r&&d++}f++,u++}obj.setHistory({action:"setValue",records:a,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,a)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,t,n){if(1==e){if(obj.selectedCell&&(t>=obj.selectedCell[1]&&t<=obj.selectedCell[3]||n>=obj.selectedCell[1]&&n<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(t>=obj.selectedCell[0]&&t<=obj.selectedCell[2]||n>=obj.selectedCell[0]&&n<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(e){if(obj.highlighted.length){c=1;for(var t=0;t<obj.highlighted.length;t++){obj.highlighted[t].classList.remove("highlight"),obj.highlighted[t].classList.remove("highlight-left"),obj.highlighted[t].classList.remove("highlight-right"),obj.highlighted[t].classList.remove("highlight-top"),obj.highlighted[t].classList.remove("highlight-bottom"),obj.highlighted[t].classList.remove("highlight-selected");var n=parseInt(obj.highlighted[t].getAttribute("data-x")),o=parseInt(obj.highlighted[t].getAttribute("data-y"));if(obj.highlighted[t].getAttribute("data-merged"))var r=parseInt(obj.highlighted[t].getAttribute("colspan")),i=parseInt(obj.highlighted[t].getAttribute("rowspan")),l=r>0?n+(r-1):n,s=i>0?o+(i-1):o;else l=n,s=o;for(var a=n;a<=l;a++)obj.headers[a]&&obj.headers[a].classList.remove("selected");for(a=o;a<=s;a++)obj.rows[a]&&obj.rows[a].classList.remove("selected")}}else var c=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",1==e&&1==c&&obj.dispatch("onblur",el),c},obj.updateSelection=function(e,t,n){var o=e.getAttribute("data-x"),r=e.getAttribute("data-y");if(t)var i=t.getAttribute("data-x"),l=t.getAttribute("data-y");else i=o,l=r;obj.updateSelectionFromCoords(o,r,i,l,n)},obj.updateSelectionFromCoords=function(e,t,n,o,r){var i=obj.resetSelection();if(null==t&&(t=0,o=obj.rows.length-1),null==n&&(n=e),null==o&&(o=t),e>=obj.headers.length&&(e=obj.headers.length-1),t>=obj.rows.length&&(t=obj.rows.length-1),n>=obj.headers.length&&(n=obj.headers.length-1),o>=obj.rows.length&&(o=obj.rows.length-1),obj.selectedCell=[e,t,n,o],null!=e){if(obj.records[t][e]&&obj.records[t][e].classList.add("highlight-selected"),parseInt(e)<parseInt(n))var l=parseInt(e),s=parseInt(n);else l=parseInt(n),s=parseInt(e);if(parseInt(t)<parseInt(o))var a=parseInt(t),c=parseInt(o);else a=parseInt(o),c=parseInt(t);for(var u=l;u<=s;u++)for(var d=a;d<=c;d++)if(obj.records[d][u]&&obj.records[d][u].getAttribute("data-merged")){var p=parseInt(obj.records[d][u].getAttribute("data-x")),f=parseInt(obj.records[d][u].getAttribute("data-y")),h=parseInt(obj.records[d][u].getAttribute("colspan")),g=parseInt(obj.records[d][u].getAttribute("rowspan"));h>1&&(p<l&&(l=p),p+h>s&&(s=p+h-1)),g&&(f<a&&(a=f),f+g>c&&(c=f+g-1))}var m=null,b=null,j=null,v=null;for(d=a;d<=c;d++)"none"!=obj.rows[d].style.display&&(null==j&&(j=d),v=d);for(u=l;u<=s;u++){for(d=a;d<=c;d++)"none"!=obj.rows[d].style.display&&"none"!=obj.records[d][u].style.display&&(obj.records[d][u].classList.add("highlight"),obj.highlighted.push(obj.records[d][u]));"hidden"!=obj.options.columns[u].type&&(null==m&&(m=u),b=u)}for(m||(m=0),b||(b=0),u=m;u<=b;u++)"hidden"!=obj.options.columns[u].type&&obj.colgroup[u].style&&"none"!=obj.colgroup[u].style.display&&(obj.records[j]&&obj.records[j][u]&&obj.records[j][u].classList.add("highlight-top"),obj.records[v]&&obj.records[v][u]&&obj.records[v][u].classList.add("highlight-bottom"),obj.headers[u].classList.add("selected"));for(d=j;d<=v;d++)obj.rows[d]&&"none"!=obj.rows[d].style.display&&(obj.records[d][m].classList.add("highlight-left"),obj.records[d][b].classList.add("highlight-right"),obj.rows[d].classList.add("selected"));obj.selectedContainer=[m,j,b,v]}0==i&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,m,j,b,v,r),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,t){obj.removeCopySelection();var n=obj.selectedContainer[0],o=obj.selectedContainer[1],r=obj.selectedContainer[2],i=obj.selectedContainer[3];if(null!=e&&null!=t){if(e-r>0)var l=parseInt(r)+1,s=parseInt(e);else l=parseInt(e),s=parseInt(n)-1;if(t-i>0)var a=parseInt(i)+1,c=parseInt(t);else a=parseInt(t),c=parseInt(o)-1;s-l<=c-a?(l=parseInt(n),s=parseInt(r)):(a=parseInt(o),c=parseInt(i));for(var u=a;u<=c;u++)for(var d=l;d<=s;d++)obj.records[u][d]&&"none"!=obj.rows[u].style.display&&"none"!=obj.records[u][d].style.display&&(obj.records[u][d].classList.add("selection"),obj.records[a][d].classList.add("selection-top"),obj.records[c][d].classList.add("selection-bottom"),obj.records[u][l].classList.add("selection-left"),obj.records[u][s].classList.add("selection-right"),obj.selection.push(obj.records[u][d]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var e=obj.highlighted[obj.highlighted.length-1],t=e.getAttribute("data-x"),n=obj.content.getBoundingClientRect(),o=n.left,r=n.top,i=e.getBoundingClientRect(),l=i.left,s=i.top,a=i.width,c=i.height,u=l-o+obj.content.scrollLeft+a-4,d=s-r+obj.content.scrollTop+c-4;if(obj.corner.style.top=d+"px",obj.corner.style.left=u+"px",obj.options.freezeColumns){var p=obj.getFreezeWidth();t>obj.options.freezeColumns-1&&l-o+a<p?obj.corner.style.display="none":1==obj.options.selectionCopy&&(obj.corner.style.display="")}else 1==obj.options.selectionCopy&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(e){var t=obj.content.getBoundingClientRect(),n=t.left,o=t.top,r=t.width,i=t.height,l=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),s=l.left,a=l.top,c=l.width,u=l.height;if(0==e||1==e)var d=s-n+obj.content.scrollLeft,p=a-o+obj.content.scrollTop-2;else d=s-n+obj.content.scrollLeft+c,p=a-o+obj.content.scrollTop+u;p>obj.content.scrollTop+30&&p<obj.content.scrollTop+i||(p<obj.content.scrollTop+30?obj.content.scrollTop=p-u:obj.content.scrollTop=p-(i-2));var f=obj.getFreezeWidth();d>obj.content.scrollLeft+f&&d<obj.content.scrollLeft+r||(d<obj.content.scrollLeft+30?(obj.content.scrollLeft=d,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):d<obj.content.scrollLeft+f?obj.content.scrollLeft=d-f-1:obj.content.scrollLeft=d-(r-20))},obj.getWidth=function(e){if(void 0===e)for(var t=[],n=0;n<obj.headers.length;n++)t.push(obj.options.columns[n].width);else"object"==typeof e&&(e=e.getAttribute("data-x")),t=obj.colgroup[e].getAttribute("width");return t},obj.setWidth=function(e,t,n){if(t){if(Array.isArray(e)){n||(n=[]);for(var o=0;o<e.length;o++){n[o]||(n[o]=obj.colgroup[e[o]].getAttribute("width"));var r=Array.isArray(t)&&t[o]?t[o]:t;obj.colgroup[e[o]].setAttribute("width",r),obj.options.columns[e[o]].width=r}}else n||(n=obj.colgroup[e].getAttribute("width")),obj.colgroup[e].setAttribute("width",t),obj.options.columns[e].width=t;obj.setHistory({action:"setWidth",column:e,oldValue:n,newValue:t}),obj.dispatch("onresizecolumn",el,e,t,n),obj.updateCornerPosition()}},obj.setHeight=function(e,t,n){t>0&&("object"==typeof e&&(e=e.getAttribute("data-y")),n||(n=obj.rows[e].getAttribute("height"))||(n=obj.rows[e].getBoundingClientRect().height),t=parseInt(t),obj.rows[e].style.height=t+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=t,obj.setHistory({action:"setHeight",row:e,oldValue:n,newValue:t}),obj.dispatch("onresizerow",el,e,t,n),obj.updateCornerPosition())},obj.getHeight=function(e){if(void 0===e)for(var t=[],n=0;n<obj.rows.length;n++){var o=obj.rows[n].style.height;o&&(t[n]=o)}else"object"==typeof e&&(e=$(e).getAttribute("data-y")),t=obj.rows[e].style.height;return t},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var t=0;t<obj.options.footers.length;t++){if(obj.tfoot.children[t])var n=obj.tfoot.children[t];else{n=document.createElement("tr");var o=document.createElement("td");n.appendChild(o),obj.tfoot.appendChild(n)}for(var r=0;r<obj.headers.length;r++){if(obj.options.footers[t][r]||(obj.options.footers[t][r]=""),obj.tfoot.children[t].children[r+1])o=obj.tfoot.children[t].children[r+1];else{o=document.createElement("td"),n.appendChild(o);var i=obj.options.columns[r].align?obj.options.columns[r].align:"center";o.style.textAlign=i}o.textContent=obj.parseValue(+obj.records.length+r,t,obj.options.footers[t][r]),o.style.display=obj.colgroup[r].style.display}}}},obj.getHeader=function(e){return obj.headers[e].textContent},obj.setHeader=function(e,t){if(obj.headers[e]){var n=obj.headers[e].textContent;t||(t=prompt(obj.options.text.columnName,n)),t&&(obj.headers[e].textContent=t,obj.headers[e].setAttribute("title",t),obj.options.columns[e].title=t),obj.setHistory({action:"setHeader",column:e,oldValue:n,newValue:t}),obj.dispatch("onchangeheader",el,e,n,t)}},obj.getHeaders=function(e){for(var t=[],n=0;n<obj.headers.length;n++)t.push(obj.getHeader(n));return e?t:t.join(obj.options.csvDelimiter)},obj.getMeta=function(e,t){return e?t?obj.options.meta[e]&&obj.options.meta[e][t]?obj.options.meta[e][t]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta},obj.setMeta=function(e,t,n){if(obj.options.meta||(obj.options.meta={}),t&&n)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][t]=n;else for(var o=Object.keys(e),r=0;r<o.length;r++){obj.options.meta[o[r]]||(obj.options.meta[o[r]]={});for(var i=Object.keys(e[o[r]]),l=0;l<i.length;l++)obj.options.meta[o[r]][i[l]]=e[o[r]][i[l]]}obj.dispatch("onchangemeta",el,e,t,n)},obj.updateMeta=function(e){if(obj.options.meta){for(var t={},n=Object.keys(obj.options.meta),o=0;o<n.length;o++)e[n[o]]?t[e[n[o]]]=obj.options.meta[n[o]]:t[n[o]]=obj.options.meta[n[o]];obj.options.meta=t}},obj.getStyle=function(e,t){if(e)return e=jexcel.getIdFromColumnName(e,!0),t?obj.records[e[1]][e[0]].style[t]:obj.records[e[1]][e[0]].getAttribute("style");for(var n={},o=obj.options.data[0].length,r=obj.options.data.length,i=0;i<r;i++)for(var l=0;l<o;l++){var s=t?obj.records[i][l].style[t]:obj.records[i][l].getAttribute("style");s&&(n[jexcel.getColumnNameFromId([l,i])]=s)}return n},obj.resetStyle=function(e,t){for(var n=Object.keys(e),o=0;o<n.length;o++){var r=jexcel.getIdFromColumnName(n[o],!0);obj.records[r[1]]&&obj.records[r[1]][r[0]]&&obj.records[r[1]][r[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,t)},obj.setStyle=function(e,t,n,o,r){var i={},l={},s=function(e,t,n){var r=jexcel.getIdFromColumnName(e,!0);if(obj.records[r[1]]&&obj.records[r[1]][r[0]]&&(0==obj.records[r[1]][r[0]].classList.contains("readonly")||o)){var s=obj.records[r[1]][r[0]].style[t];s!=n||o?obj.records[r[1]][r[0]].style[t]=n:(n="",obj.records[r[1]][r[0]].style[t]=""),l[e]||(l[e]=[]),i[e]||(i[e]=[]),l[e].push([t+":"+s]),i[e].push([t+":"+n])}};if(t&&n)if("string"==typeof e)s(e,t,n);else for(var a=[],c=0;c<e.length;c++){var u=e[c].getAttribute("data-x"),d=e[c].getAttribute("data-y"),p=jexcel.getColumnNameFromId([u,d]);a[p]||(s(p,t,n),a[p]=!0)}else{var f=Object.keys(e);for(c=0;c<f.length;c++){var h=e[f[c]];"string"==typeof h&&(h=h.split(";"));for(var g=0;g<h.length;g++)"string"==typeof h[g]&&(h[g]=h[g].split(":")),h[g][0].trim()&&s(f[c],h[g][0].trim(),h[g][1])}}for(f=Object.keys(l),c=0;c<f.length;c++)l[f[c]]=l[f[c]].join(";");for(f=Object.keys(i),c=0;c<f.length;c++)i[f[c]]=i[f[c]].join(";");r||obj.setHistory({action:"setStyle",oldValue:l,newValue:i}),obj.dispatch("onchangestyle",el,e,t,n)},obj.getComments=function(e,t){if(e)return"string"==typeof e&&(e=jexcel.getIdFromColumnName(e,!0)),t?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||"";for(var n={},o=0;o<obj.options.data.length;o++)for(var r=0;r<obj.options.columns.length;r++){var i=obj.records[o][r].getAttribute("title");i&&(n[e=jexcel.getColumnNameFromId([r,o])]=i)}return n},obj.setComments=function(e,t,n){if("string"==typeof e)var o=jexcel.getIdFromColumnName(e,!0);else o=e;var r=obj.records[o[1]][o[0]].getAttribute("title"),i=[r,n=obj.records[o[1]][o[0]].getAttribute("data-author")];obj.records[o[1]][o[0]].setAttribute("title",t||""),obj.records[o[1]][o[0]].setAttribute("data-author",n||""),t?obj.records[o[1]][o[0]].classList.add("jexcel_comments"):obj.records[o[1]][o[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[t,n],oldValue:i}),obj.dispatch("oncomments",el,t,r,o,o[0],o[1])},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,t){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}t=null==t?obj.headers[e].classList.contains("arrow-down")?1:0:t?1:0;var n=[];if("number"==obj.options.columns[e].type||"numeric"==obj.options.columns[e].type||"percentage"==obj.options.columns[e].type||"autonumber"==obj.options.columns[e].type||"color"==obj.options.columns[e].type)for(var o=0;o<obj.options.data.length;o++)n[o]=[o,Number(obj.options.data[o][e])];else if("calendar"==obj.options.columns[e].type||"checkbox"==obj.options.columns[e].type||"radio"==obj.options.columns[e].type)for(o=0;o<obj.options.data.length;o++)n[o]=[o,obj.options.data[o][e]];else for(o=0;o<obj.options.data.length;o++)n[o]=[o,obj.records[o][e].textContent.toLowerCase()];"function"!=typeof obj.options.sorting&&(obj.options.sorting=function(e){return function(t,n){var o=t[1],r=n[1];return e?""===o&&""!==r?1:""!==o&&""===r||o>r?-1:o<r?1:0:""===o&&""!==r?1:""!==o&&""===r?-1:o>r?1:o<r?-1:0}}),n=n.sort(obj.options.sorting(t));var r=[];for(o=0;o<n.length;o++)r[o]=n[o][0];return obj.setHistory({action:"orderBy",rows:r,column:e,order:t}),obj.updateOrderArrow(e,t),obj.updateOrder(r),obj.dispatch("onsort",el,e,t),!0}},obj.updateOrderArrow=function(e,t){for(var n=0;n<obj.headers.length;n++)obj.headers[n].classList.remove("arrow-up"),obj.headers[n].classList.remove("arrow-down");t?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=obj.options.data[e[n]];for(obj.options.data=t,t=[],n=0;n<e.length;n++)t[n]=obj.records[e[n]];for(obj.records=t,t=[],n=0;n<e.length;n++)t[n]=obj.rows[e[n]];if(obj.rows=t,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(1==obj.options.lazyLoading)obj.loadPage(0);else for(n=0;n<obj.rows.length;n++)obj.tbody.appendChild(obj.rows[n])},obj.moveRow=function(e,t,n){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var o=1;else o=0;if(obj.isRowMerged(e).length||obj.isRowMerged(t,o).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}n||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0?e>t?obj.tbody.insertBefore(obj.rows[e],obj.rows[t]):obj.tbody.insertBefore(obj.rows[e],obj.rows[t].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(t,0,obj.rows.splice(e,1)[0]),obj.records.splice(t,0,obj.records.splice(e,1)[0]),obj.options.data.splice(t,0,obj.options.data.splice(e,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,t)},obj.insertRow=function(e,t,n){if(1==obj.options.allowInsertRow){var o=[];if(e>0)var r=e;else r=1,e&&(o=e);n=!!n;var i=obj.options.data.length-1;if((null==t||t>=parseInt(i)||t<0)&&(t=i),!1===obj.dispatch("onbeforeinsertrow",el,t,r,n))return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var l=n?t:t+1,s=obj.records.splice(l),a=obj.options.data.splice(l),c=obj.rows.splice(l),u=[],d=[],p=[],f=l;f<r+l;f++){obj.options.data[f]=[];for(var h=0;h<obj.options.columns.length;h++)obj.options.data[f][h]=o[h]?o[h]:"";var g=obj.createRow(f,obj.options.data[f]);c[0]?Array.prototype.indexOf.call(obj.tbody.children,c[0])>=0&&obj.tbody.insertBefore(g,c[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[t])>=0&&obj.tbody.appendChild(g),u.push(obj.records[f]),d.push(obj.options.data[f]),p.push(g)}Array.prototype.push.apply(obj.records,s),Array.prototype.push.apply(obj.options.data,a),Array.prototype.push.apply(obj.rows,c),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:t,numOfRows:r,insertBefore:n,rowRecords:u,rowData:d,rowNode:p}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,t,r,u,n)}},obj.deleteRow=function(e,t){if(1==obj.options.allowDeleteRow)if(1==obj.options.allowDeletingAllRows||obj.options.data.length>1){if(null==e){var n=obj.getSelectedRows();n[0]?(e=parseInt(n[0].getAttribute("data-y")),t=n.length):(e=obj.options.data.length-1,t=1)}var o=obj.options.data.length-1;if((null==e||e>o||e<0)&&(e=o),t||(t=1),e+t>=obj.options.data.length&&(t=obj.options.data.length-e),!1===obj.dispatch("onbeforedeleterow",el,e,t))return!1;if(parseInt(e)>-1){var r=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var i=e;i<e+t;i++)obj.isRowMerged(i,!1).length&&(r=!0);if(r){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(0==obj.options.allowDeletingAllRows&&o+1===t&&(t--,console.error("Jspreadsheet: It is not possible to delete the last row")),i=e;i<e+t;i++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[i])>=0&&(obj.rows[i].className="",obj.rows[i].parentNode.removeChild(obj.rows[i]));var l=obj.records.splice(e,t),s=obj.options.data.splice(e,t),a=obj.rows.splice(e,t);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+t-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:t,insertBefore:1,rowRecords:l,rowData:s,rowNode:a}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,t,l)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(e,t){if(Object.keys(obj.options.mergeCells).length>0){if(e>t)var n=1;else n=0;if(obj.isColMerged(e).length||obj.isColMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((e=parseInt(e))>(t=parseInt(t))){obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t]),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t]);for(var o=0;o<obj.rows.length;o++)obj.rows[o].insertBefore(obj.records[o][e],obj.records[o][t])}else for(obj.headerContainer.insertBefore(obj.headers[e],obj.headers[t].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[e],obj.colgroup[t].nextSibling),o=0;o<obj.rows.length;o++)obj.rows[o].insertBefore(obj.records[o][e],obj.records[o][t].nextSibling);for(obj.options.columns.splice(t,0,obj.options.columns.splice(e,1)[0]),obj.headers.splice(t,0,obj.headers.splice(e,1)[0]),obj.colgroup.splice(t,0,obj.colgroup.splice(e,1)[0]),o=0;o<obj.rows.length;o++)obj.options.data[o].splice(t,0,obj.options.data[o].splice(e,1)[0]),obj.records[o].splice(t,0,obj.records[o].splice(e,1)[0]);if(obj.options.footers)for(o=0;o<obj.options.footers.length;o++)obj.options.footers[o].splice(t,0,obj.options.footers[o].splice(e,1)[0]);obj.setHistory({action:"moveColumn",oldValue:e,newValue:t}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,e,t)},obj.insertColumn=function(e,t,n,o){if(1==obj.options.allowInsertColumn){var r=[];if(e>0)var i=e;else i=1,e&&(r=e);n=!!n;var l=obj.options.columns.length-1;if((null==t||t>=parseInt(l)||t<0)&&(t=l),!1===obj.dispatch("onbeforeinsertcolumn",el,t,i,n))return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(t,n).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}o||(o=[]);for(var s=0;s<i;s++)o[s]||(o[s]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var a=n?t:t+1;obj.options.columns=jexcel.injectArray(obj.options.columns,a,o);for(var c=obj.headers.splice(a),u=obj.colgroup.splice(a),d=[],p=[],f=[],h=[],g=[],m=a;m<i+a;m++)obj.createCellHeader(m),obj.headerContainer.insertBefore(obj.headers[m],obj.headerContainer.children[m+1]),obj.colgroupContainer.insertBefore(obj.colgroup[m],obj.colgroupContainer.children[m+1]),d.push(obj.headers[m]),p.push(obj.colgroup[m]);if(obj.options.footers)for(var b=0;b<obj.options.footers.length;b++){for(g[b]=[],s=0;s<i;s++)g[b].push("");obj.options.footers[b].splice(a,0,g[b])}for(var j=0;j<obj.options.data.length;j++){var v=obj.options.data[j].splice(a),y=obj.records[j].splice(a);for(h[j]=[],f[j]=[],m=a;m<i+a;m++){var x=r[j]?r[j]:"";obj.options.data[j][m]=x;var w=obj.createCell(m,j,obj.options.data[j][m]);obj.records[j][m]=w,obj.rows[j]&&obj.rows[j].insertBefore(w,obj.rows[j].children[m+1]),h[j].push(x),f[j].push(w)}Array.prototype.push.apply(obj.options.data[j],v),Array.prototype.push.apply(obj.records[j],y)}if(Array.prototype.push.apply(obj.headers,c),Array.prototype.push.apply(obj.colgroup,u),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(b=0;b<obj.options.nestedHeaders.length;b++){var C=parseInt(obj.options.nestedHeaders[b][obj.options.nestedHeaders[b].length-1].colspan)+i;obj.options.nestedHeaders[b][obj.options.nestedHeaders[b].length-1].colspan=C,obj.thead.children[b].children[obj.thead.children[b].children.length-1].setAttribute("colspan",C);var E=obj.thead.children[b].children[obj.thead.children[b].children.length-1].getAttribute("data-column");for(E=E.split(","),m=a;m<i+a;m++)E.push(m);obj.thead.children[b].children[obj.thead.children[b].children.length-1].setAttribute("data-column",E)}else C=parseInt(obj.options.nestedHeaders[0].colspan)+i,obj.options.nestedHeaders[0].colspan=C,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",C);obj.setHistory({action:"insertColumn",columnNumber:t,numOfColumns:i,insertBefore:n,columns:o,headers:d,colgroup:p,records:f,footers:g,data:h}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,t,i,f,n)}},obj.deleteColumn=function(e,t){if(1==obj.options.allowDeleteColumn)if(obj.headers.length>1){if(null==e){var n=obj.getSelectedColumns(!0);n.length?(e=parseInt(n[0]),t=parseInt(n.length)):(e=obj.headers.length-1,t=1)}var o=obj.options.data[0].length-1;if((null==e||e>o||e<0)&&(e=o),t||(t=1),t>obj.options.data[0].length-e&&(t=obj.options.data[0].length-e),!1===obj.dispatch("onbeforedeletecolumn",el,e,t))return!1;if(parseInt(e)>-1){var r=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var i=e;i<e+t;i++)obj.isColMerged(i,!1).length&&(r=!0);if(r){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var l=obj.options.columns.splice(e,t);for(i=e;i<e+t;i++)obj.colgroup[i].className="",obj.headers[i].className="",obj.colgroup[i].parentNode.removeChild(obj.colgroup[i]),obj.headers[i].parentNode.removeChild(obj.headers[i]);for(var s=obj.headers.splice(e,t),a=obj.colgroup.splice(e,t),c=[],u=[],d=[],p=0;p<obj.options.data.length;p++)for(i=e;i<e+t;i++)obj.records[p][i].className="",obj.records[p][i].parentNode.removeChild(obj.records[p][i]);for(p=0;p<obj.options.data.length;p++)u[p]=obj.options.data[p].splice(e,t),c[p]=obj.records[p].splice(e,t);if(obj.options.footers)for(p=0;p<obj.options.footers.length;p++)d[p]=obj.options.footers[p].splice(e,t);if(obj.conditionalSelectionUpdate(0,e,e+t-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var f=0;f<obj.options.nestedHeaders.length;f++){var h=parseInt(obj.options.nestedHeaders[f][obj.options.nestedHeaders[f].length-1].colspan)-t;obj.options.nestedHeaders[f][obj.options.nestedHeaders[f].length-1].colspan=h,obj.thead.children[f].children[obj.thead.children[f].children.length-1].setAttribute("colspan",h)}else h=parseInt(obj.options.nestedHeaders[0].colspan)-t,obj.options.nestedHeaders[0].colspan=h,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",h);obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:t,insertBefore:1,columns:l,headers:s,colgroup:a,records:c,footers:d,data:u}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,t,c)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var t=[],n=0;n<obj.rows.length;n++)obj.rows[n].classList.contains("selected")&&(e?t.push(n):t.push(obj.rows[n]));return t},obj.getSelectedColumns=function(){for(var e=[],t=0;t<obj.headers.length;t++)obj.headers[t].classList.contains("selected")&&e.push(t);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++)(i=obj.headers[e].getAttribute("data-x"))!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)));for(var t=0;t<obj.rows.length;t++)obj.rows[t]&&(l=obj.rows[t].getAttribute("data-y"))!=t&&(obj.rows[t].setAttribute("data-y",t),obj.rows[t].children[0].setAttribute("data-y",t),obj.rows[t].children[0].innerHTML=t+1);var n=[],o=[],r=function(e,t,o,r){if(e!=o&&obj.records[r][o].setAttribute("data-x",o),t!=r&&obj.records[r][o].setAttribute("data-y",r),e!=o||t!=r){var i=jexcel.getColumnNameFromId([e,t]),l=jexcel.getColumnNameFromId([o,r]);n[i]=l}};for(t=0;t<obj.records.length;t++)for(e=0;e<obj.records[0].length;e++)if(obj.records[t][e]){var i=obj.records[t][e].getAttribute("data-x"),l=obj.records[t][e].getAttribute("data-y");if(obj.records[t][e].getAttribute("data-merged")){var s=jexcel.getColumnNameFromId([i,l]),a=jexcel.getColumnNameFromId([e,t]);if(null==o[s])if(s==a)o[s]=!1;else{var c=parseInt(e-i),u=parseInt(t-l);o[s]=[a,c,u]}}else r(i,l,e,t)}var d=Object.keys(o);if(d.length)for(e=0;e<d.length;e++)if(o[d[e]]){var p=jexcel.getIdFromColumnName(d[e],!0);for(r(i=p[0],l=p[1],i+o[d[e]][1],l+o[d[e]][2]),s=d[e],a=o[d[e]][0],t=0;t<obj.options.mergeCells[s][2].length;t++)i=parseInt(obj.options.mergeCells[s][2][t].getAttribute("data-x")),l=parseInt(obj.options.mergeCells[s][2][t].getAttribute("data-y")),obj.options.mergeCells[s][2][t].setAttribute("data-x",i+o[d[e]][1]),obj.options.mergeCells[s][2][t].setAttribute("data-y",l+o[d[e]][2]);obj.options.mergeCells[a]=obj.options.mergeCells[s],delete obj.options.mergeCells[s]}obj.updateFormulas(n),obj.updateMeta(n),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var e=0,t=obj.rows.length-1;t>=0;t--){for(var n=!1,o=0;o<obj.headers.length;o++)obj.options.data[t][o]&&(n=!0);if(n)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){var r=0;for(o=obj.headers.length-1;o>=0;o--){for(n=!1,t=0;t<obj.rows.length;t++)obj.options.data[t][o]&&(n=!0);if(n)break;r++}obj.options.minSpareCols-r>0&&obj.insertColumn(obj.options.minSpareCols-r)}if("function"==typeof obj.options.updateTable){for(obj.options.detachForUpdates&&el.removeChild(obj.content),t=0;t<obj.rows.length;t++)for(o=0;o<obj.headers.length;o++)obj.options.updateTable(el,obj.records[t][o],o,t,obj.options.data[t][o],obj.records[t][o].textContent,jexcel.getColumnNameFromId([o,t]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout((function(){obj.updateCornerPosition()}),0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,t){(e=obj.getCell(e))&&(t?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="none");for(var t=0;t<obj.options.data.length;t++)obj.records[t][e].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,t,n){var o=jexcel.getColumnNameFromId([e,t]);if(obj.formula[o]&&obj.formula[o].length>0)if(chainLoopProtection[o])obj.records[t][e].innerHTML="#ERROR",obj.formula[o]="";else{chainLoopProtection[o]=!0;for(var r=0;r<obj.formula[o].length;r++){var i=jexcel.getIdFromColumnName(obj.formula[o][r],!0),l=""+obj.options.data[i[1]][i[0]];"="==l.substr(0,1)?n.push(obj.updateCell(i[0],i[1],l,!0)):Object.keys(obj.formula)[r]=null,obj.updateFormulaChain(i[0],i[1],n)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var t=0;t<obj.options.data.length;t++)for(var n=0;n<obj.options.data[0].length;n++)if("="==(s=""+obj.options.data[t][n]).substr(0,1)){var o=obj.updateFormula(s,e);o!=s&&(obj.options.data[t][n]=o)}var r=[],i=Object.keys(obj.formula);for(t=0;t<i.length;t++){var l=i[t],s=obj.formula[l];for(e[l]&&(l=e[l]),r[l]=[],n=0;n<s.length;n++){var a=s[n];e[a]&&(a=e[a]),r[l].push(a)}}obj.formula=r},obj.updateFormula=function(e,t){for(var n=/[A-Z]/,o=/[0-9]/,r="",i=null,l=null,s="",a=0;a<e.length;a++)n.exec(e[a])?(i=1,l=0,s+=e[a]):o.exec(e[a])?(l=i?1:0,s+=e[a]):(i&&l&&(s=t[s]?t[s]:s),r+=s,r+=e[a],i=0,l=0,s="");return s&&(i&&l&&(s=t[s]?t[s]:s),r+=s),r};var secureFormula=function(e){for(var t="",n=0,o=0;o<e.length;o++)'"'==e[o]&&(n=0==n?1:0),t+=1==n?e[o]:e[o].toUpperCase();return t};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var t=0;t<e.length;t++){var n=[],o=e[t].split(":"),r=jexcel.getIdFromColumnName(o[0],!0),i=jexcel.getIdFromColumnName(o[1],!0);if(r[0]<=i[0])var l=r[0],s=i[0];else l=i[0],s=r[0];if(r[1]<=i[1])var a=r[1],c=i[1];else a=i[1],c=r[1];for(var u=a;u<=c;u++)for(var d=l;d<=s;d++)n.push(jexcel.getColumnNameFromId([d,u]));expression=expression.replace(e[t],n.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens)for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(void 0!==obj.options.data[position[1]]&&void 0!==obj.options.data[position[1]][position[0]])var value=obj.options.data[position[1]][position[0]];else var value="";if("="==(""+value).substr(0,1)&&(void 0!==formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim())formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&1==obj.options.autoCasting)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);1==obj.options.autoCasting&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(e){var res="#ERROR";console.log(e)}return res};return execute(expression,x,y)},obj.parseNumber=function(e,t){var n=t&&obj.options.columns[t].decimal?obj.options.columns[t].decimal:".",o=""+e;return(o=o.split(n))[0]=o[0].match(/[+-]?[0-9]/g),o[0]&&(o[0]=o[0].join("")),o[1]&&(o[1]=o[1].match(/[0-9]*/g).join("")),o[0]&&Number.isInteger(Number(o[0]))?o[1]?Number(o[0]+"."+o[1]):Number(o[0]+".00"):null},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,t){if(e?obj.selectedCell[3]>0&&obj.up.visible(1,t?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)if(0==obj.selectedCell[1]||0==obj.selectedCell[3])obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-n<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var o=obj.whichPage(obj.selectedCell[3]);o!=obj.pageNumber&&obj.page(o)}obj.updateScroll(1)},obj.up.visible=function(e,t){if(0==e)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(0==t){for(var r=0;r<o;r++)if("none"!=obj.records[r][n].style.display&&"none"!=obj.rows[r].style.display){o=r;break}}else o=obj.up.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.up.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))-1;n>=0;n--)if("none"!=obj.records[n][e].style.display&&"none"!=obj.rows[n].style.display){if(obj.records[n][e].getAttribute("data-merged")&&obj.records[n][e]==obj.records[t][e])continue;t=n;break}return t},obj.down=function(e,t){if(e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,t?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}obj.updateScroll(3)},obj.down.visible=function(e,t){if(0==e)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(0==t){for(var r=obj.rows.length-1;r>o;r--)if("none"!=obj.records[r][n].style.display&&"none"!=obj.rows[r].style.display){o=r;break}}else o=obj.down.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.down.get=function(e,t){e=parseInt(e);for(var n=(t=parseInt(t))+1;n<obj.rows.length;n++)if("none"!=obj.records[n][e].style.display&&"none"!=obj.rows[n].style.display){if(obj.records[n][e].getAttribute("data-merged")&&obj.records[n][e]==obj.records[t][e])continue;t=n;break}return t},obj.right=function(e,t){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,t?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,t){if(0==e)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(0==t){for(var r=obj.headers.length-1;r>n;r--)if("none"!=obj.records[o][r].style.display){n=r;break}}else n=obj.right.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.right.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e+1;n<obj.headers.length;n++)if("none"!=obj.records[t][n].style.display){if(obj.records[t][n].getAttribute("data-merged")&&obj.records[t][n]==obj.records[t][e])continue;e=n;break}return e},obj.left=function(e,t){e?obj.selectedCell[2]>0&&obj.left.visible(1,t?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,t?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,t){if(0==e)var n=parseInt(obj.selectedCell[0]),o=parseInt(obj.selectedCell[1]);else n=parseInt(obj.selectedCell[2]),o=parseInt(obj.selectedCell[3]);if(0==t){for(var r=0;r<n;r++)if("none"!=obj.records[o][r].style.display){n=r;break}}else n=obj.left.get(n,o);0==e?(obj.selectedCell[0]=n,obj.selectedCell[1]=o):(obj.selectedCell[2]=n,obj.selectedCell[3]=o)},obj.left.get=function(e,t){e=parseInt(e),t=parseInt(t);for(var n=e-1;n>=0;n--)if("none"!=obj.records[t][n].style.display){if(obj.records[t][n].getAttribute("data-merged")&&obj.records[t][n]==obj.records[t][e])continue;e=n;break}return e},obj.first=function(e,t){if(e?t?obj.selectedCell[3]=0:obj.left.visible(1,0):(t?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||0!=obj.selectedCell[1]&&0!=obj.selectedCell[3]){if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,t){if(e?t?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(t?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var n=obj.whichPage(obj.selectedCell[3]);n!=obj.pageNumber&&obj.page(n)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){if(1!=obj.options.search&&1!=obj.options.filters||!obj.results)t=obj.rows;else var t=obj.results;var n=100;null!=e&&-1!=e||(e=Math.ceil(t.length/n)-1);var o=e*n,r=e*n+n;r>t.length&&(r=t.length),(o=r-100)<0&&(o=0);for(var i=o;i<r;i++)1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.appendChild(obj.rows[i]):obj.tbody.appendChild(obj.rows[t[i]]),obj.tbody.children.length>n&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(1!=obj.options.search&&1!=obj.options.filters||!obj.results)e=obj.rows;else var e=obj.results;var t=0;if(e.length>100){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(1!=obj.options.search&&1!=obj.options.filters||!obj.results||(n=e.indexOf(n)),n>0)for(var o=0;o<30;o++)(n-=1)>-1&&(1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.insertBefore(obj.rows[n],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[e[n]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),t=1))}return t},obj.loadDown=function(){if(1!=obj.options.search&&1!=obj.options.filters||!obj.results)e=obj.rows;else var e=obj.results;var t=0;if(e.length>100){var n=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(1!=obj.options.search&&1!=obj.options.filters||!obj.results||(n=e.indexOf(n)),n<obj.rows.length-1)for(var o=0;o<=30;o++)n<e.length&&(1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.appendChild(obj.rows[n]):obj.tbody.appendChild(obj.rows[e[n]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),t=1)),n+=1}return t},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,t=parseInt(obj.selectedCell[3]/100),n=parseInt(obj.rows.length/100);if(e!=t&&t<=n&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(t),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(e){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],e){var t=function(e){-1==obj.results.indexOf(e)&&obj.results.push(e)},n=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");n=new RegExp(n,"i"),obj.options.data.forEach((function(e,o){if(function(e,t,n){for(var o=0;o<e.length;o++)if((""+e[o]).toLowerCase().search(t)>=0||(""+obj.records[n][o].innerHTML).toLowerCase().search(t)>=0)return!0;return!1}(e,n,o)){var r=obj.isRowMerged(o);if(r.length)for(var i=0;i<r.length;i++)for(var l=jexcel.getIdFromColumnName(r[i],!0),s=0;s<obj.options.mergeCells[r[i]][1];s++)t(l[1]+s);else t(o)}}))}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var e,t=0;for(e=1==obj.options.lazyLoading?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var n=0;n<obj.rows.length;n++)!obj.results||obj.results.indexOf(n)>-1?(t<e&&(obj.tbody.appendChild(obj.rows[n]),t++),obj.rows[n].style.display=""):obj.rows[n].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return 1!=obj.options.search&&1!=obj.options.filters||!obj.results||(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var t=obj.pageNumber;if(1!=obj.options.search&&1!=obj.options.filters||!obj.results)n=obj.rows;else var n=obj.results;var o=parseInt(obj.options.pagination);null!=e&&-1!=e||(e=Math.ceil(n.length/o)-1),obj.pageNumber=e;var r=e*o,i=e*o+o;for(i>n.length&&(i=n.length),r<0&&(r=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var l=r;l<i;l++)1!=obj.options.search&&1!=obj.options.filters||!obj.results?obj.tbody.appendChild(obj.rows[l]):obj.tbody.appendChild(obj.rows[n[l]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,t)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(1!=obj.options.search&&1!=obj.options.filters||!obj.results)e=obj.rows.length;else var e=obj.results.length;if(e){var t=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6)var n=1,o=t<10?t:10;else t-obj.pageNumber<5?(o=t,(n=t-9)<1&&(n=1)):(n=obj.pageNumber-4,o=obj.pageNumber+5);n>1&&((i=document.createElement("div")).className="jexcel_page",i.innerHTML="<",i.title=1,obj.pagination.children[1].appendChild(i));for(var r=n;r<=o;r++){var i;(i=document.createElement("div")).className="jexcel_page",i.innerHTML=r,obj.pagination.children[1].appendChild(i),obj.pageNumber==r-1&&i.classList.add("jexcel_page_selected")}o<t&&((i=document.createElement("div")).className="jexcel_page",i.innerHTML=">",i.title=t,obj.pagination.children[1].appendChild(i)),obj.pagination.children[0].innerHTML=function(e){var t=Array.prototype.slice.call(arguments,1);return e.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))}(obj.options.text.showingPage,obj.pageNumber+1,t)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(e){if(0==obj.options.allowExport)console.error("Export not allowed");else{var t="";t+=obj.copy(!1,obj.options.csvDelimiter,!0,e,!0);var n=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(n,obj.options.csvFileName+".csv");else{var o=document.createElement("a"),r=URL.createObjectURL(n);o.href=r,o.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(o),o.click(),o.parentNode.removeChild(o)}}},obj.setHistory=function(e){if(1!=obj.ignoreHistory){var t=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,t+1),obj.history[t]=e}},obj.copy=function(e,t,n,o,r){t||(t="\t");for(var i=new RegExp(t,"ig"),l=[],s=[],a=[],c=[],u=[],d=obj.options.data[0].length,p=obj.options.data.length,f="",h=!1,g="",m="",b=0,j=0,v=0,y=0,x=!0,w=0;w<p;w++)for(var C=0;C<d;C++)e&&!obj.records[w][C].classList.contains("highlight")||(v<=C&&(v=C),y<=w&&(y=w));if(d===v+1&&p===y+1&&(x=!1),r&&1==obj.options.includeHeadersOnDownload||!r&&1==obj.options.includeHeadersOnCopy&&!x||o){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(f=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],w=0;w<f.length;w++){var E=[];for(C=0;C<f[w].length;C++){var A=parseInt(f[w][C].colspan);E.push(f[w][C].title);for(var L=0;L<A-1;L++)E.push("")}m+=E.join(t)+"\r\n"}h=!0}for(obj.style=[],w=0;w<p;w++){for(s=[],a=[],C=0;C<d;C++)if(!e||obj.records[w][C].classList.contains("highlight")){1==h&&l.push(obj.headers[C].textContent);var M=obj.options.data[w][C];if(M.match&&(M.match(i)||M.match(/,/g)||M.match(/\n/)||M.match(/\"/))&&(M='"'+(M=M.replace(new RegExp('"',"g"),'""'))+'"'),s.push(M),"checkbox"==obj.options.columns[C].type||"radio"==obj.options.columns[C].type)var N=M;else(N=1==obj.options.stripHTMLOnCopy?obj.records[w][C].textContent:obj.records[w][C].innerHTML).match&&(N.match(i)||N.match(/,/g)||N.match(/\n/)||N.match(/\"/))&&(N='"'+(N=N.replace(new RegExp('"',"g"),'""'))+'"');a.push(N),f=(f=obj.records[w][C].getAttribute("style")).replace("display: none;",""),obj.style.push(f||"")}s.length&&(h&&(b=s.length,c.push(l.join(t))),c.push(s.join(t))),a.length&&(j++,h&&(u.push(l.join(t)),h=!1),u.push(a.join(t)))}d==b&&p==j&&(g=m);var I=g+c.join("\r\n"),T=g+u.join("\r\n");if(n||(1==obj.options.copyCompatibility?obj.textarea.value=T:obj.textarea.value=I,obj.textarea.select(),document.execCommand("copy")),1==obj.options.copyCompatibility?obj.data=T:obj.data=I,obj.hashString=obj.hash(obj.data),!n){if(obj.removeCopyingSelection(),obj.highlighted)for(C=0;C<obj.highlighted.length;C++)obj.highlighted[C].classList.add("copying"),obj.highlighted[C].classList.contains("highlight-left")&&obj.highlighted[C].classList.add("copying-left"),obj.highlighted[C].classList.contains("highlight-right")&&obj.highlighted[C].classList.add("copying-right"),obj.highlighted[C].classList.contains("highlight-top")&&obj.highlighted[C].classList.add("copying-top"),obj.highlighted[C].classList.contains("highlight-bottom")&&obj.highlighted[C].classList.add("copying-bottom");obj.dispatch("oncopy",el,1==obj.options.copyCompatibility?u:c,obj.hashString)}return obj.data},obj.paste=function(e,t,n){var o=parseInt(e),r=parseInt(t),i=parseInt(obj.selectedCell[2]),l=parseInt(obj.selectedCell[3]),s=i-o+1,a=l-r+1;i<o&&(e=i.toString(),s=o-i+1),l<r&&(t=l.toString(),a=r-l+1);var c=obj.dispatch("onbeforepaste",el,n,e,t);if(!1===c)return!1;c&&(n=c);var u=obj.hash(n),d=u==obj.hashString?obj.style:null;if(1==obj.options.copyCompatibility&&u==obj.hashString&&(n=obj.data),n=obj.parseCSV(n,"\t"),s>1&Number.isInteger(s/n[0].length)){d=null,f=s/n[0].length;var p=n.map((function(e,t){return Array.apply(null,{length:f*e.length}).map((function(t,n){return e[n%e.length]}))}));n=p}if(a>1&Number.isInteger(a/n.length)){d=null;var f=a/n.length;p=Array.apply(null,{length:f*n.length}).map((function(e,t){return n[t%n.length]})),n=p}if(null!=e&&null!=t&&n){for(var h=0,g=0,m=[],b={},j={},v=0,y=parseInt(e),x=parseInt(t),w=null;w=n[g];){for(h=0,y=parseInt(e);null!=w[h];){var C=obj.updateCell(y,x,w[h]);if(m.push(C),obj.updateFormulaChain(y,x,m),d&&d[v]){var E=jexcel.getColumnNameFromId([y,x]);b[E]=d[v],j[E]=obj.getStyle(E),obj.records[x][y].setAttribute("style",d[v]),v++}if(null!=w[++h]){if(y>=obj.headers.length-1){if(1!=obj.options.allowInsertColumn)break;obj.insertColumn()}y=obj.right.get(y,x)}}if(g++,n[g]){if(x>=obj.rows.length-1){if(1!=obj.options.allowInsertRow)break;obj.insertRow()}x=obj.down.get(e,x)}}obj.updateSelectionFromCoords(e,t,y,x),obj.setHistory({action:"setValue",records:m,selection:obj.selectedCell,newStyle:b,oldStyle:j}),obj.updateTable(),obj.dispatch("onpaste",el,n),obj.onafterchanges(el,m)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),t=0;t<e.length;t++)e[t].classList.remove("copying"),e[t].classList.remove("copying-left"),e[t].classList.remove("copying-right"),e[t].classList.remove("copying-top"),e[t].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,t){var n=t.insertBefore?+t.rowNumber:t.rowNumber+1;if(1==obj.options.search&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),1==e){for(var o=t.numOfRows,r=n;r<o+n;r++)obj.rows[r].parentNode.removeChild(obj.rows[r]);obj.records.splice(n,o),obj.options.data.splice(n,o),obj.rows.splice(n,o),obj.conditionalSelectionUpdate(1,n,o+n-1)}else{obj.records=jexcel.injectArray(obj.records,n,t.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,n,t.rowData),obj.rows=jexcel.injectArray(obj.rows,n,t.rowNode);var i=0;for(r=n;r<t.numOfRows+n;r++)obj.tbody.insertBefore(t.rowNode[i],obj.tbody.children[r]),i++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,t){var n=t.insertBefore?t.columnNumber:t.columnNumber+1;if(1==e){var o=t.numOfColumns;obj.options.columns.splice(n,o);for(var r=n;r<o+n;r++)obj.headers[r].parentNode.removeChild(obj.headers[r]),obj.colgroup[r].parentNode.removeChild(obj.colgroup[r]);obj.headers.splice(n,o),obj.colgroup.splice(n,o);for(var i=0;i<t.data.length;i++){for(r=n;r<o+n;r++)obj.records[i][r].parentNode.removeChild(obj.records[i][r]);obj.records[i].splice(n,o),obj.options.data[i].splice(n,o)}if(obj.options.footers)for(i=0;i<obj.options.footers.length;i++)obj.options.footers[i].splice(n,o)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,n,t.columns),obj.headers=jexcel.injectArray(obj.headers,n,t.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,n,t.colgroup);var l=0;for(r=n;r<t.numOfColumns+n;r++)obj.headerContainer.insertBefore(t.headers[l],obj.headerContainer.children[r+1]),obj.colgroupContainer.insertBefore(t.colgroup[l],obj.colgroupContainer.children[r+1]),l++;for(i=0;i<t.data.length;i++)for(obj.options.data[i]=jexcel.injectArray(obj.options.data[i],n,t.data[i]),obj.records[i]=jexcel.injectArray(obj.records[i],n,t.records[i]),l=0,r=n;r<t.numOfColumns+n;r++)obj.rows[i].insertBefore(t.records[i][l],obj.rows[i].children[r+1]),l++;if(obj.options.footers)for(i=0;i<obj.options.footers.length;i++)obj.options.footers[i]=jexcel.injectArray(obj.options.footers[i],n,t.footers[i])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(i=0;i<obj.options.nestedHeaders.length;i++){if(1==e)var s=parseInt(obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan)-t.numOfColumns;else s=parseInt(obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan)+t.numOfColumns;obj.options.nestedHeaders[i][obj.options.nestedHeaders[i].length-1].colspan=s,obj.thead.children[i].children[obj.thead.children[i].children.length-1].setAttribute("colspan",s)}else s=1==e?parseInt(obj.options.nestedHeaders[0].colspan)-t.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+t.numOfColumns,obj.options.nestedHeaders[0].colspan=s,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",s);obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var n=[];if(obj.historyIndex>=0){var o=obj.history[obj.historyIndex--];if("insertRow"==o.action)obj.historyProcessRow(1,o);else if("deleteRow"==o.action)obj.historyProcessRow(0,o);else if("insertColumn"==o.action)obj.historyProcessColumn(1,o);else if("deleteColumn"==o.action)obj.historyProcessColumn(0,o);else if("moveRow"==o.action)obj.moveRow(o.newValue,o.oldValue);else if("moveColumn"==o.action)obj.moveColumn(o.newValue,o.oldValue);else if("setMerge"==o.action)obj.removeMerge(o.column,o.data);else if("setStyle"==o.action)obj.setStyle(o.oldValue,null,null,1);else if("setWidth"==o.action)obj.setWidth(o.column,o.oldValue);else if("setHeight"==o.action)obj.setHeight(o.row,o.oldValue);else if("setHeader"==o.action)obj.setHeader(o.column,o.oldValue);else if("setComments"==o.action)obj.setComments(o.column,o.oldValue[0],o.oldValue[1]);else if("orderBy"==o.action){for(var r=[],i=0;i<o.rows.length;i++)r[o.rows[i]]=i;obj.updateOrderArrow(o.column,o.order?0:1),obj.updateOrder(r)}else if("setValue"==o.action){for(var l=0;l<o.records.length;l++)n.push({x:o.records[l].x,y:o.records[l].y,newValue:o.records[l].oldValue}),o.oldStyle&&obj.resetStyle(o.oldStyle);obj.setValue(n),o.selection&&obj.updateSelectionFromCoords(o.selection[0],o.selection[1],o.selection[2],o.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onundo",el,o)},obj.redo=function(){var e=!!obj.ignoreEvents,t=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var n=obj.history[++obj.historyIndex];if("insertRow"==n.action)obj.historyProcessRow(0,n);else if("deleteRow"==n.action)obj.historyProcessRow(1,n);else if("insertColumn"==n.action)obj.historyProcessColumn(0,n);else if("deleteColumn"==n.action)obj.historyProcessColumn(1,n);else if("moveRow"==n.action)obj.moveRow(n.oldValue,n.newValue);else if("moveColumn"==n.action)obj.moveColumn(n.oldValue,n.newValue);else if("setMerge"==n.action)obj.setMerge(n.column,n.colspan,n.rowspan,1);else if("setStyle"==n.action)obj.setStyle(n.newValue,null,null,1);else if("setWidth"==n.action)obj.setWidth(n.column,n.newValue);else if("setHeight"==n.action)obj.setHeight(n.row,n.newValue);else if("setHeader"==n.action)obj.setHeader(n.column,n.newValue);else if("setComments"==n.action)obj.setComments(n.column,n.newValue[0],n.newValue[1]);else if("orderBy"==n.action)obj.updateOrderArrow(n.column,n.order),obj.updateOrder(n.rows);else if("setValue"==n.action){obj.setValue(n.records);for(var o=0;o<n.records.length;o++)n.oldStyle&&obj.resetStyle(n.newStyle);n.selection&&obj.updateSelectionFromCoords(n.selection[0],n.selection[1],n.selection[2],n.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=t,obj.dispatch("onredo",el,n)},obj.getDropDownValue=function(e,t){var n=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var o=[],r=obj.options.columns[e].source,i=0;i<r.length;i++)"object"==typeof r[i]?o[r[i].id]=r[i].name:o[r[i]]=r[i];var l=Array.isArray(t)?t:(""+t).split(";");for(i=0;i<l.length;i++)"object"==typeof l[i]?n.push(o[l[i].id]):o[l[i]]&&n.push(o[l[i]])}else console.error("Invalid column");return n.length>0?n.join("; "):""},obj.parseCSV=function(e,t){9==(e=e.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(e.length-1)&&(e+="\0"),t=t||",";for(var n=[],o=!1,r=0,i=0,l=0;l<e.length;l++){var s=e[l],a=e[l+1];n[r]=n[r]||[],n[r][i]=n[r][i]||"",'"'==s&&o&&'"'==a?(n[r][i]+=s,++l):'"'!=s?s!=t||o?"\r"!=s||"\n"!=a||o?"\n"==s&&!o||"\r"==s&&!o?(++r,i=0):n[r][i]+=s:(++r,i=0,++l):++i:o=!o}return n},obj.hash=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},obj.onafterchanges=function(e,t){obj.dispatch("onafterchanges",e,t)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,"function"==typeof jexcel.build&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",(function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())})),obj.options.csv?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){var t=obj.parseCSV(e,obj.options.csvDelimiter);if(1==obj.options.csvHeaders&&t.length>0)for(var n=t.shift(),o=0;o<n.length;o++)obj.options.columns[o]||(obj.options.columns[o]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),void 0===obj.options.columns[o].title&&(obj.options.columns[o].title=n[o]);obj.options.data=t,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.prepareTable()},options&&null!=options.contextMenu?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,t,n,o){var r=[];if(null==n)1==obj.options.allowInsertColumn&&r.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(t),1)}}),1==obj.options.allowInsertColumn&&r.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(t),0)}}),1==obj.options.allowDeleteColumn&&r.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(t))}}),1==obj.options.allowRenameColumn&&r.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(t)}}),1==obj.options.columnSorting&&(r.push({type:"line"}),r.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(t,0)}}),r.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(t,1)}}));else if(1==obj.options.allowInsertRow&&(r.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(n),1)}}),r.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(n))}})),1==obj.options.allowDeleteRow&&r.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(n))}}),t&&1==obj.options.allowComments){r.push({type:"line"});var i=obj.records[n][t].getAttribute("title")||"";r.push({title:i?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var e=prompt(obj.options.text.comments,i);e&&obj.setComments([t,n],e)}}),i&&r.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([t,n],"")}})}return r.push({type:"line"}),r.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&r.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then((function(e){e&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],e)}))}}),obj.options.allowExport&&r.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&r.push({title:obj.options.text.about,onclick:function(){!0===obj.options.about?alert(Version().print()):alert(obj.options.about)}}),r},obj.scrollControls=function(e){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),1!=obj.options.lazyLoading&&1!=obj.options.tableOverflow||obj.edition&&"jdropdown"!=e.target.className.substr(0,9)&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){1==obj.options.lazyLoading&&null==jexcel.timeControlLoading&&(jexcel.timeControlLoading=setTimeout((function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null}),100))},obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var t=0;t<obj.options.freezeColumns;t++)e+=parseInt(obj.options.columns[t].width);return e};var scrollLeft=0;return obj.updateFreezePosition=function(){var e=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var t=0;t<obj.options.freezeColumns;t++){t>0&&"hidden"!==obj.options.columns[t-1].type&&(e+=parseInt(obj.options.columns[t-1].width)),obj.headers[t].classList.add("jexcel_freezed"),obj.headers[t].style.left=e+"px";for(var n=0;n<obj.rows.length;n++)if(obj.rows[n]&&obj.records[n][t]){var o=scrollLeft+(t>0?obj.records[n][t-1].style.width:0)-51+"px";obj.records[n][t].classList.add("jexcel_freezed"),obj.records[n][t].style.left=o}}else for(t=0;t<obj.options.freezeColumns;t++)for(obj.headers[t].classList.remove("jexcel_freezed"),obj.headers[t].style.left="",n=0;n<obj.rows.length;n++)obj.records[n][t]&&(obj.records[n][t].classList.remove("jexcel_freezed"),obj.records[n][t].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(e){jSuites.setDictionary(e)},jexcel.setExtensions=function(e){for(var t=Object.keys(e),n=0;n<t.length;n++)"function"==typeof e[t[n]]&&(jexcel[t[n]]=e[t[n]],jexcel.license&&"function"==typeof e[t[n]].license&&e[t[n]].license(jexcel.license))},void 0!==formula&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(e){e.removeEventListener("mouseup",jexcel.mouseUpControls),e.removeEventListener("mousedown",jexcel.mouseDownControls),e.removeEventListener("mousemove",jexcel.mouseMoveControls),e.removeEventListener("mouseover",jexcel.mouseOverControls),e.removeEventListener("dblclick",jexcel.doubleClickControls),e.removeEventListener("paste",jexcel.pasteControls),e.removeEventListener("contextmenu",jexcel.contextMenuControls),e.removeEventListener("touchstart",jexcel.touchStartControls),e.removeEventListener("touchend",jexcel.touchEndControls),e.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component,e;return jexcel.destroy=function(e,t){if(e.jexcel){var n=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",t&&(destroyEvents(n),jexcel=null)}},jexcel.build=function(e){destroyEvents(e),e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(27==e.which)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault();else if(13==e.which)if("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if("dropdown"==jexcel.current.options.columns[jexcel.current.edition[2]].type||"autocomplete"==jexcel.current.options.columns[jexcel.current.edition[2]].type);else if((1==jexcel.current.options.wordWrap||1==jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var t=jexcel.current.edition[0].children[0],n=jexcel.current.edition[0].children[0].value,o=t.selectionStart;n=n.slice(0,o)+"\n"+n.slice(o),t.value=n,t.focus(),t.selectionStart=o+1,t.selectionEnd=o+1}else jexcel.current.edition[0].children[0].blur();else 9==e.which&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(37==e.which)jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault();else if(39==e.which)jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault();else if(38==e.which)jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault();else if(40==e.which)jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault();else if(36==e.which)jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault();else if(35==e.which)jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault();else if(46==e.which||8==e.which)1==jexcel.current.options.editable&&(jexcel.current.selectedRow?1==jexcel.current.options.allowDeleteRow&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?1==jexcel.current.options.allowDeleteColumn&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(13==e.which)e.shiftKey?jexcel.current.up():(1==jexcel.current.options.allowInsertRow&&1==jexcel.current.options.allowManualInsertRow&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault();else if(9==e.which)e.shiftKey?jexcel.current.left():(1==jexcel.current.options.allowInsertColumn&&1==jexcel.current.options.allowManualInsertColumn&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault();else if(!e.ctrlKey&&!e.metaKey||e.shiftKey){if(jexcel.current.selectedCell&&1==jexcel.current.options.editable){var r=jexcel.current.selectedCell[1],i=jexcel.current.selectedCell[0];"readonly"!=jexcel.current.options.columns[i].type&&(32==e.keyCode?(e.preventDefault(),"checkbox"==jexcel.current.options.columns[i].type||"radio"==jexcel.current.options.columns[i].type?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[r][i],!0)):113==e.keyCode?jexcel.current.openEditor(jexcel.current.records[r][i],!1):(8==e.keyCode||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||e.keyCode>=187&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[r][i],!0),"calendar"==jexcel.current.options.columns[i].type&&e.preventDefault()))}}else 65==e.which?(jexcel.current.selectAll(),e.preventDefault()):83==e.which?(jexcel.current.download(),e.preventDefault()):89==e.which?(jexcel.current.redo(),e.preventDefault()):90==e.which?(jexcel.current.undo(),e.preventDefault()):67==e.which?(jexcel.current.copy(!0),e.preventDefault()):88==e.which?(1==jexcel.current.options.editable?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):86==e.which&&jexcel.pasteControls();else e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout((function(){jexcel.current.search(e.target.value)}),200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;var n=jexcel.getElement(e.target);if(n[0]?jexcel.current!=n[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=n[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&1==t){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))1==jexcel.current.options.editable&&(jexcel.current.selectedCorner=!0);else{if(1==n[1]){if(f=e.target.getAttribute("data-x")){var o=e.target.getBoundingClientRect();if(1==jexcel.current.options.columnResize&&o.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:f,width:o.width},jexcel.current.headers[f].classList.add("resizing");for(var r=0;r<jexcel.current.records.length;r++)jexcel.current.records[r][f]&&jexcel.current.records[r][f].classList.add("resizing")}else if(1==jexcel.current.options.columnDrag&&o.height-e.offsetY<6)if(jexcel.current.isColMerged(f).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:f,destination:f},jexcel.current.headers[f].classList.add("dragging"),r=0;r<jexcel.current.records.length;r++)jexcel.current.records[r][f]&&jexcel.current.records[r][f].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey))var i=jexcel.current.selectedHeader,l=f;else jexcel.current.selectedHeader==f&&1==jexcel.current.options.allowRenameColumn&&(jexcel.timeControl=setTimeout((function(){jexcel.current.setHeader(f)}),800)),jexcel.current.selectedHeader=f,i=f,l=f;jexcel.current.updateSelectionFromCoords(i,0,l,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column"))var s=e.target.getAttribute("data-column").split(","),a=parseInt(s[0]),c=parseInt(s[s.length-1]);else a=0,c=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(a,0,c,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(2==n[1]){var u=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row"))o=e.target.getBoundingClientRect(),1==jexcel.current.options.rowResize&&o.height-e.offsetY<6?(jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:u,height:o.height},e.target.parentNode.classList.add("resizing")):1==jexcel.current.options.rowDrag&&o.width-e.offsetX<6?jexcel.current.isRowMerged(u).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==jexcel.current.options.search&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:u,destination:u},e.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey)?(i=jexcel.current.selectedRow,l=u):(jexcel.current.selectedRow=u,i=u,l=u),jexcel.current.updateSelectionFromCoords(0,i,jexcel.current.options.data[0].length-1,l));else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var d=function(e){var t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return t&&n?[t,n]:e.parentNode?d(e.parentNode):void 0},p=d(e.target);if(p){var f=p[0];u=p[1],jexcel.current.edition&&(jexcel.current.edition[2]==f&&jexcel.current.edition[3]==u||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],f,u):jexcel.current.updateSelectionFromCoords(f,u)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&("<"==e.target.textContent?jexcel.current.page(0):">"==e.target.textContent?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var t=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),n=jexcel.current.getSelectedColumns();if(n.length>1){for(var o=[],r=0;r<n.length;r++)o.push(parseInt(jexcel.current.colgroup[n[r]].getAttribute("width")));o[n.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(n,t,o)}else jexcel.current.setWidth(jexcel.current.resizing.column,t,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var i=0;i<jexcel.current.records.length;i++)jexcel.current.records[i][jexcel.current.resizing.column]&&jexcel.current.records[i][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var l=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,l,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var s=e.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),i=0;i<jexcel.current.rows.length;i++)jexcel.current.records[i][jexcel.current.dragging.column]&&jexcel.current.records[i][jexcel.current.dragging.column].classList.remove("dragging");for(r=0;r<jexcel.current.headers.length;r++)jexcel.current.headers[r].classList.remove("dragging-left"),jexcel.current.headers[r].classList.remove("dragging-right");s&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var a=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<a&&(a-=1)}else a=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,a,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current)if(1==jexcel.isMouseAction){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var n=e.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+n>0){var o=jexcel.current.resizing.width+n;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",o),jexcel.current.updateCornerPosition()}}else{var r=e.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+r>0){var i=jexcel.current.resizing.height+r;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",i),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var l=e.target.getAttribute("data-x");if(l)if(jexcel.current.isColMerged(l).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var s=0;s<jexcel.current.headers.length;s++)jexcel.current.headers[s].classList.remove("dragging-left"),jexcel.current.headers[s].classList.remove("dragging-right");jexcel.current.dragging.column==l?jexcel.current.dragging.destination=parseInt(l):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<l?jexcel.current.dragging.destination=parseInt(l)-1:jexcel.current.dragging.destination=parseInt(l),jexcel.current.headers[l].classList.add("dragging-left")):(jexcel.current.dragging.column<l?jexcel.current.dragging.destination=parseInt(l):jexcel.current.dragging.destination=parseInt(l)+1,jexcel.current.headers[l].classList.add("dragging-right"))}}else{var a=e.target.getAttribute("data-y");if(a)if(jexcel.current.isRowMerged(a).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var c=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;jexcel.current.dragging.element!=c&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,c),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var u=e.target.getAttribute("data-x"),d=e.target.getAttribute("data-y"),p=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&u&&!d&&p.width-(e.clientX-p.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!u&&d&&p.height-(e.clientY-p.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!u&&d&&p.width-(e.clientX-p.left)<6||e.target&&u&&!d&&p.height-(e.clientY-p.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if((e=e||window.event).buttons)var t=e.buttons;else t=e.button?e.button:e.which;if(t||(jexcel.isMouseAction=!1),jexcel.current&&1==jexcel.isMouseAction){var n=jexcel.getElement(e.target);if(n[0]){if(jexcel.current!=n[0].jexcel&&jexcel.current)return!1;var o=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");if(jexcel.current.resizing||jexcel.current.dragging);else{if(1==n[1]&&jexcel.current.selectedHeader){o=e.target.getAttribute("data-x");var i=jexcel.current.selectedHeader,l=o;jexcel.current.updateSelectionFromCoords(i,0,l,jexcel.current.options.data.length-1)}2==n[1]&&(e.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(i=jexcel.current.selectedRow,l=r,jexcel.current.updateSelectionFromCoords(0,i,jexcel.current.options.data[0].length-1,l)):jexcel.current.edition||o&&r&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(o,r):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],o,r)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var t=jexcel.current.highlighted[0].getAttribute("data-x"),n=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,o=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),r=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[n][t],jexcel.current.records[r][o])}}else if(e.target.classList.contains("jexcel_column_filter")){var i=e.target.getAttribute("data-x");jexcel.current.openFilter(i)}else{var l=jexcel.getElement(e.target);if(1==l[1]&&1==jexcel.current.options.columnSorting&&(i=e.target.getAttribute("data-x"))&&jexcel.current.orderBy(i),2==l[1]&&1==jexcel.current.options.editable&&!jexcel.current.edition){var s=function(e){if(e.parentNode){var t=e.getAttribute("data-x"),n=e.getAttribute("data-y");return t&&n?e:s(e.parentNode)}},a=s(e.target);a&&a.classList.contains("highlight")&&jexcel.current.openEditor(a)}}},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),1==jexcel.current.options.editable&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||1==jexcel.current.options.editable&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){if("buttons"in(e=e||window.event)?e.buttons:e.which||e.button,jexcel.current)if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var t=e.target.getAttribute("data-x"),n=e.target.getAttribute("data-y");if(t||n){(t<parseInt(jexcel.current.selectedCell[0])||t>parseInt(jexcel.current.selectedCell[2])||n<parseInt(jexcel.current.selectedCell[1])||n>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(t,n,t,n);var o=jexcel.current.options.contextMenu(jexcel.current,t,n,e);jexcel.current.contextMenu.contextmenu.open(e,o),e.preventDefault()}}},jexcel.touchStartControls=function(e){var t=jexcel.getElement(e.target);if(t[0]?jexcel.current!=t[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=t[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var n=e.target.getAttribute("data-x"),o=e.target.getAttribute("data-y");n&&o&&(jexcel.current.updateSelectionFromCoords(n,o),jexcel.timeControl=setTimeout((function(){"color"==jexcel.current.options.columns[n].type?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)}),500))}},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&"INPUT"==jexcel.tmpElement.children[0].tagName&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,t){var n=[];if(e.classList.contains("jexcel_tabs"))r=e.children[0],i=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var o=document.createElement("div"),r=e.appendChild(o),i=(o=document.createElement("div"),e.appendChild(o))}for(var l=[],s=[],a=0;a<t.length;a++){l[a]=document.createElement("div"),l[a].classList.add("jexcel_tab");var c=jexcel(l[a],t[a]);i.appendChild(l[a]),n[a]=e.jexcel.push(c),s[a]=document.createElement("div"),s[a].classList.add("jexcel_tab_link"),s[a].setAttribute("data-spreadsheet",e.jexcel.length-1),s[a].innerHTML=t[a].sheetName,s[a].onclick=function(){for(var e=0;e<r.children.length;e++)r.children[e].classList.remove("selected"),i.children[e].style.display="none";var t=this.getAttribute("data-spreadsheet");i.children[t].style.display="block",r.children[t].classList.add("selected")},r.appendChild(s[a])}for(var u=0;u<r.children.length;u++)r.children[u].classList.remove("selected"),i.children[u].style.display="none";return r.children[r.children.length-1].classList.add("selected"),i.children[r.children.length-1].style.display="block",n},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,t){var n,o=function(e){var t=[];return e.SheetNames.forEach((function(n){var o={rows:[],columns:[],data:[],style:{}};if(o.sheetName=n,(p=e.Sheets[n]["!cols"])&&p.length)for(var r=0;r<p.length;r++)o.columns[r]={},p[r]&&p[r].wpx&&(o.columns[r].width=p[r].wpx+"px");if((p=e.Sheets[n]["!rows"])&&p.length)for(r=0;r<p.length;r++)p[r]&&p[r].hpx&&(o.rows[r]={},o.rows[r].height=p[r].hpx+"px");if((p=e.Sheets[n]["!merges"])&&p.length>0)for(o.mergeCells=[],r=0;r<p.length;r++){var i=p[r].s.c,l=p[r].s.r,s=p[r].e.c,a=p[r].e.r,c=jexcel.getColumnNameFromId([i,l]);o.mergeCells[c]=[s-i+1,a-l+1]}var u=0,d=0,p=Object.keys(e.Sheets[n]);for(r=0;r<p.length;r++)if("!"!=p[r].substr(0,1)){var f=e.Sheets[n][p[r]],h=jexcel.getIdFromColumnName(p[r],!0);o.data[h[1]]||(o.data[h[1]]=[]),o.data[h[1]][h[0]]=f.f?"="+f.f:f.w,u<h[0]&&(u=h[0]),d<h[1]&&(d=h[1]),f.style&&Object.keys(f.style).length>0&&(o.style[p[r]]=f.style),f.s&&f.s.fgColor&&(o.style[p[r]]&&(o.style[p[r]]+=";"),o.style[p[r]]+="background-color:#"+f.s.fgColor.rgb)}for(var g=o.columns,m=0;m<=d;m++)for(r=0;r<=u;r++)o.data[m]||(o.data[m]=[]),o.data[m][r]||g<r&&(o.data[m][r]="");t.push(o)})),t};(n=new XMLHttpRequest).open("GET",e,!0),"undefined"!=typeof Uint8Array?(n.responseType="arraybuffer",n.onload=function(e){var r=n.response,i=new Uint8Array(r),l=XLSX.read(i,{type:"array",cellFormula:!0,cellStyles:!0});t(o(l))}):(n.setRequestHeader("Accept-Charset","x-user-defined"),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var e=convertResponseBodyToText(n.responseBody),r=XLSX.read(e,{type:"binary",cellFormula:!0,cellStyles:!0});t(o(r))}}),n.send()},jexcel.validLetter=function(e){return e.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},jexcel.getColumnName=function(e){return jexcel.helpers.getColumnName(e)},jexcel.getIdFromColumnName=function(e,t){var n=/^[a-zA-Z]+/.exec(e);if(n){for(var o=0,r=0;r<n[0].length;r++)o+=parseInt(n[0].charCodeAt(r)-64)*Math.pow(26,n[0].length-1-r);--o<0&&(o=0);var i=parseInt(/[0-9]+$/.exec(e));i>0&&i--,e=1==t?[o,i]:o+"-"+i}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var t=0,n=0;return function e(o){o.className&&o.classList.contains("jexcel_container")&&(n=o),"THEAD"==o.tagName?t=1:"TBODY"==o.tagName&&(t=2),o.parentNode&&(n||e(o.parentNode))}(e),[n,t]},jexcel.doubleDigitFormat=function(e){return 1==(e=""+e).length&&(e="0"+e),e},jexcel.createFromTable=function(e,t){if("TABLE"==e.tagName){t||(t={}),t.columns=[],t.data=[];var n=e.querySelectorAll("colgroup > col");if(n.length)for(var o=0;o<n.length;o++){if(!(r=n[o].style.width))var r=n[o].getAttribute("width");r&&(t.columns[o]||(t.columns[o]={}),t.columns[o].width=r)}var i=function(e){var n=e.getBoundingClientRect(),r=n.width>50?n.width:50;t.columns[o]||(t.columns[o]={}),e.getAttribute("data-celltype")?t.columns[o].type=e.getAttribute("data-celltype"):t.columns[o].type="text",t.columns[o].width=r+"px",t.columns[o].title=e.innerHTML,t.columns[o].align=e.style.textAlign||"center",(n=e.getAttribute("name"))&&(t.columns[o].name=n),(n=e.getAttribute("id"))&&(t.columns[o].id=n),(n=e.getAttribute("data-mask"))&&(t.columns[o].mask=n)},l=[],s=e.querySelectorAll(":scope > thead > tr");if(s.length){for(var a=0;a<s.length-1;a++){var c=[];for(o=0;o<s[a].children.length;o++){var u={title:s[a].children[o].textContent,colspan:s[a].children[o].getAttribute("colspan")||1};c.push(u)}l.push(c)}for(s=s[s.length-1].children,o=0;o<s.length;o++)i(s[o])}var d=0,p={},f={},h={},g={},m=e.querySelectorAll(":scope > tr, :scope > tbody > tr");for(a=0;a<m.length;a++)if(t.data[d]=[],1!=t.parseTableFirstRowAsHeader||s.length||0!=a){for(o=0;o<m[a].children.length;o++){if(b=m[a].children[o].getAttribute("data-formula"))"="!=b.substr(0,1)&&(b="="+b);else var b=m[a].children[o].innerHTML;t.data[d].push(b);var j=jexcel.getColumnNameFromId([o,a]),v=m[a].children[o].getAttribute("class");v&&(g[j]=v);var y=parseInt(m[a].children[o].getAttribute("colspan"))||0,x=parseInt(m[a].children[o].getAttribute("rowspan"))||0;(y||x)&&(p[j]=[y||1,x||1]),m[a].children[o].style&&"none"==m[a].children[o].style.display&&(m[a].children[o].style.display="");var w=m[a].children[o].getAttribute("style");w&&(h[j]=w),m[a].children[o].classList.contains("styleBold")&&(h[j]?h[j]+="; font-weight:bold;":h[j]="font-weight:bold;")}m[a].style&&m[a].style.height&&(f[a]={height:m[a].style.height}),d++}else for(o=0;o<m[a].children.length;o++)i(m[a].children[o]);if(Object.keys(l).length>0&&(t.nestedHeaders=l),Object.keys(h).length>0&&(t.style=h),Object.keys(p).length>0&&(t.mergeCells=p),Object.keys(f).length>0&&(t.rows=f),Object.keys(g).length>0&&(t.classes=g),(m=e.querySelectorAll("tfoot tr")).length){var C=[];for(a=0;a<m.length;a++){var E=[];for(o=0;o<m[a].children.length;o++)E.push(m[a].children[o].textContent);C.push(E)}Object.keys(C).length>0&&(t.footers=C)}if(1==t.parseTableAutoCellType){var A=[];for(o=0;o<t.columns.length;o++){var L=!0,M=!0;for(A[o]=[],a=0;a<t.data.length;a++)b=t.data[a][o],A[o][b]||(A[o][b]=0),A[o][b]++,b.length>25&&(L=!1),10==b.length&&"-"==b.substr(4,1)&&"-"==b.substr(7,1)||(M=!1);var N=Object.keys(A[o]).length;M?t.columns[o].type="calendar":1==L&&N>1&&N<=parseInt(.1*t.data.length)&&(t.columns[o].type="dropdown",t.columns[o].source=Object.keys(A[o]))}}return t}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(e){if(this.config.root)var t=this.config.root;else t=window;var n=0,o=t.getSelection();if(o&&0!==o.rangeCount){var r=o.getRangeAt(0),i=r.cloneRange();i.selectNodeContents(e),i.setEnd(r.endContainer,r.endOffset),n=i.toString().length}return n},invert:function(e){for(var t=[],n=Object.keys(e),o=0;o<n.length;o++)t[e[n[o]]]=n[o];return t},getColumnName:function(e){let t,n=e+1,o="";for(;n>0;)t=(n-1)%26,o=String.fromCharCode(65+t).toString()+o,n=parseInt((n-t)/26);return o},getColumnNameFromCoords:function(e,t){return component.getColumnName(parseInt(e))+(parseInt(t)+1)},getCoordsFromColumnName:function(e){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var n=0,o=0;o<t[0].length;o++)n+=parseInt(t[0].charCodeAt(o)-64)*Math.pow(26,t[0].length-1-o);--n<0&&(n=0);var r=parseInt(/[0-9]+$/.exec(e))||null;return r>0&&r--,[n,r]}},createFromTable:function(){},injectArray:function(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))},parseCSV:function(e,t){t=t||",";for(var n=0,o=0,r=[[]],i=0,l=null,s=!1,a=!1,c=0;c<e.length;c++)if(r[o]||(r[o]=[]),r[o][n]||(r[o][n]=""),"\r"!=e[c])if("\n"!=e[c]&&e[c]!=t||0!=s&&1!=a&&l){if('"'==e[c]&&(s=!s),null===l){if(1==(l=s))continue}else if(!0===l&&!a&&'"'==e[c]){'"'==e[c+1]?(s=!0,r[o][n]+=e[c],c++):a=!0;continue}r[o][n]+=e[c]}else{if(l=null,s=!1,a=!1,'"'==r[o][n][0]){var u=r[o][n].trim();'"'==u[u.length-1]&&(r[o][n]=u.substr(1,u.length-2))}"\n"==e[c]?(n=0,o++):++n>i&&(i=n)}for(var d=0;d<r.length;d++)for(c=0;c<=i;c++)void 0===r[d][c]&&(r[d][c]="");return r}},component),"undefined"!=typeof jQuery&&(e=jQuery,e.fn.jspreadsheet=e.fn.jexcel=function(t){var n=e(this).get(0);return n.jexcel?Array.isArray(n.jexcel)?n.jexcel[t][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):n.jexcel[t].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(e(this).get(0),arguments[0])}),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __nested_webpack_require_501977__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var n=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(n.exports,n,n.exports,__nested_webpack_require_501977__),n.exports}var __nested_webpack_exports__=__nested_webpack_require_501977__(44);jspreadsheet=__nested_webpack_exports__}(),jspreadsheet},module.exports=t()},2397:function(e,t,n){n(44114),n(14603),n(47566),n(98721),e.exports=function(){var e;return function(){var t={195:function(e){e.exports=function(e){function t(e,t){this.highOrder=e,this.lowOrder=t}var n,o,r,i,l,s,a,c,u,d,p=[new t(1779033703,4089235720),new t(3144134277,2227873595),new t(1013904242,4271175723),new t(2773480762,1595750129),new t(1359893119,2917565137),new t(2600822924,725511199),new t(528734635,4215389547),new t(1541459225,327033209)],f=[new t(1116352408,3609767458),new t(1899447441,602891725),new t(3049323471,3964484399),new t(3921009573,2173295548),new t(961987163,4081628472),new t(1508970993,3053834265),new t(2453635748,2937671579),new t(2870763221,3664609560),new t(3624381080,2734883394),new t(310598401,1164996542),new t(607225278,1323610764),new t(1426881987,3590304994),new t(1925078388,4068182383),new t(2162078206,991336113),new t(2614888103,633803317),new t(3248222580,3479774868),new t(3835390401,2666613458),new t(4022224774,944711139),new t(264347078,2341262773),new t(604807628,2007800933),new t(770255983,1495990901),new t(1249150122,1856431235),new t(1555081692,3175218132),new t(1996064986,2198950837),new t(2554220882,3999719339),new t(2821834349,766784016),new t(2952996808,2566594879),new t(3210313671,3203337956),new t(3336571891,1034457026),new t(3584528711,2466948901),new t(113926993,3758326383),new t(338241895,168717936),new t(666307205,1188179964),new t(773529912,1546045734),new t(1294757372,1522805485),new t(1396182291,2643833823),new t(1695183700,2343527390),new t(1986661051,1014477480),new t(2177026350,1206759142),new t(2456956037,344077627),new t(2730485921,1290863460),new t(2820302411,3158454273),new t(3259730800,3505952657),new t(3345764771,106217008),new t(3516065817,3606008344),new t(3600352804,1432725776),new t(4094571909,1467031594),new t(275423344,851169720),new t(430227734,3100823752),new t(506948616,1363258195),new t(659060556,3750685593),new t(883997877,3785050280),new t(958139571,3318307427),new t(1322822218,3812723403),new t(1537002063,2003034995),new t(1747873779,3602036899),new t(1955562222,1575990012),new t(2024104815,1125592928),new t(2227730452,2716904306),new t(2361852424,442776044),new t(2428436474,593698344),new t(2756734187,3733110249),new t(3204031479,2999351573),new t(3329325298,3815920427),new t(3391569614,3928383900),new t(3515267271,566280711),new t(3940187606,3454069534),new t(4118630271,4000239992),new t(116418474,1914138554),new t(174292421,2731055270),new t(289380356,3203993006),new t(460393269,320620315),new t(685471733,587496836),new t(852142971,1086792851),new t(1017036298,365543100),new t(1126000580,2618297676),new t(1288033470,3409855158),new t(1501505948,4234509866),new t(1607167915,987167468),new t(1816402316,1246189591)],h=new Array(64),g=8;function m(e){return unescape(encodeURIComponent(e))}function b(e){for(var t=[],n=(1<<g)-1,o=e.length*g,r=0;r<o;r+=g)t[r>>5]|=(e.charCodeAt(r/g)&n)<<32-g-r%32;return t}function j(e){for(var t,n="0123456789abcdef",o="",r=4*e.length,i=0;i<r;i+=1)t=e[i>>2]>>8*(3-i%4),o+=n.charAt(t>>4&15)+n.charAt(15&t);return o}function v(e,n){var o,r,i;return o=(65535&e.lowOrder)+(65535&n.lowOrder),i=(65535&(r=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(o>>>16)))<<16|65535&o,o=(65535&e.highOrder)+(65535&n.highOrder)+(r>>>16),new t((65535&(r=(e.highOrder>>>16)+(n.highOrder>>>16)+(o>>>16)))<<16|65535&o,i)}function y(e,n,o,r){var i,l,s;return i=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&o.lowOrder)+(65535&r.lowOrder),s=(65535&(l=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(o.lowOrder>>>16)+(r.lowOrder>>>16)+(i>>>16)))<<16|65535&i,i=(65535&e.highOrder)+(65535&n.highOrder)+(65535&o.highOrder)+(65535&r.highOrder)+(l>>>16),new t((65535&(l=(e.highOrder>>>16)+(n.highOrder>>>16)+(o.highOrder>>>16)+(r.highOrder>>>16)+(i>>>16)))<<16|65535&i,s)}function x(e,n,o,r,i){var l,s,a;return l=(65535&e.lowOrder)+(65535&n.lowOrder)+(65535&o.lowOrder)+(65535&r.lowOrder)+(65535&i.lowOrder),a=(65535&(s=(e.lowOrder>>>16)+(n.lowOrder>>>16)+(o.lowOrder>>>16)+(r.lowOrder>>>16)+(i.lowOrder>>>16)+(l>>>16)))<<16|65535&l,l=(65535&e.highOrder)+(65535&n.highOrder)+(65535&o.highOrder)+(65535&r.highOrder)+(65535&i.highOrder)+(s>>>16),new t((65535&(s=(e.highOrder>>>16)+(n.highOrder>>>16)+(o.highOrder>>>16)+(r.highOrder>>>16)+(i.highOrder>>>16)+(l>>>16)))<<16|65535&l,a)}function w(e,n,o){return new t(e.highOrder&n.highOrder^e.highOrder&o.highOrder^n.highOrder&o.highOrder,e.lowOrder&n.lowOrder^e.lowOrder&o.lowOrder^n.lowOrder&o.lowOrder)}function C(e,n,o){return new t(e.highOrder&n.highOrder^~e.highOrder&o.highOrder,e.lowOrder&n.lowOrder^~e.lowOrder&o.lowOrder)}function E(e,n){return n<=32?new t(e.highOrder>>>n|e.lowOrder<<32-n,e.lowOrder>>>n|e.highOrder<<32-n):new t(e.lowOrder>>>n|e.highOrder<<32-n,e.highOrder>>>n|e.lowOrder<<32-n)}function A(e){var n=E(e,28),o=E(e,34),r=E(e,39);return new t(n.highOrder^o.highOrder^r.highOrder,n.lowOrder^o.lowOrder^r.lowOrder)}function L(e){var n=E(e,14),o=E(e,18),r=E(e,41);return new t(n.highOrder^o.highOrder^r.highOrder,n.lowOrder^o.lowOrder^r.lowOrder)}function M(e){var n=E(e,1),o=E(e,8),r=I(e,7);return new t(n.highOrder^o.highOrder^r.highOrder,n.lowOrder^o.lowOrder^r.lowOrder)}function N(e){var n=E(e,19),o=E(e,61),r=I(e,6);return new t(n.highOrder^o.highOrder^r.highOrder,n.lowOrder^o.lowOrder^r.lowOrder)}function I(e,n){return n<=32?new t(e.highOrder>>>n,e.lowOrder>>>n|e.highOrder<<32-n):new t(0,e.highOrder<<32-n)}var T=(e=m(e)).length*g;(e=b(e))[T>>5]|=128<<24-T%32,e[31+(T+128>>10<<5)]=T;for(var D=0;D<e.length;D+=32){n=p[0],o=p[1],r=p[2],i=p[3],l=p[4],s=p[5],a=p[6],c=p[7];for(var S=0;S<80;S++)h[S]=S<16?new t(e[2*S+D],e[2*S+D+1]):y(N(h[S-2]),h[S-7],M(h[S-15]),h[S-16]),u=x(c,L(l),C(l,s,a),f[S],h[S]),d=v(A(n),w(n,o,r)),c=a,a=s,s=l,l=v(i,u),i=r,r=o,o=n,n=v(u,d);p[0]=v(n,p[0]),p[1]=v(o,p[1]),p[2]=v(r,p[2]),p[3]=v(i,p[3]),p[4]=v(l,p[4]),p[5]=v(s,p[5]),p[6]=v(a,p[6]),p[7]=v(c,p[7])}var O=[];for(D=0;D<p.length;D++)O.push(p[D].highOrder),O.push(p[D].lowOrder);return j(O)}}},n={};function o(e){var r=n[e];if(void 0!==r)return r.exports;var i=n[e]={exports:{}};return t[e].call(i.exports,i,i.exports,o),i.exports}o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,{a:t}),t},o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var r={};!function(){"use strict";o.d(r,{default:function(){return R}});var t={setDictionary:function(e){document.dictionary||(document.dictionary={});var t=null,n=Object.keys(e);for(t=0;t<n.length;t++)document.dictionary[n[t]]=e[n[t]]},translate:function(e){return"undefined"!=typeof document&&document.dictionary&&document.dictionary[e]||e}};var n=function(e,t){if(!0===t)window.jSuitesStateControl=window.jSuitesStateControl.filter((function(e){return null!==e})),setTimeout((function(){window.jSuitesStateControl.push(e)}),0);else{var n=window.jSuitesStateControl.indexOf(e);n>=0&&window.jSuitesStateControl.splice(n,1)}},i={two:function(e){return 1==(e=""+e).length&&(e="0"+e),e},focus:function(e){if(e.innerText.length){var t=document.createRange(),n=window.getSelection(),o=e.childNodes[e.childNodes.length-1];t.setStart(o,o.length),t.collapse(!0),n.removeAllRanges(),n.addRange(t),e.scrollLeft=e.scrollWidth}},isNumeric:function(e){return"string"==typeof e&&(e=e.trim()),!isNaN(e)&&null!==e&&""!==e},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},getNode:function(){var e=document.getSelection().anchorNode;return e?3==e.nodeType?e.parentNode:e:null},hash:function(e){var t,n,o=0;if(0===e.length)return o;for(t=0;t<e.length;t++)(n=e.charCodeAt(t))>32&&(o=(o<<5)-o+n,o|=0);return o},randomColor:function(e){var t=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");t.length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);var n,o,r=[];for(o=0;o<3;o++)n=parseInt(t.substr(2*o,2),16),n=Math.round(Math.min(Math.max(0,n+-.25*n),255)).toString(16),r.push(("00"+n).substr(n.length));return 1==e?"#"+i.two(r[0].toString(16))+i.two(r[1].toString(16))+i.two(r[2].toString(16)):r},getWindowWidth:function(){var e=window,t=document,n=t.documentElement,o=t.getElementsByTagName("body")[0];return e.innerWidth||n.clientWidth||o.clientWidth},getWindowHeight:function(){var e=window,t=document,n=t.documentElement,o=t.getElementsByTagName("body")[0];return e.innerHeight||n.clientHeight||o.clientHeight},getPosition:function(e){if(e.changedTouches&&e.changedTouches[0])var t=e.changedTouches[0].pageX,n=e.changedTouches[0].pageY;else t=window.Event?e.pageX:e.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),n=window.Event?e.pageY:e.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[t,n]},click:function(e){if(e.click)e.click();else{var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});e.dispatchEvent(t)}},findElement:function(e,t){var n=!1;return function e(o){o&&!n&&("function"==typeof t?n=t(o):"string"==typeof t&&o.classList&&o.classList.contains(t)&&(n=o)),o.parentNode&&!n&&e(o.parentNode)}(e),n}},l=i;function s(e,t,n){if((e=e.split(".")).length){let o=this,r=null;for(;e.length>1;)if(r=e.shift(),o.hasOwnProperty(r))o=o[r];else{if(void 0===t)return;o[r]={},o=o[r]}if(r=e.shift(),void 0!==t)return!0===n?delete o[r]:o[r]=t,!0;if(o)return o[r]}return!1}function a(e,t){var n={options:{}},o={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},r=null;for(var i in o)t&&t.hasOwnProperty(i)?n.options[i]=t[i]:n.options[i]=o[i];e.classList.add("jsorting"),e.addEventListener("dragstart",(function(t){let o=t.target;if(3===o.nodeType){if("true"!==o.parentNode.getAttribute("draggable"))return t.preventDefault(),void t.stopPropagation();o=o.parentNode}if("true"===o.getAttribute("draggable")){let i=Array.prototype.indexOf.call(o.parentNode.children,o);r={element:o,o:i,d:i},o.style.opacity="0.25","function"==typeof n.options.ondragstart&&n.options.ondragstart(e,o,t),t.dataTransfer.setDragImage(o,0,0)}})),e.addEventListener("dragover",(function(e){if(e.preventDefault(),r&&l(e.target)&&"true"==e.target.getAttribute("draggable")&&r.element!=e.target){if(n.options.direction)t=e.target.clientWidth/2>e.offsetX;else var t=e.target.clientHeight/2>e.offsetY;t?e.target.parentNode.insertBefore(r.element,e.target):e.target.parentNode.insertBefore(r.element,e.target.nextSibling),r.d=Array.prototype.indexOf.call(e.target.parentNode.children,r.element)}})),e.addEventListener("dragleave",(function(e){e.preventDefault()})),e.addEventListener("dragend",(function(t){t.preventDefault(),r&&("function"==typeof n.options.ondragend&&n.options.ondragend(e,r.element,t),r.o<r.d?t.target.parentNode.insertBefore(r.element,t.target.parentNode.children[r.o]):t.target.parentNode.insertBefore(r.element,t.target.parentNode.children[r.o].nextSibling),r.element.style.opacity="",r=null)})),e.addEventListener("drop",(function(t){t.preventDefault(),r&&(r.o!==r.d&&"function"==typeof n.options.ondrop&&n.options.ondrop(e,r.o,r.d,r.element,t.target,t),r.element.style.opacity="",r=null)}));for(var l=function(e){var t=!1;return function e(n){n.className&&n.classList.contains("jsorting")&&(t=!0),t||e(n.parentNode)}(e),t},s=0;s<e.children.length;s++)e.children[s].hasAttribute("draggable")||e.children[s].setAttribute("draggable","true");return e.val=function(){for(var t=null,n=[],o=0;o<e.children.length;o++)(t=e.children[o].getAttribute("data-id"))&&n.push(t);return n},e}function c(e,t){t.loadUp&&"function"==typeof t.loadUp||(t.loadUp=function(){return!1}),t.loadDown&&"function"==typeof t.loadDown||(t.loadDown=function(){return!1}),t.timer||(t.timer=100);var n=null,o=function(o){if(null==n){var r=!1,i=e.scrollTop;e.scrollTop+2*e.clientHeight>=e.scrollHeight?t.loadDown()&&(i==e.scrollTop&&(e.scrollTop=e.scrollTop-e.clientHeight),r=!0):e.scrollTop<=e.clientHeight&&t.loadUp()&&(i==e.scrollTop&&(e.scrollTop=e.scrollTop+e.clientHeight),r=!0),n=setTimeout((function(){n=null}),t.timer),r&&"function"==typeof t.onupdate&&t.onupdate()}};return e.onscroll=function(e){o()},e.onwheel=function(e){o()},{}}var u=function(){var e=function(t,n){if(Array.isArray(t)){var o={instance:[],complete:n};if(t.length>0)for(var r=0;r<t.length;r++)t[r].multiple=o,o.instance.push(e(t[r]));return o}if(t.data||(t.data={}),t.type&&(t.method=t.type),t.method||(t.method="GET"),t.dataType||(t.dataType="json"),t.data){var i=function(e,t){var n=[];if(e){var o=Object.keys(e);if(o.length)for(var r=0;r<o.length;r++){if(t)var l=t+"["+o[r]+"]";else l=o[r];if(e[l]instanceof FileList)n[l]=e[o[r]];else if(null===e[o[r]]||void 0===e[o[r]])n[l]="";else if("object"==typeof e[o[r]])for(var s=i(e[o[r]],l),a=Object.keys(s),c=0;c<a.length;c++)n[a[c]]=s[a[c]];else n[l]=e[o[r]]}}return n},l=i(t.data),s=Object.keys(l);if("GET"==t.method){if(s.length){var a=[];for(r=0;r<s.length;r++)a.push(s[r]+"="+encodeURIComponent(l[s[r]]));t.url.indexOf("?")<0&&(t.url+="?"),t.url+=a.join("&")}}else for(a=new FormData,r=0;r<s.length;r++)if(l[s[r]]instanceof FileList){if(l[s[r]].length)for(var c=0;c<l[s[r]].length;c++)a.append(s[r],l[s[r]][c],l[s[r]][c].name)}else a.append(s[r],l[s[r]])}var u=new XMLHttpRequest;return u.open(t.method,t.url,!0),t.requestedWith?u.setRequestHeader("X-Requested-With",t.requestedWith):!1!==t.requestedWith&&u.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.contentType&&u.setRequestHeader("Content-Type",t.contentType),"POST"===t.method?u.setRequestHeader("Accept","application/json"):"blob"===t.dataType?u.responseType="blob":t.contentType||("json"===t.dataType?u.setRequestHeader("Content-Type","text/json"):"html"===t.dataType&&u.setRequestHeader("Content-Type","text/html")),!0!==t.cache&&(u.setRequestHeader("pragma","no-cache"),u.setRequestHeader("cache-control","no-cache")),!0===t.withCredentials&&(u.withCredentials=!0),"function"==typeof t.beforeSend&&t.beforeSend(u),"function"==typeof e.beforeSend&&e.beforeSend(u),document.ajax&&"function"==typeof document.ajax.beforeSend&&document.ajax.beforeSend(u),u.onerror=function(){t.error&&"function"==typeof t.error&&t.error({message:"Network error: Unable to reach the server.",status:0})},u.ontimeout=function(){t.error&&"function"==typeof t.error&&t.error({message:"Request timed out after "+u.timeout+"ms.",status:0})},u.onload=function(){if(u.status>=200&&u.status<300)if("json"===t.dataType)try{var n=JSON.parse(u.responseText);t.success&&"function"==typeof t.success&&t.success(n)}catch(e){t.error&&"function"==typeof t.error&&t.error(e,n)}else n="blob"===t.dataType?u.response:u.responseText,t.success&&"function"==typeof t.success&&t.success(n);else t.error&&"function"==typeof t.error&&t.error(u.responseText,u.status);if(e.queue&&e.queue.length>0&&e.send(e.queue.shift()),e.requests&&e.requests.length){var o=e.requests.indexOf(u);e.requests.splice(o,1),e.requests.length||t.complete&&"function"==typeof t.complete&&t.complete(n),t.group&&e.oncomplete&&"function"==typeof e.oncomplete[t.group]&&(e.pending(t.group)||(e.oncomplete[t.group](),e.oncomplete[t.group]=null)),t.multiple&&t.multiple.instance&&(o=t.multiple.instance.indexOf(u),t.multiple.instance.splice(o,1),t.multiple.instance.length||t.multiple.complete&&"function"==typeof t.multiple.complete&&t.multiple.complete(n))}},u.options=t,u.data=a,!0===t.queue&&e.requests.length>0?e.queue.push(u):e.send(u),u};return e.send=function(t){t.data?Array.isArray(t.data)?t.send(t.data.join("&")):t.send(t.data):t.send(),e.requests.push(t)},e.exists=function(e,t){var n=new XMLHttpRequest;n.open("HEAD",e,!1),n.send(),n.status&&t(n.status)},e.pending=function(t){var n=0,o=e.requests;if(o&&o.length)for(var r=0;r<o.length;r++)t&&t!=o[r].options.group||n++;return n},e.oncomplete={},e.requests=[],e.queue=[],e}();var d=function(){const e={loading:{}};return e.loading.show=function(t){e.loading.element||(e.loading.element=document.createElement("div"),e.loading.element.className="jloading"),document.body.appendChild(e.loading.element),t>0&&setTimeout((function(){e.loading.hide()}),1e3*t)},e.loading.hide=function(){e.loading.element&&e.loading.element.parentNode&&document.body.removeChild(e.loading.element)},e.slideLeft=function(e,t,n){1==t?(e.classList.add("jslide-left-in"),setTimeout((function(){e.classList.remove("jslide-left-in"),"function"==typeof n&&n()}),400)):(e.classList.add("jslide-left-out"),setTimeout((function(){e.classList.remove("jslide-left-out"),"function"==typeof n&&n()}),400))},e.slideRight=function(e,t,n){!0===t?(e.classList.add("jslide-right-in"),setTimeout((function(){e.classList.remove("jslide-right-in"),"function"==typeof n&&n()}),400)):(e.classList.add("jslide-right-out"),setTimeout((function(){e.classList.remove("jslide-right-out"),"function"==typeof n&&n()}),400))},e.slideTop=function(e,t,n){!0===t?(e.classList.add("jslide-top-in"),setTimeout((function(){e.classList.remove("jslide-top-in"),"function"==typeof n&&n()}),400)):(e.classList.add("jslide-top-out"),setTimeout((function(){e.classList.remove("jslide-top-out"),"function"==typeof n&&n()}),400))},e.slideBottom=function(e,t,n){!0===t?(e.classList.add("jslide-bottom-in"),setTimeout((function(){e.classList.remove("jslide-bottom-in"),"function"==typeof n&&n()}),400)):(e.classList.add("jslide-bottom-out"),setTimeout((function(){e.classList.remove("jslide-bottom-out"),"function"==typeof n&&n()}),100))},e.fadeIn=function(e,t){e.style.display="",e.classList.add("jfade-in"),setTimeout((function(){e.classList.remove("jfade-in"),"function"==typeof t&&t()}),2e3)},e.fadeOut=function(e,t){e.classList.add("jfade-out"),setTimeout((function(){e.style.display="none",e.classList.remove("jfade-out"),"function"==typeof t&&t()}),1e3)},e}();var p=function(){var e={now:function(e,t){var n=null,o=null,r=null,i=null,s=null,a=null;return Array.isArray(e)?(n=e[0],o=e[1],r=e[2],i=e[3],s=e[4],a=e[5]):(e||(e=new Date),n=e.getFullYear(),o=e.getMonth()+1,r=e.getDate(),i=e.getHours(),s=e.getMinutes(),a=e.getSeconds()),1==t?l.two(n)+"-"+l.two(o)+"-"+l.two(r):l.two(n)+"-"+l.two(o)+"-"+l.two(r)+" "+l.two(i)+":"+l.two(s)+":"+l.two(a)},toArray:function(e){var t=e.split(-1!==e.indexOf("T")?"T":" "),n=t[1],o=(t=t[0].split("-"),parseInt(t[0])),r=parseInt(t[1]),i=parseInt(t[2]),l=0,s=0;return n&&(n=n.split(":"),l=parseInt(n[0]),s=parseInt(n[1])),[o,r,i,l,s,0]}},n=Date.UTC(1900,0,0),o=Date.UTC(1900,1,29),r=864e5;e.dateToNum=function(e){"string"==typeof e&&(e=new Date(e+"  GMT+0"));var t=e.getTime();return t>=o&&(t+=r),(t-=n)/r},e.numToDate=function(t){var i=n+t*r;i>=o&&(i-=r);const l=new Date(i);var s=[l.getUTCFullYear(),l.getUTCMonth()+1,l.getUTCDate(),l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds()];return e.now(s)};let i=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(e,"weekdays",{get:function(){return i.map((function(e){return t.translate(e)}))}}),Object.defineProperty(e,"weekdaysShort",{get:function(){return i.map((function(e){return t.translate(e).substring(0,3)}))}}),Object.defineProperty(e,"months",{get:function(){return s.map((function(e){return t.translate(e)}))}}),Object.defineProperty(e,"monthsShort",{get:function(){return s.map((function(e){return t.translate(e).substring(0,3)}))}}),e}();var f=function(){var t={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},n=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var e=0;this.date[4]&&(e=parseFloat(this.date[4]/60));var t=parseInt(this.date[3])+e;t/=24}else this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),t=l.two(this.date[0])+"-"+l.two(this.date[1])+"-"+l.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(t+=" "+l.two(this.date[3])+":"+l.two(this.date[4])+":"+l.two(this.date[5]))):t=l.two(this.date[3])+":"+l.two(this.date[4])+":"+l.two(this.date[5]);return t},o=function(){var e="";if(this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]){if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var t=p.now(this.date);e=p.dateToNum(t),this.date[4]&&(e+=parseFloat(this.date[4]/60))}}else{if(-1!==this.mask.toLowerCase().indexOf("[h]"))e=parseInt(this.date[3]);else{let t=parseInt(this.date[3]);e=t<13&&-1!==this.values.indexOf("PM")?(t+12)%24:t%24}this.date[4]&&(e+=parseFloat(this.date[4]/60)),this.date[5]&&(e+=parseFloat(this.date[5]/3600)),e/=24}return isNaN(e)&&(e=""),e},r=function(e){return null===e||""===e||void 0===e},i=function(e){return"currency"===e||"percentage"===e||"scientific"===e||"numeric"===e},s=function(e){if(e&&Number(e)==e)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var t=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=t[1]}e||(e=this.mask);var n=new RegExp("0{1}(.{1})0+","ig");return(t=n.exec(e))&&t[1]&&1==t[1].length?(this.options.decimal=t[1],t[1]):((t=(n=new RegExp("#{1}(.{1})#+","ig")).exec(e))&&t[1]&&1==t[1].length?","===t[1]?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2),this.options.decimal?this.options.decimal:null)},a=function(e,t){if(""==e)return"";t||(t=s.call(this));var n=(e=(""+e).split(t))[0].match(/[-]+/g);return n=!(!n||!n.length),e[0]=e[0].match(/[0-9]+/g),e[0]?(n&&e[0].unshift("-"),e[0]=e[0].join("")):n&&(e[0]="-"),e[0]||e[1]?(void 0!==e[1]&&(e[1]=e[1].match(/[0-9]+/g),e[1]?e[1]=e[1].join(""):e[1]=""),e):""},c=function(e,t){if(""===e)return"";var n=s.call(this),o=this.options;if(""===(e=a.call(this,e)))return"";var r=null;if(e[0]&&(r="percent"===o.style?parseFloat(e[0])/100:parseFloat(e[0]+".1")),("-"===e[0]||"-00"===e[0])&&!e[1]&&t&&"deleteContentBackward"==t.inputType)return"";var i=new Intl.NumberFormat(this.locale,o).format(r);if(i=i.split(n),"percent"===o.style&&-1!==i[0].indexOf("%")&&(i[0]=i[0].replace("%",""),i[2]="%"),void 0!==i[1]){var l=i[1].replace(/[0-9]*/g,"");l&&(i[2]=l)}return void 0!==e[1]?i[1]=n+e[1]:i[1]="",i.join("")},u=function(e,t){var n=h.call(e);if(n){var o=c.call(this,n,t),r=o.length-n.length,i=f.call(e)+r;h.call(e,o,i,!0)}},d=function(e){var t=a.call(this,e);return t?("-"===t[0]&&(t[0]="-0"),parseFloat(t.join("."))):null},f=function(e,t){if(void 0===e){if("DIV"==this.tagName){var n=0,o=window.getSelection();if(o&&0!==o.rangeCount){var r=o.getRangeAt(0),i=r.cloneRange();i.selectNodeContents(this),i.setEnd(r.endContainer,r.endOffset),n=i.toString().length}return n}return this.selectionStart}var l=h.call(this);if(t){i=null;for(var s=0;s<l.length;s++)(l[s].match(/[\-0-9]/g)||"."===l[s]||","===l[s])&&(i=s);null===i&&(i=l.indexOf(" ")),e>=i&&(e=i+1)}e>l.length&&(e=l.length),e&&("DIV"==this.tagName?(o=window.getSelection(),r=document.createRange(),this.childNodes[0]&&(r.setStart(this.childNodes[0],e),o.removeAllRanges(),o.addRange(r))):(this.selectionStart=e,this.selectionEnd=e))},h=function(e,t,n){if("DIV"==this.tagName){if(void 0===e)return e=this.innerText,this.value&&this.value.length>e.length&&(e=this.value),e;this.innerText!==e&&(this.innerText=e,t&&f.call(this,t,n))}else{if(void 0===e)return this.value;this.value!==e&&(this.value=e,t&&f.call(this,t,n))}},g=p.weekdays,m=p.weekdaysShort,b=p.months,j=p.monthsShort,v={YEAR:function(e,t){var n=""+(new Date).getFullYear();void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<=10&&this.values[this.index].length<t&&(this.values[this.index]+=e),this.values[this.index].length==t&&(2==t?n=n.substr(0,2)+this.values[this.index]:3==t?n=n.substr(0,1)+this.values[this.index]:4==t&&(n=this.values[this.index]),this.date[0]=n,this.index++)},YYYY:function(e){v.YEAR.call(this,e,4)},YYY:function(e){v.YEAR.call(this,e,3)},YY:function(e){v.YEAR.call(this,e,2)},FIND:function(e,t){if(r(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1)this.values[this.index]+=e;else{for(var n=0,o=0,i=(this.values[this.index]+e).toLowerCase(),l=0;l<t.length;l++)0==t[l].toLowerCase().indexOf(i)&&(n=l,o++);if(o>1)this.values[this.index]+=e;else if(1==o){var s=t[n].length-this.values[this.index].length-1;return this.position+=s,this.values[this.index]=t[n],this.index++,n}}},MMM:function(e){var t=v.FIND.call(this,e,j);void 0!==t&&(this.date[1]=t+1)},MON:function(e){v.MMM.call(this,e)},MMMM:function(e){var t=v.FIND.call(this,e,b);void 0!==t&&(this.date[1]=t+1)},MONTH:function(e){v.MMMM.call(this,e)},MMMMM:function(e){r(this.values[this.index])&&(this.values[this.index]="");for(var t=(this.values[this.index]+e).toLowerCase(),n=0;n<b.length;n++)if(0==b[n][0].toLowerCase().indexOf(t)){this.values[this.index]=b[n][0],this.date[1]=n+1,this.index++;break}},MM:function(e){r(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(this.date[1]=this.values[this.index]="0"+e,this.index++):parseInt(e)<2&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[1]=this.values[this.index]+=e,this.index++)},M:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?r(this.values[this.index])?(this.values[this.index]=e,e>1&&(this.date[1]=this.values[this.index],this.index++)):1==this.values[this.index]&&parseInt(e)<3||0==this.values[this.index]&&parseInt(e)>0?(this.date[1]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var n=parseInt(this.values[this.index]);n>0&&n<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(e){var t=!1;if(parseInt(e)>=0&&parseInt(e)<10?r(this.values[this.index])?(this.values[this.index]=e,parseInt(e)>3&&(this.date[2]=this.values[this.index],this.index++)):3==this.values[this.index]&&parseInt(e)<2||1==this.values[this.index]||2==this.values[this.index]||0==this.values[this.index]&&parseInt(e)>0?(this.date[2]=this.values[this.index]+=e,this.index++):t=!0:t=!0,1==t){var n=parseInt(this.values[this.index]);n>0&&n<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(e){r(this.values[this.index])?parseInt(e)>3&&parseInt(e)<10?(this.date[2]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(3==this.values[this.index]&&parseInt(e)<2||(1==this.values[this.index]||2==this.values[this.index])&&parseInt(e)<10||0==this.values[this.index]&&parseInt(e)>0&&parseInt(e)<10)&&(this.date[2]=this.values[this.index]+=e,this.index++)},DDD:function(e){v.FIND.call(this,e,m)},DY:function(e){v.DDD.call(this,e)},DDDD:function(e){v.FIND.call(this,e,g)},DAY:function(e){v.DDDD.call(this,e)},HH12:function(e,t){r(this.values[this.index])?parseInt(e)>1&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(1==this.values[this.index]&&parseInt(e)<3||this.values[this.index]<1&&parseInt(e)<10)&&(this.date[3]=this.values[this.index]+=e,this.index++)},HH24:function(e,t){parseInt(e)>=0&&parseInt(e)<10&&(null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>2&&parseInt(e)<10?(t&&(e=0+e),this.date[3]=this.values[this.index]=e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):(2==this.values[this.index]&&parseInt(e)<4||this.values[this.index]<2&&parseInt(e)<10)&&(t||"0"!==this.values[this.index]||(this.values[this.index]=""),this.date[3]=this.values[this.index]+=e,this.index++))},HH:function(e){v.HH24.call(this,e,1)},H:function(e){v.HH24.call(this,e,0)},"\\[H\\]":function(e){null==this.values[this.index]&&(this.values[this.index]=""),e.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=e:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(e,t){null==this.values[this.index]||""==this.values[this.index]?parseInt(e)>5&&parseInt(e)<10?(this.date[t]=this.values[this.index]="0"+e,this.index++):parseInt(e)<10&&(this.values[this.index]=e):parseInt(e)<10&&(this.date[t]=this.values[this.index]+=e,this.index++)},MI:function(e){v.N60.call(this,e,4)},SS:function(e){v.N60.call(this,e,5)},"AM/PM":function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),""===this.values[this.index]?e.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":e.match(/p/i)&&(this.values[this.index]+="P"):"A"!==this.values[this.index]&&"P"!==this.values[this.index]||(this.values[this.index]+="M",this.index++)},WD:function(e){void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(e)>=0&&parseInt(e)<7&&(this.values[this.index]=e),1==this.values[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(e){var t=s.call(this),n=!1;r(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(n=!0);var o=a.call(this,this.values[this.index],t);o&&(this.values[this.index]=o.join(t)),parseInt(e)>=0&&parseInt(e)<10?("0"==this.values[this.index]&&e>0?this.values[this.index]="":"-0"==this.values[this.index]&&e>0&&(this.values[this.index]="-"),("0"!=this.values[this.index]&&"-0"!=this.values[this.index]||e==t)&&(this.values[this.index]+=e)):t&&e==t?-1==this.values[this.index].indexOf(t)&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=e):"-"==e&&(n=!0),!0===n&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(e){v["0{1}(.{1}0+)?"].call(this,e)},"0{1}(.{1}0+)?%":function(e){v["0{1}(.{1}0+)?"].call(this,e),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(e){v["0{1}(.{1}0+)?"].call(this,e);var t=s.call(this),n=this.tokens[this.index].substr(1,1),o="-"===this.values[this.index][0],r=a.call(this,this.values[this.index],t);if(""!==r){var i=r[0].match(/[0-9]/g);if(i){for(var l=[],c=0,u=(i=i.join("")).length-1;u>=0;u--)l.push(i[u]),++c%3||l.push(n);l=l.reverse(),r[0]=l.join(""),r[0].substr(0,1)==n&&(r[0]=r[0].substr(1))}else r[0]="";this.values[this.index]=r.join(t),o&&(this.values[this.index]="-"+this.values[this.index])}},0:function(e){e.match(/[0-9]/g)&&(this.values[this.index]=e,this.index++)},"[0-9a-zA-Z$]+":function(e){r(this.values[this.index])&&(this.values[this.index]="");var t=this.tokens[this.index];t[this.values[this.index].length]==e?(this.values[this.index]+=e,this.values[this.index]==t&&this.index++):(this.values[this.index]=t,this.index++,e.match(/[\-0-9]/g)&&this.position--)},A:function(e){e.match(/[a-zA-Z]/gi)&&(this.values[this.index]=e,this.index++)},".":function(e){v["[0-9a-zA-Z$]+"].call(this,e)},"@":function(e){r(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=e}},y=function(e){if("general"==this.type)var n=[].concat(t.general);else n=[].concat(t.currency,t.datetime,t.percentage,t.scientific,t.numeric,t.text,t.general);var o=new RegExp(n.join("|"),"gi");return e.match(o)},x=function(e){if(this.type)n="text"==this.type?["text"]:"general"==this.type?["general"]:"datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","scientific","numeric","general"];else var n=Object.keys(t);for(var o=0;o<n.length;o++)for(var r=n[o],i=0;i<t[r].length;i++){var l=new RegExp(t[r][i],"gi");if(e.match(l))return{type:r,method:t[r][i]}}},w=function(e){for(var t=[],n=0;n<e.length;n++){var o=x.call(this,e[n]);o?t.push(o.method):t.push(null)}for(n=0;n<t.length;n++)"MM"==t[n]&&(t[n-1]&&t[n-1].indexOf("H")>=0||t[n-2]&&t[n-2].indexOf("H")>=0||t[n+1]&&t[n+1].indexOf("S")>=0||t[n+2]&&t[n+2].indexOf("S")>=0)&&(t[n]="MI");return t},C=function(e){var t=x.call(this,e);if(t)var n=t.type;if(n){for(var o=0,r=y.call(this,e),l=0;l<r.length;l++)(t=x.call(this,r[l]))&&i(t.type)&&o++;o>1&&(n="general")}return n},E=function(){"function"==typeof v[this.methods[this.index]]?(v[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},A=function(e){return(""+ +e).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,(function(e,t,n,o,r){return r<0?t+"0."+Array(1-r-n.length).join(0)+n+o:t+n+o+Array(r-o.length+1).join(0)}))},L=function(e,t,o){var r=null,a={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof e){if(a.input=e.target,a.value=h.call(e.target),a.caret=f.call(e.target),(r=e.target.getAttribute("data-mask"))&&(a.mask=r),(r=e.target.getAttribute("data-type"))&&(a.type=r),e.target.mask?(e.target.mask.options&&(a.options=e.target.mask.options),e.target.mask.locale&&(a.locale=e.target.mask.locale)):(r=e.target.getAttribute("data-locale"))&&(a.locale=r,a.mask&&(a.options.style=a.mask)),e.target.attributes&&e.target.attributes.length)for(var p=0;p<e.target.attributes.length;p++){var g=e.target.attributes[p].name,m=e.target.attributes[p].value;"data"==g.substr(0,4)&&(a.options[g.substr(5)]=m)}}else{if("string"==typeof t)a.mask=t;else for(g=Object.keys(t),p=0;p<g.length;p++)a[g[p]]=t[g[p]];"number"==typeof e&&(s.call(a,a.mask),e=(""+e).replace(".",a.options.decimal)),a.value=e,a.input&&(h.call(a.input,e),l.focus(a.input),a.caret=f.call(a.input))}if(!function(e){return"="==(""+e)[0]}(a.value)&&(a.mask||a.locale)){if(a.mask){if(a.mask=a.mask.replace(new RegExp(/\[h]/),"|h|"),a.mask=a.mask.replace(new RegExp(/\[.*?\]/),""),a.mask=a.mask.replace(new RegExp(/\|h\|/),"[h]"),-1!==a.mask.indexOf(";")&&(r=a.mask.split(";"),a.mask=r[0]),-1!==a.mask.indexOf("##")){var b=a.mask.split(";");b[0]&&("object"==typeof e&&(b[0]=b[0].replace(new RegExp(/_\)/g),""),b[0]=b[0].replace(new RegExp(/_\(/g),"")),b[0]=b[0].replace("*","\t"),b[0]=b[0].replace(new RegExp(/_-/g),""),b[0]=b[0].replace(new RegExp(/_/g),""),b[0]=b[0].replace(new RegExp(/"/g),""),b[0]=b[0].replace("##0.###","##0.000"),b[0]=b[0].replace("##0.##","##0.00"),b[0]=b[0].replace("##0.#","##0.0"),b[0]=b[0].replace("##0,###","##0,000"),b[0]=b[0].replace("##0,##","##0,00"),b[0]=b[0].replace("##0,#","##0,0")),a.mask=b[0]}-1!==a.mask.indexOf("\\")&&((b=a.mask.split(";"))[0]=b[0].replace(new RegExp(/\\/g),""),a.mask=b[0]),a.type||(a.type=C.call(a,a.mask)),a.tokens=y.call(a,a.mask)}if("object"!=typeof e||!e.inputType||!e.inputType.indexOf("insert")||!e.inputType.indexOf("delete"))if(a.locale)if(a.input)u.call(a,a.input,e);else var j=c.call(a,a.value);else{for(a.methods=w.call(a,a.tokens),a.event=e;a.position<a.value.length&&void 0!==a.tokens[a.index];)E.call(a);if(j=a.values.join(""),i(a.type)&&""!==j){for(;void 0!==a.tokens[a.index];)(r=x.call(a,a.tokens[a.index]))&&"general"==r.type&&(a.values[a.index]=a.tokens[a.index]),a.index++;var v=!0}else v=!1;if(j=a.values.join(""),a.input){if((r=j.length-a.value.length)>0)var A=a.caret+r;else A=a.caret;h.call(a.input,j,A,v)}}if(a.input){var M=null;if(i(a.type)){let e=h.call(a.input);a.number=d.call(a,e),M="percentage"==a.type&&-1!==(""+e).indexOf("%")?L.adjustPrecision(a.number/100):a.number}else"datetime"==a.type&&(M=n.call(a),a.date[0]&&a.date[1]&&a.date[2]&&a.input.setAttribute("data-completed",!0));M&&a.input.setAttribute("data-value",M)}if(void 0!==j)return o?a:j}};return L.adjustPrecision=function(e){if("number"==typeof e&&!Number.isInteger(e)){const t=e.toString().split(".");if(t[1]&&t[1].length>10){let n=0;const o=t[1][t[1].length-2];if(0==o||9==o){for(let e=t[1].length-2;e>0;e--){if(!(n>=0&&t[1][e]==o)){n=0;break}if(n++,n>6)break}if(n)return parseFloat(parseFloat(e).toFixed(t[1].length-1))}}}return e},L.getType=C,L.prepare=function(e,t){return t||(t={}),y.call(t,e)},L.apply=function(e){var t=h.call(e.target);1==e.key.length&&(t+=e.key),h.call(e.target,L(t,e.target.getAttribute("data-mask")))},L.run=function(e,t,n){return L(e,{mask:t,decimal:n})},L.extract=function(e,t,n){if(r(e))return e;if("object"!=typeof t)return e;if((t=Object.assign({},t)).options||(t.options={}),!t.mask&&t.format&&(t.mask=t.format),t.mask){if(-1!==t.mask.indexOf(";")){var i=t.mask.split(";");t.mask=i[0]}t.mask=t.mask.replace(new RegExp(/\[h]/),"|h|"),t.mask=t.mask.replace(new RegExp(/\[.*?\]/),""),t.mask=t.mask.replace(new RegExp(/\|h\|/),"[h]")}s.call(t,t.mask);var a=null,c=null;if("percent"==t.type||"percent"==t.options.style?a="percentage":t.mask&&(a=C.call(t,t.mask)),"general"===a){var u=L(e,t,!0);c=e}else"datetime"===a?(e instanceof Date&&(e=L.getDateString(e,t.mask)),u=L(e,t,!0),c=l.isNumeric(e)?e:o.call(u)):"scientific"===a?(c=e,"string"==typeof e&&(c=Number(c)),u=t):(c=d.call(t,e),"percentage"===a&&-1!==(""+e).indexOf("%")&&(c/=100),u=t);return u.value=c,!u.type&&a&&(u.type=a),n?u:c},L.render=function(t,n,o,i){if(r(t))return t;if("object"!=typeof n)return t;if((n=Object.assign({},n)).options||(n.options={}),!n.mask&&n.format&&(n.mask=n.format),n.mask){if(-1!==n.mask.indexOf(";")){var l=n.mask.split(";");o||(l[0]=l[0].replace(new RegExp(/_\)/g),""),l[0]=l[0].replace(new RegExp(/_\(/g),"")),n.mask=l[0]}n.mask=n.mask.replace(new RegExp(/\[h]/),"|h|"),n.mask=n.mask.replace(new RegExp(/\[.*?\]/),""),n.mask=n.mask.replace(new RegExp(/\|h\|/),"[h]")}var a=null;"percent"==n.type||"percent"==n.options.style?a="percentage":n.mask?a=C.call(n,n.mask):t instanceof Date&&(a="datetime");var c=!1;if("datetime"==a||"calendar"==n.type)(l=L.getDateString(t,n.mask))&&(t=l),n.mask&&o&&(c=!0);else if("string"==typeof t&&e.isNumeric(t)&&(t=Number(t)),"percentage"===a&&(t=L.adjustPrecision(100*t)),"number"==typeof t){if(l=null,n.mask&&o){var u=s.call(n,n.mask);if("scientific"===a)if(-1!==n.mask.indexOf(u)){let e=n.mask.split("E");e=e[0].split(u),e=""+e[1].match(/[0-9]+/g),e=e.length,l=t.toExponential(e)}else l=t.toExponential(0);else{if(-1!==n.mask.indexOf(u)){u=(u=""+(u=n.mask.split(u))[1].match(/[0-9]+/g)).length,l=t.toFixed(u);let e=t.toString().split("."),o=e[1];o&&o.length>u&&"5"===o[o.length-1]&&(l=parseFloat(e[0]+"."+o+"1").toFixed(u))}else-1!==t.toString().indexOf(u)&&(l=t.toFixed(0));-1!==(""+l).indexOf("e")&&(l=A(l))}}else if(n.locale&&o){if(u=(""+t).split("."),n.options){void 0===u[1]&&(u[1]="");var d=u[1].length;if(n.options.minimumFractionDigits>d)for(var p=0;p<n.options.minimumFractionDigits-d;p++)u[1]+="0"}l=u[1].length?u.join("."):u[0],d=u[1].length,n.options&&n.options.maximumFractionDigits<d&&(l=parseFloat(l).toFixed(n.options.maximumFractionDigits))}else l=A(t);null!==l&&(t=l,s.call(n,n.mask),n.options.decimal&&(t=t.replace(".",n.options.decimal)))}else n.mask&&o&&(c=!0);if(c){var f=n.mask.length-t.length;if(f>0)for(p=0;p<f;p++)t+=" "}if("scientific"===a){if(o)return t;t=A(t)}if("numeric"===a&&!1===i&&"string"==typeof t)return t;if(t=L(t,n),o&&"numeric"===a){var h=n.mask.match(new RegExp(/^[0]+$/gm));if(h&&1===h.length){var g=h[0].length;if(g>3)for(t=""+t;t.length<g;)t="0"+t}}return t},L.set=function(e,t){if(t){e.setAttribute("data-mask",t);var n=new Event("input",{bubbles:!0,cancelable:!0});e.dispatchEvent(n)}},L.extractDateFromString=function(e,t){var n=L(e,{mask:t},!0);if(e>0&&Number(e)==e&&(n.values.join("")!==n.value||"numeric"==n.type)){var o=new Date(Math.round(86400*(e-25569)*1e3));return o.getFullYear()+"-"+l.two(o.getMonth())+"-"+l.two(o.getDate())+" 00:00:00"}var r=!1;return n.values&&n.values.length===n.tokens.length&&n.values[n.values.length-1].length>=n.tokens[n.tokens.length-1].length&&(r=!0),n.date[0]&&n.date[1]&&(n.date[2]||r)?(n.date[2]||(n.date[2]=1),n.date[0]+"-"+l.two(n.date[1])+"-"+l.two(n.date[2])+" "+l.two(n.date[3])+":"+l.two(n.date[4])+":"+l.two(n.date[5])):""},L.getDateString=function(e,t){if(t||(t={}),t&&"object"==typeof t)if(t.format)var n=t.format;else t.mask&&(n=t.mask);else n=t;if(n||(n="YYYY-MM-DD"),n.indexOf("[h]")>=0){var o=0;if(e&&l.isNumeric(e)&&(o=parseFloat(24*Number(e)),n.indexOf("mm")>=0)){var r=(""+o).split(".");if(r[1]){var i=60*parseFloat("0."+r[1]);i=parseFloat(i.toFixed(2))}else i=0;o=parseInt(r[0])+":"+l.two(i)}return o}e instanceof Date?e=p.now(e):e&&l.isNumeric(e)&&(e=p.numToDate(e));for(var s=new RegExp(["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."].join("|"),"gi"),a=n.match(s),c=0;c<a.length;c++)"MM"==a[c].toUpperCase()&&(a[c-1]&&a[c-1].toUpperCase().indexOf("H")>=0||a[c-2]&&a[c-2].toUpperCase().indexOf("H")>=0||a[c+1]&&a[c+1].toUpperCase().indexOf("S")>=0||a[c+2]&&a[c+2].toUpperCase().indexOf("S")>=0)&&(a[c]="mi");var u={tokens:a};if(e){var d=-1!==(i=""+e).indexOf("T")?"T":" ";r=0;var f=0,h=0;(i=i.split(d))[1]&&(f=(r=i[1].split(":"))[1]?r[1]:0,h=r[2]?r[2]:0,r=r[0]?r[0]:0),i=i[0].split("-");let t=new Date(i[0],i[1],0).getDate();if(i[0]&&i[1]&&i[2]&&i[0]>0&&i[1]>0&&i[1]<13&&i[2]>0&&i[2]<=t){u.data=[i[0],i[1],i[2],r,f,h],u.value=[];var g=new Date(u.data[0],u.data[1]-1,u.data[2],u.data[3],u.data[4],u.data[5]),m=function(e){var t=this.tokens[e],n=t.toUpperCase(),o=null;"YYYY"===n?o=this.data[0]:"YYY"===n?o=this.data[0].substring(1,4):"YY"===n?o=this.data[0].substring(2,4):"Y"===n?o=this.data[0].substring(3,4):"MON"===t?o=p.months[g.getMonth()].substr(0,3).toUpperCase():"mon"===t?o=p.months[g.getMonth()].substr(0,3).toLowerCase():"MONTH"===t?o=p.months[g.getMonth()].toUpperCase():"month"===t?o=p.months[g.getMonth()].toLowerCase():"MMMMM"===n?o=p.months[g.getMonth()].substr(0,1):"MMMM"===n||"Month"===t?o=p.months[g.getMonth()]:"MMM"===n||"Mon"==t?o=p.months[g.getMonth()].substr(0,3):"MM"===n?o=l.two(this.data[1]):"M"===n?o=g.getMonth()+1:"DAY"===t?o=p.weekdays[g.getDay()].toUpperCase():"day"===t?o=p.weekdays[g.getDay()].toLowerCase():"DDDD"===n||"Day"==t?o=p.weekdays[g.getDay()]:"DDD"===n?o=p.weekdays[g.getDay()].substr(0,3):"DD"===n?o=l.two(this.data[2]):"D"===n?o=parseInt(this.data[2]):"Q"===n?o=Math.floor((g.getMonth()+3)/3):"HH24"===n||"HH"===n?((o=this.data[3])>12&&-1!==this.tokens.indexOf("am/pm")&&(o-=12),o=l.two(o)):"HH12"===n?o=this.data[3]>12?l.two(this.data[3]-12):l.two(this.data[3]):"H"===n?(o=this.data[3])>12&&-1!==this.tokens.indexOf("am/pm")&&(o-=12,o=l.two(o)):"MI"===n?o=l.two(this.data[4]):"SS"===n?o=l.two(this.data[5]):"MS"===n?o=g.getMilliseconds():"AM/PM"===n?o=this.data[3]>=12?"PM":"AM":"WD"===n&&(o=p.weekdays[g.getDay()]),this.value[e]=null===o?this.tokens[e]:o};for(c=0;c<u.tokens.length;c++)m.call(u,c);e=u.value.join("")}else e=""}return e},L}();var h=function(){var e=function(o,r){if(o.calendar)return o.calendar.setOptions(r,!0);var i={type:"calendar",options:{},date:null,setOptions:function(n,r){var s={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:p.monthsShort,monthsFull:p.months,weekdays:p.weekdays,textDone:t.translate("Done"),textReset:t.translate("Reset"),textUpdate:t.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var a in s)n&&n.hasOwnProperty(a)?i.options[a]=n[a]:void 0!==i.options[a]&&!0!==r||(i.options[a]=s[a]);if(0==i.options.resetButton?f.style.display="none":f.style.display="",i.options.readonly?o.setAttribute("readonly","readonly"):o.removeAttribute("readonly"),i.options.placeholder?o.setAttribute("placeholder",i.options.placeholder):o.removeAttribute("placeholder"),l.isNumeric(i.options.value)&&i.options.value>0&&(i.options.value=e.numToDate(i.options.value),i.options.dataType="numeric"),f.innerHTML=i.options.textReset,h.innerHTML=i.options.textDone,E.innerHTML=i.options.textUpdate,i.options.format&&o.setAttribute("data-mask",i.options.format.toLowerCase()),!i.options.value&&i.options.today)var c=e.now();else c=i.options.value;return c&&(i.options.value=null,i.setValue(c)),i},open:function(t){if(!u.classList.contains("jcalendar-focus")&&!u.classList.contains("jcalendar-inline")){if(e.current=i,n(i,!0),i.getDays(),"year-month-picker"==i.options.type&&i.getMonths(),i.options.time&&(A.value=i.date[3],L.value=i.date[4]),u.classList.add("jcalendar-focus"),l.getWindowWidth()<800||i.options.fullscreen)u.classList.add("jcalendar-fullsize"),d.slideBottom(m,1);else{u.classList.remove("jcalendar-fullsize");var r=o.getBoundingClientRect(),s=m.getBoundingClientRect();if(i.options.position)g.style.position="fixed",window.innerHeight<r.bottom+s.height?g.style.top=r.top-(s.height+2)+"px":g.style.top=r.top+r.height+2+"px",g.style.left=r.left+"px";else{if(window.innerHeight<r.bottom+s.height){var a=-1*(r.height+s.height+2);a+r.top<0&&(a=-1*(r.top+r.height)),g.style.top=a+"px"}else g.style.top="2px";window.innerWidth<r.left+s.width?(a=window.innerWidth-(r.left+s.width+20),g.style.left=a+"px"):g.style.left="0px"}}"function"==typeof i.options.onopen&&i.options.onopen(o)}},close:function(t,r){if(!0!==i.options.autoSelect&&void 0===r&&(r=!1),u.classList.contains("jcalendar-focus")){if(!1!==r){var l=u.querySelector(".jcalendar-selected");if("string"==typeof r)var s=r;else s=!l||l.classList.contains("jcalendar-disabled")?i.options.value:i.getValue();i.setValue(s)}else{let e=i.options.value||"";i.options.value=null,i.setValue(e)}t||"function"!=typeof i.options.onclose||i.options.onclose(o),u.classList.remove("jcalendar-focus"),n(i,!1),e.current=null}return i.options.value},prev:function(){"years"==i.options.mode?(i.date[0]=i.date[0]-12,i.getYears()):"months"==i.options.mode?(i.date[0]=parseInt(i.date[0])-1,i.getMonths()):(i.date[1]<2?(i.date[0]=i.date[0]-1,i.date[1]=12):i.date[1]=i.date[1]-1,i.getDays())},next:function(){"years"==i.options.mode?(i.date[0]=parseInt(i.date[0])+12,i.getYears()):"months"==i.options.mode?(i.date[0]=parseInt(i.date[0])+1,i.getMonths()):(i.date[1]>11?(i.date[0]=parseInt(i.date[0])+1,i.date[1]=1):i.date[1]=parseInt(i.date[1])+1,i.getDays())},setToday:function(){var e=(new Date).toISOString().substr(0,10);return i.setValue(e),e},setValue:function(n){n||(n=""+n);var r=n,l=i.options.value;if(l!=r){if(r){i.setLabel(r,i.options);var s=r.split(" ");s[1]||(s[1]="00:00:00");var a=s[1].split(":"),c=(s=s[0].split("-"),parseInt(s[0])),u=parseInt(s[1]),d=parseInt(s[2]),p=parseInt(a[0]),f=parseInt(a[1]);i.date=[c,u,d,p,f,0],n=i.setLabel(r,i.options);var h=e.now(new Date(c,u-1,d),!0);if(i.options.validRange){if(!i.options.validRange[0]||h>=i.options.validRange[0])var g=!0;else g=!1;if(!i.options.validRange[1]||h<=i.options.validRange[1])var m=!0;else m=!1;g&&m?(o.classList.remove("jcalendar_warning"),o.title=""):(o.classList.add("jcalendar_warning"),o.title=t.translate("Date outside the valid range"))}else o.classList.remove("jcalendar_warning"),o.title=""}else i.date=null,n="",o.classList.remove("jcalendar_warning"),o.title="";i.options.value=r,"function"==typeof i.options.onchange&&i.options.onchange(o,r,l),o.value!=n&&(o.value=n,"function"==typeof o.oninput&&o.oninput({type:"input",target:o,value:o.value}))}i.date&&(i.getDays(),"year-month-picker"==i.options.type&&i.getMonths())},getValue:function(){return i.date?i.options.time?l.two(i.date[0])+"-"+l.two(i.date[1])+"-"+l.two(i.date[2])+" "+l.two(i.date[3])+":"+l.two(i.date[4])+":"+l.two(0):l.two(i.date[0])+"-"+l.two(i.date[1])+"-"+l.two(i.date[2])+" "+l.two(0)+":"+l.two(0)+":"+l.two(0):""},update:function(e,t){if(e.classList.contains("jcalendar-disabled"));else{var n=u.querySelector(".jcalendar-selected");n&&n.classList.remove("jcalendar-selected"),e.classList.add("jcalendar-selected"),e.classList.contains("jcalendar-set-month")?(i.date[1]=t,i.date[2]=1):i.date[2]=e.innerText,i.options.time?(i.date[3]=A.value,i.date[4]=L.value):i.close(null,!0)}c()},reset:function(){i.setValue(""),i.date=null,i.close(!1,!1)},getDays:function(){i.options.mode="days";var t=new Date,n=i.date&&l.isNumeric(i.date[0])?i.date[0]:parseInt(t.getFullYear()),o=i.date&&l.isNumeric(i.date[1])?i.date[1]:parseInt(t.getMonth())+1,r=i.date&&l.isNumeric(i.date[2])?i.date[2]:parseInt(t.getDate()),s=i.date&&l.isNumeric(i.date[3])?i.date[3]:parseInt(t.getHours()),a=i.date&&l.isNumeric(i.date[4])?i.date[4]:parseInt(t.getMinutes());i.date=[n,o,r,s,a,0],b.innerHTML=n,j.innerHTML=i.options.months[o-1];var u=t.getMonth()==o-1&&t.getFullYear()==n,d=t.getDate(),p=(t=new Date(n,o,0,0,0)).getDate(),f=(t=new Date(n,o-1,0,0,0)).getDay()+1,h=i.options.startingDay||0;f-=h,y.innerHTML="";var g=document.createElement("tr");g.setAttribute("align","center"),y.appendChild(g);for(var m=0;m<7;m++){var v=document.createElement("td");v.classList.add("jcalendar-weekday"),v.innerHTML=i.options.weekdays[h].substr(0,1),g.appendChild(v),++h>6&&(h=0)}h=0;for(var x=0,C=0;C<6;C++){for((g=document.createElement("tr")).setAttribute("align","center"),g.style.height="34px",m=0;m<7;m++){if((v=document.createElement("td")).classList.add("jcalendar-set-day"),h>=f&&h<f+p){x++,v.innerHTML=x,x==r&&v.classList.add("jcalendar-selected"),u&&d==x&&(v.style.fontWeight="bold");var E=e.now(new Date(n,o-1,x),!0);if(i.options.validRange){if(!i.options.validRange[0]||E>=i.options.validRange[0])var A=!0;else A=!1;if(!i.options.validRange[1]||E<=i.options.validRange[1])var L=!0;else L=!1;A&&L||v.classList.add("jcalendar-disabled")}}g.appendChild(v),h++}y.appendChild(g)}i.options.time?w.style.display="":w.style.display="none",c()},getMonths:function(){i.options.mode="months";var e=i.options.months,t=(i.options.value,new Date),n=parseInt(t.getFullYear()),o=parseInt(t.getMonth())+1,r=i.date&&l.isNumeric(i.date[0])?i.date[0]:n,s=i.date&&l.isNumeric(i.date[1])?i.date[1]:o;b.innerHTML=i.date[0],j.innerHTML=e[s-1];var a=document.createElement("table");a.setAttribute("width","100%");for(var u=null,d=0;d<12;d++){d%4||((u=document.createElement("tr")).setAttribute("align","center"),a.appendChild(u));var p=document.createElement("td");if(p.classList.add("jcalendar-set-month"),p.setAttribute("data-value",d+1),p.innerText=e[d],i.options.validRange){var f=r+"-"+l.two(d+1);if(!i.options.validRange[0]||f>=i.options.validRange[0].substr(0,7))var h=!0;else h=!1;if(!i.options.validRange[1]||f<=i.options.validRange[1].substr(0,7))var g=!0;else g=!1;h&&g||p.classList.add("jcalendar-disabled")}d+1==s&&p.classList.add("jcalendar-selected"),n==r&&d+1==o&&(p.style.fontWeight="bold"),u.appendChild(p)}y.innerHTML='<tr><td colspan="7"></td></tr>',y.children[0].children[0].appendChild(a),c()},getYears:function(){i.options.mode="years";for(var e=new Date,t=e.getFullYear(),n=i.date&&l.isNumeric(i.date[0])?i.date[0]:parseInt(e.getFullYear()),o=[],r=0;r<25;r++)o[r]=parseInt(i.date[0])+(r-12);var s=document.createElement("table");for(s.setAttribute("width","100%"),r=0;r<25;r++){if(!(r%5)){var a=document.createElement("tr");a.setAttribute("align","center"),s.appendChild(a)}var u=document.createElement("td");u.classList.add("jcalendar-set-year"),u.innerText=o[r],n==o[r]&&u.classList.add("jcalendar-selected"),t==o[r]&&(u.style.fontWeight="bold"),a.appendChild(u)}y.innerHTML='<tr><td colspan="7"></td></tr>',y.firstChild.firstChild.appendChild(s),c()},setLabel:function(t,n){return e.getDateString(t,n)},fromFormatted:function(t,n){return e.extractDateFromString(t,n)}},s=function(e){if(l.findElement(e.target,"jcalendar-container")){var t=e.target.className;if("jcalendar-prev"==t)i.prev();else if("jcalendar-next"==t)i.next();else if("jcalendar-month"==t)i.getMonths();else if("jcalendar-year"==t)i.getYears();else if("jcalendar-set-year"==t)i.date[0]=e.target.innerText,"year-month-picker"==i.options.type?i.getMonths():i.getDays();else if(e.target.classList.contains("jcalendar-set-month")){var n=parseInt(e.target.getAttribute("data-value"));"year-month-picker"==i.options.type?i.update(e.target,n):(i.date[1]=n,i.getDays())}else"jcalendar-confirm"==t||"jcalendar-update"==t||"jcalendar-close"==t?i.close(null,!0):"jcalendar-backdrop"==t?i.close(!1,!1):"jcalendar-reset"==t?i.reset():e.target.classList.contains("jcalendar-set-day")&&e.target.innerText&&i.update(e.target)}else i.close(!1,!1)},a=function(t){if(t.target.value&&t.target.value.length>3){var n=e.extractDateFromString(t.target.value,i.options.format);n&&i.setValue(n)}},c=function(){var e=u.querySelector(".jcalendar-selected");e&&e.classList.contains("jcalendar-disabled")?(E.setAttribute("disabled","disabled"),A.setAttribute("disabled","disabled"),L.setAttribute("disabled","disabled")):(E.removeAttribute("disabled"),A.removeAttribute("disabled"),L.removeAttribute("disabled")),"function"==typeof i.options.onupdate&&i.options.onupdate(o,i.getValue())},u=null,f=null,h=null,g=null,m=null,b=null,j=null,v=null,y=null,x=null,w=null,C=null,E=null,A=null,L=null;return function(){"INPUT"==o.tagName&&o.value&&(r.value=o.value),(f=document.createElement("div")).className="jcalendar-reset",(h=document.createElement("div")).className="jcalendar-confirm",(x=document.createElement("div")).className="jcalendar-controls",x.style.borderBottom="1px solid #ddd",x.appendChild(f),x.appendChild(h),(g=document.createElement("div")).className="jcalendar-container",(m=document.createElement("div")).className="jcalendar-content",g.appendChild(m),"DIV"==o.tagName?(u=o).classList.add("jcalendar-inline"):(m.appendChild(x),(u=document.createElement("div")).className="jcalendar"),u.classList.add("jcalendar-container"),u.appendChild(g);var t=document.createElement("div");t.className="jcalendar-table",m.appendChild(t);var n=document.createElement("td");n.setAttribute("colspan","2"),n.className="jcalendar-prev",(b=document.createElement("span")).className="jcalendar-year",(j=document.createElement("span")).className="jcalendar-month";var c=document.createElement("td");c.className="jcalendar-header",c.setAttribute("colspan","3"),c.appendChild(j),c.appendChild(b);var p=document.createElement("td");p.setAttribute("colspan","2"),p.className="jcalendar-next";var M=document.createElement("thead"),N=document.createElement("tr");N.appendChild(n),N.appendChild(c),N.appendChild(p),M.appendChild(N),v=document.createElement("table"),y=document.createElement("tbody"),v.setAttribute("cellpadding","0"),v.setAttribute("cellspacing","0"),v.appendChild(M),v.appendChild(y),t.appendChild(v),(A=document.createElement("select")).className="jcalendar-select",A.onchange=function(){i.date[3]=this.value,"function"==typeof i.options.onupdate&&i.options.onupdate(o,i.getValue())};for(var I=0;I<24;I++){var T=document.createElement("option");T.value=I,T.innerHTML=l.two(I),A.appendChild(T)}for((L=document.createElement("select")).className="jcalendar-select",L.onchange=function(){i.date[4]=this.value,"function"==typeof i.options.onupdate&&i.options.onupdate(o,i.getValue())},I=0;I<60;I++)(T=document.createElement("option")).value=I,T.innerHTML=l.two(I),L.appendChild(T);var D=document.createElement("div");D.className="jcalendar-controls",(w=document.createElement("div")).className="jcalendar-time",w.style.maxWidth="140px",w.appendChild(A),w.appendChild(L),(E=document.createElement("button")).setAttribute("type","button"),E.className="jcalendar-update",(C=document.createElement("div")).style.flexGrow="10",C.appendChild(E),D.appendChild(w),"INPUT"==o.tagName&&D.appendChild(C),m.appendChild(D);var S=document.createElement("div");S.className="jcalendar-backdrop",u.appendChild(S),o.addEventListener("keyup",a),u.addEventListener("swipeleft",(function(e){d.slideLeft(v,0,(function(){i.next(),d.slideRight(v,1)})),e.preventDefault(),e.stopPropagation()})),u.addEventListener("swiperight",(function(e){d.slideRight(v,0,(function(){i.prev(),d.slideLeft(v,1)})),e.preventDefault(),e.stopPropagation()})),"ontouchend"in document.documentElement==1?(u.addEventListener("touchend",s),o.addEventListener("touchend",i.open)):(u.addEventListener("mouseup",s),o.addEventListener("mouseup",i.open)),e.hasEvents||(e.hasEvents=!0,document.addEventListener("keydown",e.keydown)),i.setOptions(r),"INPUT"==o.tagName?(o.parentNode.insertBefore(u,o.nextSibling),o.setAttribute("autocomplete","off"),o.classList.add("jcalendar-input"),o.value=i.setLabel(i.getValue(),i.options)):(i.getDays(),i.options.time&&(A.value=i.date[3],L.value=i.date[4])),1==i.options.opened&&i.open(),0==i.options.controls&&g.classList.add("jcalendar-hide-controls"),o.change=i.setValue,o.val=function(e){if(void 0===e)return i.getValue();i.setValue(e)},o.calendar=u.calendar=i}(),i};return e.keydown=function(t){var n=null;(n=e.current)&&(13==t.which?n.close(!1,!0):27==t.which&&n.close(!1,!1))},e.prettify=function(e,t){t||(t={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"}),-1===e.indexOf("GMT")&&-1===e.indexOf("Z")&&(e+=" GMT");var n=new Date,o=new Date(e),r=parseInt((n-o)/1e3/60);if(String.prototype.format=function(e){return this.replace("{0}",e)},0==r)var i=t.justNow;else i=r<90?t.xMinutesAgo.format(r):r<1440?t.xHoursAgo.format(Math.round(r/60)):r<20160?t.xDaysAgo.format(Math.round(r/1440)):r<43200?t.xWeeksAgo.format(Math.round(r/10080)):r<1036800?t.xMonthsAgo.format(Math.round(r/43200)):t.xYearsAgo.format(Math.round(r/525600));return i},e.prettifyAll=function(){for(var t=document.querySelectorAll(".prettydate"),n=0;n<t.length;n++)t[n].getAttribute("data-date")?t[n].innerHTML=e.prettify(t[n].getAttribute("data-date")):t[n].innerHTML&&(t[n].setAttribute("title",t[n].innerHTML),t[n].setAttribute("data-date",t[n].innerHTML),t[n].innerHTML=e.prettify(t[n].innerHTML))},e.now=p.now,e.toArray=p.toArray,e.dateToNum=p.dateToNum,e.numToDate=p.numToDate,e.weekdays=p.weekdays,e.months=p.months,e.weekdaysShort=p.weekdaysShort,e.monthsShort=p.monthsShort,e.extractDateFromString=f.extractDateFromString,e.getDateString=f.getDateString,e}();var g=function(){var e={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},t=function(t){return e[t]?e[t]:e.material};return t.get=function(t){return e[t]?e[t]:e},t.set=function(t,n){e[t]=n},t}();function m(e,t){var n={options:{}},o={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var r in o)t&&t.hasOwnProperty(r)?n.options[r]=t[r]:n.options[r]=o[r];e.classList.add("jtabs");var i=null,l=null,s=null;const c=function(e){n.options.animation&&setTimeout((function(){let t=n.headers.children[e].getBoundingClientRect();"modern"===n.options.palette?(s.style.width=t.width-4+"px",s.style.left=n.headers.children[e].offsetLeft+2+"px"):(s.style.width=t.width+"px",s.style.left=n.headers.children[e].offsetLeft+"px"),"bottom"===n.options.position?s.style.top="0px":s.style.bottom="0px"}),50)};var d=function(e){"function"==typeof n.headers.scrollTo?n.headers.scrollTo({left:e,behavior:"smooth"}):n.headers.scrollLeft=e,e<=1?i.classList.add("disabled"):i.classList.remove("disabled"),e>=n.headers.scrollWidth-n.headers.offsetWidth?l.classList.add("disabled"):l.classList.remove("disabled"),n.headers.scrollWidth<=n.headers.offsetWidth?(i.style.display="none",l.style.display="none"):(i.style.display="",l.style.display="")};if(n.setBorder=c,n.open=function(t){if(Array.from(n.content.children),n.content.children[t]){for(var o=null,r=0;r<n.headers.children.length;r++)n.headers.children[r].classList.contains("jtabs-selected")&&(o=r),n.headers.children[r].classList.remove("jtabs-selected"),n.content.children[r]&&n.content.children[r].classList.remove("jtabs-selected");if(n.headers.children[t].classList.add("jtabs-selected"),n.content.children[t]&&n.content.children[t].classList.add("jtabs-selected"),o!=t&&"function"==typeof n.options.onchange&&n.content.children[t]&&n.options.onchange(e,n,t,n.headers.children[t],n.content.children[t]),1==n.options.hideHeaders&&n.headers.children.length<3&&0==n.options.allowCreate)n.headers.parentNode.style.display="none";else{n.headers.parentNode.style.display="";var i=n.headers.children[t].offsetLeft,l=i+n.headers.children[t].offsetWidth,s=n.headers.scrollLeft,a=s+n.headers.offsetWidth;s<=i&&a>=l||d(i-1),c(t)}}},n.selectIndex=function(e){var t=Array.prototype.indexOf.call(n.headers.children,e);return t>=0&&n.open(t),t},n.rename=function(e,t){t||(t=prompt("New title",n.headers.children[e].innerText)),n.headers.children[e].innerText=t,c(n.getActive())},n.create=function(t,o){if("function"==typeof n.options.onbeforecreate){var r=n.options.onbeforecreate(e);if(!1===r)return!1;t=r}var i=n.appendElement(t);return"function"==typeof n.options.oncreate&&n.options.oncreate(e,i),c(n.getActive()),i},n.remove=function(e){return n.deleteElement(e)},n.nextNumber=function(){for(var e=0,t=0;t<n.headers.children.length;t++){var o=n.headers.children[t].innerText.match(/[0-9].*/);o>e&&(e=parseInt(o))}return e?e++:e=1,e},n.deleteElement=function(t){let o=n.getActive();if(!n.headers.children[t])return!1;if(n.headers.removeChild(n.headers.children[t]),n.content.removeChild(n.content.children[t]),o===t)n.open(0);else{let e=n.getActive()||0;c(e)}"function"==typeof n.options.ondelete&&n.options.ondelete(e,t)},n.appendElement=function(e,t,o,r){if(e||(e=prompt("Title?","")),e){var i=document.createElement("div"),l=document.createElement("div");if(l.innerHTML=e,l.content=i,void 0===r)n.content.appendChild(i),n.headers.insertBefore(l,n.headers.lastChild);else{let e=n.content.children[r];e?n.content.insertBefore(i,e):n.content.appendChild(i),e=n.headers.children[r]||n.headers.lastChild,n.headers.insertBefore(l,e)}return n.options.allowChangePosition&&l.setAttribute("draggable","true"),!1!==o&&n.selectIndex(l),"function"==typeof t&&t(i,l),i}},n.getActive=function(){for(var e=0;e<n.headers.children.length;e++)if(n.headers.children[e].classList.contains("jtabs-selected"))return e;return!1},n.updateContent=function(e,t){"string"!=typeof t||(document.createElement("div").innerHTML=t),n.content.children[e].classList.contains("jtabs-selected")&&t.classList.add("jtabs-selected"),n.content.replaceChild(t,n.content.children[e]),c()},n.updatePosition=function(e,t,o,r){if(e>t?n.content.insertBefore(n.content.children[e],n.content.children[t]):n.content.insertBefore(n.content.children[e],n.content.children[t].nextSibling),!1!==r)n.open(t);else{const e=n.getActive();t<e&&n.setBorder(e)}o||"function"!=typeof n.options.onchangeposition||n.options.onchangeposition(n.headers,e,t)},n.move=function(e,t,o,r){e>t?n.headers.insertBefore(n.headers.children[e],n.headers.children[t]):n.headers.insertBefore(n.headers.children[e],n.headers.children[t].nextSibling),n.updatePosition(e,t,o,r)},n.setBorder=c,n.init=function(){e.innerHTML="",n.headers=document.createElement("div"),n.content=document.createElement("div"),n.headers.classList.add("jtabs-headers"),n.content.classList.add("jtabs-content"),n.options.palette?e.classList.add("jtabs-modern"):e.classList.remove("jtabs-modern"),n.options.padding&&(n.content.style.padding=parseInt(n.options.padding)+"px");var t=document.createElement("div");t.className="jtabs-headers-container",t.appendChild(n.headers),n.options.maxWidth&&(t.style.maxWidth=parseInt(n.options.maxWidth)+"px");var o=document.createElement("div");if(o.className="jtabs-controls",o.setAttribute("draggable","false"),t.appendChild(o),"bottom"==n.options.position?(e.appendChild(n.content),e.appendChild(t)):(e.appendChild(t),e.appendChild(n.content)),1==n.options.allowCreate){var r=document.createElement("div");r.className="jtabs-add",r.onclick=function(){n.create()},o.appendChild(r)}(i=document.createElement("div")).className="jtabs-prev",i.onclick=function(){d(n.headers.scrollLeft-n.headers.offsetWidth)},o.appendChild(i),(l=document.createElement("div")).className="jtabs-next",l.onclick=function(){d(n.headers.scrollLeft+n.headers.offsetWidth)},o.appendChild(l);for(var c=0;c<n.options.data.length;c++){if(n.options.data[c].titleElement)var u=n.options.data[c].titleElement;else u=document.createElement("div");if(n.options.data[c].icon){var p=document.createElement("div"),f=document.createElement("i");f.classList.add("material-icons"),f.innerHTML=n.options.data[c].icon,p.appendChild(f),u.appendChild(p)}if(n.options.data[c].title){var h=document.createTextNode(n.options.data[c].title);u.appendChild(h)}if(n.options.data[c].width&&(u.style.width=n.options.data[c].width),n.options.data[c].contentElement)var g=n.options.data[c].contentElement;else(g=document.createElement("div")).innerHTML=n.options.data[c].content;n.headers.appendChild(u),n.content.appendChild(g)}(s=document.createElement("div")).className="jtabs-border",n.headers.appendChild(s),n.options.animation&&e.classList.add("jtabs-animation"),n.headers.addEventListener("click",(function(t){if(t.target.parentNode.classList.contains("jtabs-headers"))var o=t.target;else o="I"==t.target.tagName?t.target.parentNode.parentNode:t.target.parentNode;var r=n.selectIndex(o);"function"==typeof n.options.onclick&&n.options.onclick(e,n,r,n.headers.children[r],n.content.children[r])})),n.headers.addEventListener("contextmenu",(function(e){n.selectIndex(e.target)})),n.headers.children.length&&n.open(0),d(0),1==n.options.allowChangePosition&&a(n.headers,{direction:1,ondrop:function(e,t,o){n.updatePosition(t,o)}}),"function"==typeof n.options.onload&&n.options.onload(e,n)},e.children[0]&&e.children[0].children.length)for(var p=0;p<e.children[0].children.length;p++){var f=n.options.data&&n.options.data[p]?n.options.data[p]:{};e.children[1]&&e.children[1].children[p]?(f.titleElement=e.children[0].children[p],f.contentElement=e.children[1].children[p]):f.contentElement=e.children[0].children[p],n.options.data[p]=f}var h=!1;if(n.options.data)for(p=0;p<n.options.data.length;p++)n.options.data[p].url&&(u({url:n.options.data[p].url,type:"GET",dataType:"text/html",index:p,success:function(e){n.options.data[this.index].content=e},complete:function(){n.init()}}),h=!0);return h||n.init(),e.tabs=n,n}function b(e,t){if(e.color)return e.color.setOptions(t,!0);var o={type:"color",options:{}},r=null,i=null,s=null,a=null,c=null,u=null,p=null;o.setOptions=function(t,n){var r={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(var i in t||(t={}),t&&!t.palette&&(t.palette=g()),r)t&&t.hasOwnProperty(i)?o.options[i]=t[i]:void 0!==o.options[i]&&!0!==n||(o.options[i]=r[i]);return a&&(a.innerHTML=o.options.resetLabel),c&&(c.innerHTML=o.options.doneLabel),o.options.palette&&p&&p.updateContent(0,v()),"string"==typeof o.options.value&&(e.value=o.options.value,"INPUT"===e.tagName&&(e.style.color=e.value,e.style.backgroundColor=e.value)),o.options.placeholder?e.setAttribute("placeholder",o.options.placeholder):e.getAttribute("placeholder")&&e.removeAttribute("placeholder"),o},o.select=function(e){var t=r.querySelector(".jcolor-selected");t&&t.classList.remove("jcolor-selected"),o.values[e]&&o.values[e].classList.add("jcolor-selected"),o.options.value=e},o.open=function(){if(!r.classList.contains("jcolor-focus")){n(o,!0),r.classList.add("jcolor-focus"),o.options.value&&o.select(o.options.value),s.style.marginTop="",s.style.marginLeft="";var t=s.getBoundingClientRect(),a=l.getWindowWidth(),c=l.getWindowHeight();if(a<800||1==o.options.fullscreen?(s.classList.add("jcolor-fullscreen"),d.slideBottom(s,1),i.style.display="block"):(s.classList.contains("jcolor-fullscreen")&&(s.classList.remove("jcolor-fullscreen"),i.style.display=""),o.options.position?s.style.position="fixed":s.style.position="",t.left+t.width>a&&(s.style.marginLeft=-1*(t.left+t.width-(a-20))+"px"),t.top+t.height>c&&(s.style.marginTop=-1*(t.top+t.height-(c-20))+"px")),"function"==typeof o.options.onopen&&o.options.onopen(e,o),p.setBorder(p.getActive()),o.options.value){var u=j(o.options.value);L.forEach((function(e,t){e.value=u[t],e.dispatchEvent(new Event("input"))}))}}},o.close=function(t){return r.classList.contains("jcolor-focus")&&(r.classList.remove("jcolor-focus"),i.style.display="",t||"function"!=typeof o.options.onclose||o.options.onclose(e,o),n(o,!1)),o.options.value},o.setValue=function(t){t||(t=""),t!=o.options.value&&(o.options.value=t,A=t,o.select(t),"function"==typeof o.options.onchange&&o.options.onchange(e,t,o),e.value!=o.options.value&&(e.value=o.options.value,"INPUT"===e.tagName&&(e.style.color=e.value,e.style.backgroundColor=e.value),"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value})),1==o.options.closeOnChange&&o.close())},o.getValue=function(){return o.options.value};var f=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},h=function(e,t,n){return"#"+f(e)+f(t)+f(n)},b=function(e){return parseInt("0x"+e)},j=function(e){return[b(e.substr(1,2)),b(e.substr(3,2)),b(e.substr(5,2))]},v=function(){var e=document.createElement("div");e.className="jcolor-grid",o.values=[];var t=document.createElement("table");t.setAttribute("cellpadding","7"),t.setAttribute("cellspacing","0");for(var n=0;n<o.options.palette.length;n++){for(var r=document.createElement("tr"),i=0;i<o.options.palette[n].length;i++){var l=document.createElement("td"),s=o.options.palette[n][i];s.length<7&&"#"!==s.substr(0,1)&&(s="#"+s),l.style.backgroundColor=s,l.setAttribute("data-value",s),l.innerHTML="",r.appendChild(l),o.options.value==s&&l.classList.add("jcolor-selected"),o.values[s]=l}t.appendChild(r)}return e.appendChild(t),e},y=document.createElement("canvas");y.width=200,y.height=160;var x=y.getContext("2d"),w=function(){var e=u.firstChild.getBoundingClientRect();y.width=e.width-14,C()},C=function(){var e=x.createLinearGradient(0,0,y.width,0);e.addColorStop(0,"rgb(255,0,0)"),e.addColorStop(.15,"rgb(255,0,255)"),e.addColorStop(.33,"rgb(0,0,255)"),e.addColorStop(.49,"rgb(0,255,255)"),e.addColorStop(.67,"rgb(0,255,0)"),e.addColorStop(.84,"rgb(255,255,0)"),e.addColorStop(1,"rgb(255,0,0)"),x.fillStyle=e,x.fillRect(0,0,y.width,y.height),(e=x.createLinearGradient(0,0,0,y.height)).addColorStop(0,"rgba(255,255,255,1)"),e.addColorStop(.5,"rgba(255,255,255,0)"),e.addColorStop(.5,"rgba(0,0,0,0)"),e.addColorStop(1,"rgba(0,0,0,1)"),x.fillStyle=e,x.fillRect(0,0,y.width,y.height)},E=function(){var e=document.createElement("div");e.className="jcolor-hsl";var t=document.createElement("div");t.className="jcolor-point";var n=document.createElement("div");n.appendChild(y),n.appendChild(t),e.appendChild(n);var o=function(n,o,r){if(1===n){var i=e.getBoundingClientRect(),l=o-i.left,s=r-i.top;l<0&&(l=0),s<0&&(s=0),l>i.width&&(l=i.width),s>i.height&&(s=i.height),t.style.left=l+"px",t.style.top=s+"px";var a=x.getImageData(l,s,1,1).data;A=h(a[0],a[1],a[2])}};return e.addEventListener("mousedown",(function(e){o(e.buttons,e.clientX,e.clientY)})),e.addEventListener("mousemove",(function(e){o(e.buttons,e.clientX,e.clientY)})),e.addEventListener("touchmove",(function(e){o(1,e.changedTouches[0].clientX,e.changedTouches[0].clientY)})),e},A="",L=[],M=function(){var e=document.createElement("div");e.className="jcolor-sliders";var t=document.createElement("div"),n=function(e){var n=document.createElement("div");n.className="jcolor-sliders-input-container";var o=document.createElement("label");o.innerText=e;var r=document.createElement("div");r.className="jcolor-sliders-input-subcontainer";var i=document.createElement("input");i.type="range",i.min=0,i.max=255,i.value=0,n.appendChild(o),r.appendChild(i);var l=document.createElement("div");return l.innerText=i.value,i.addEventListener("input",(function(){l.innerText=i.value})),r.appendChild(l),n.appendChild(r),t.appendChild(n),i};L=[n("Red"),n("Green"),n("Blue")],e.appendChild(t);var o=document.createElement("div");o.className="jcolor-sliders-final-color";var r=document.createElement("div");r.style.visibility="hidden",r.innerText="a",o.appendChild(r);return L.forEach((function(e){e.addEventListener("input",(function(){(function(){var e=h(parseInt(L[0].value),parseInt(L[1].value),parseInt(L[2].value));r.innerText=e,r.style.color=e,r.style.removeProperty("visibility"),A=e})(),function(){if(""!==A)for(var e=0;e<L.length;e++){var t=j(A);t[e]=0;var n="linear-gradient(90deg, rgb(";n+=t.join(", "),n+="), rgb(",t[e]=255,n+=t.join(", "),n+="))",L[e].style.backgroundImage=n}}()}))})),e.appendChild(o),e};return o.toHex=function(e){var t=function(e){return("0"+parseInt(e).toString(16)).slice(-2)};if(e)return/^#[0-9A-F]{6}$/i.test(e)?e:(e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))&&e.length?"#"+t(e[1])+t(e[2])+t(e[3]):""},function(){o.setOptions(t),"INPUT"==e.tagName&&(e.classList.add("jcolor-input"),e.readOnly=!0),(r=document.createElement("div")).className="jcolor",(i=document.createElement("div")).className="jcolor-backdrop",r.appendChild(i),(s=document.createElement("div")).className="jcolor-content";var n=document.createElement("div");n.className="jcolor-controls",s.appendChild(n),(a=document.createElement("div")).className="jcolor-reset",a.innerHTML=o.options.resetLabel,n.appendChild(a),(c=document.createElement("div")).className="jcolor-close",c.innerHTML=o.options.doneLabel,n.appendChild(c),u=document.createElement("div"),s.appendChild(u),p=m(u,{animation:!0,data:[{title:"Grid",contentElement:v()},{title:"Spectrum",contentElement:E()},{title:"Sliders",contentElement:M()}],onchange:function(e,t,n){if(1===n)w();else{var r=""!==A?A:o.getValue();if(2===n&&r){var i=j(r);L.forEach((function(e,t){e.value=i[t],e.dispatchEvent(new Event("input"))}))}}},palette:"modern"}),r.appendChild(s),"INPUT"==e.tagName?e.parentNode.insertBefore(r,e.nextSibling):e.appendChild(r),r.addEventListener("click",(function(e){if("TD"==e.target.tagName){var t=e.target.getAttribute("data-value");t&&o.setValue(t)}else e.target.classList.contains("jcolor-reset")?(o.setValue(""),o.close()):e.target.classList.contains("jcolor-close")?(p.getActive()>0&&o.setValue(A),o.close()):e.target.classList.contains("jcolor-backdrop")?o.close():o.open()})),e.addEventListener("mouseup",(function(e){o.open()})),window.addEventListener("resize",(function(){r.classList.contains("jcolor-focus")&&1==p.getActive()&&w()})),1==o.options.opened&&o.open(),e.change=o.setValue,e.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},e.color=o,r.color=o}(),o}var j=function(){var e=function(o,r){var i={type:"contextmenu",options:{}},l={items:null,onclick:null};for(var s in l)r&&r.hasOwnProperty(s)?i.options[s]=r[s]:i.options[s]=l[s];function a(){var e=document.createElement("div");e.classList.add("header"),e.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation()}));var n=document.createElement("a");n.classList.add("title"),n.innerHTML=t.translate("Menu"),e.appendChild(n);var o=document.createElement("a");return o.classList.add("close"),o.innerHTML=t.translate("close"),o.addEventListener("click",(function(e){i.close()})),e.appendChild(o),e}function c(e){if(!e.type||"line"!=e.type&&"divisor"!=e.type){a=document.createElement("div");var t=document.createElement("a");if(t.innerHTML=e.title,e.tooltip&&a.setAttribute("title",e.tooltip),e.icon&&a.setAttribute("data-icon",e.icon),e.id&&(a.id=e.id),e.disabled?a.className="jcontextmenu-disabled":e.onclick&&(a.method=e.onclick,a.addEventListener("mousedown",(function(e){e.preventDefault()})),a.addEventListener("mouseup",(function(e){this.method(this,e)}))),a.appendChild(t),e.submenu){var n=document.createElement("span");n.innerHTML="&#9658;",a.appendChild(n),a.classList.add("jcontexthassubmenu");var o=document.createElement("div");o.classList.add("jcontextmenu"),o.setAttribute("tabindex","900");for(var r=e.submenu,i=0;i<r.length;i++){var l=c(r[i]);o.appendChild(l)}a.appendChild(o)}else if(e.shortcut){var s=document.createElement("span");s.innerHTML=e.shortcut,a.appendChild(s)}}else var a=document.createElement("hr");return a}return o.classList.add("jcontextmenu"),i.open=function(t,r){if(r&&(i.options.items=r,i.create(r)),e.current&&e.current.close(),n(i,!0),o.classList.add("jcontextmenu-focus"),e.current=i,i.options.items&&i.options.items.length>0||o.children.length){if(t.target)if(t.changedTouches&&t.changedTouches[0])l=t.changedTouches[0].clientX,s=t.changedTouches[0].clientY;else var l=t.clientX,s=t.clientY;else l=t.x,s=t.y;var a=o.getBoundingClientRect();if(window.innerHeight<s+a.height){var c=s-a.height;c<0&&(c=0),o.style.top=c+"px"}else o.style.top=s+"px";window.innerWidth<l+a.width?l-a.width>0?o.style.left=l-a.width+"px":o.style.left="10px":o.style.left=l+"px"}},i.isOpened=function(){return!!o.classList.contains("jcontextmenu-focus")},i.close=function(){o.classList.contains("jcontextmenu-focus")&&o.classList.remove("jcontextmenu-focus"),n(i,!1)},i.create=function(e){o.innerHTML="";var t=a();o.appendChild(t);for(var n=0;n<e.length;n++){var r=c(e[n]);o.appendChild(r)}},"function"==typeof i.options.onclick&&o.addEventListener("click",(function(e){i.options.onclick(i,e)})),i.options.items&&i.create(i.options.items),window.addEventListener("mousewheel",(function(){i.close()})),o.contextmenu=i,i};return e}();var v=function(){var e=function(o,r){if(o.dropdown)return o.dropdown.setOptions(r,!0);var i={type:"dropdown",options:{}},s=function(e,t){e&&e.length&&(!1!==i.options.sortResults&&("function"==typeof i.options.sortResults?e.sort(i.options.sortResults):e.sort(a)),i.setData(e)),"function"==typeof i.options.onload&&i.options.onload(o,i,e,t),t&&f(t),null!=t||(i.options.value=""),o.value=i.options.value,1==i.options.opened&&i.open()},a=function(e,t){var n,o;return"string"==typeof e?n=e:e.text?n=e.text:e.name&&(n=e.name),"string"==typeof t?o=t:t.text?o=t.text:t.name&&(o=t.name),"string"==typeof n||"string"==typeof o?("string"!=typeof n&&(n=""+n),"string"!=typeof o&&(o=""+o),n.localeCompare(o)):n-o},p=function(){i.value={};for(var e=0;e<i.items.length;e++)1==i.items[e].selected&&(i.items[e].element&&i.items[e].element.classList.remove("jdropdown-selected"),i.items[e].selected=null);i.options.value="",o.value=""},f=function(e){if(p(),null!==e)if(e){Array.isArray(e)||(e=(""+e).split(";"));for(var t=0;t<e.length;t++)i.value[e[t]]=""}else void 0!==i.value[""]&&(i.value[""]="");for(t=0;t<i.items.length;t++)void 0!==i.value[h(t)]&&(i.items[t].element&&i.items[t].element.classList.add("jdropdown-selected"),i.items[t].selected=!0,i.value[h(t)]=g(t));i.options.value=Object.keys(i.value).join(";"),i.header.value=i.getText()},h=function(e,t){if(i.options.format)n="id";else var n="value";return i.items[e]?void 0!==t?i.items[e].data[n]=t:i.items[e].data[n]:""},g=function(e,t){if(i.options.format)n="name";else var n="text";return i.items[e]?void 0!==t?i.items[e].data[n]=t:i.items[e].data[n]:""},m=function(){return Object.keys(i.value)},b=function(){for(var e=[],t=Object.keys(i.value),n=0;n<t.length;n++)e.push(i.value[t[n]]);return e};i.setOptions=function(e,t){e||(e={});var n={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var r in n)e&&e.hasOwnProperty(r)?i.options[r]=e[r]:void 0!==i.options[r]&&!0!==t||(i.options[r]=n[r]);return 1!=i.options.remoteSearch&&"searchbar"!==i.options.type||(i.options.autocomplete=!0),1==i.options.newOptions?i.header.classList.add("jdropdown-add"):i.header.classList.remove("jdropdown-add"),1==i.options.autocomplete?i.header.removeAttribute("readonly"):i.header.setAttribute("readonly","readonly"),i.options.placeholder?i.header.setAttribute("placeholder",i.options.placeholder):i.header.removeAttribute("placeholder"),o.classList.remove("jdropdown-searchbar"),o.classList.remove("jdropdown-picker"),o.classList.remove("jdropdown-list"),"searchbar"==i.options.type?o.classList.add("jdropdown-searchbar"):"list"==i.options.type?o.classList.add("jdropdown-list"):"picker"==i.options.type?o.classList.add("jdropdown-picker"):l.getWindowWidth()<800?i.options.autocomplete?(o.classList.add("jdropdown-searchbar"),i.options.type="searchbar"):(o.classList.add("jdropdown-picker"),i.options.type="picker"):(i.options.width?(o.style.width=i.options.width,o.style.minWidth=i.options.width):(o.style.removeProperty("width"),o.style.removeProperty("min-width")),o.classList.add("jdropdown-default"),i.options.type="default"),"searchbar"==i.options.type?j.appendChild(x):v.insertBefore(x,v.firstChild),i.options.url&&!e.data?u({url:i.options.url,method:"GET",dataType:"json",success:function(e){e&&s(e,i.options.value)}}):s(i.options.data,i.options.value),i};var j=null,v=null,y=null,x=null,w=null,C=null,E=null;i.getUrl=function(){return i.options.url},i.setUrl=function(e,t){i.options.url=e,u({url:i.options.url,method:"GET",dataType:"json",success:function(e){i.setData(e),"function"==typeof t&&t(i)}})},i.setId=function(e,t){if(i.options.format)n="id";else var n="value";"object"==typeof e?e[n]=t:i.items[e].data[n]=t};const A=function(e,n){if(!e){let n=1==i.options.autocomplete?i.header.value:"";if(!(e=prompt(t.translate("Add A New Option"),n)))return!1}if(n||(n=l.guid()),i.options.format)o={id:n,name:e};else var o={value:n,text:e};if("function"==typeof i.options.onbeforeinsert){let e=i.options.onbeforeinsert(i,o);if(!1===e)return!1;e&&(o=e)}i.options.data.push(o);var r=i.createItem(o);return y.appendChild(r.element),"function"==typeof i.options.oninsert&&i.options.oninsert(i,o,r),"none"==y.style.display&&(y.style.display=""),i.results&&i.results.push(r),o};i.add=function(e,t){return"function"==typeof i.options.prompt?i.options.prompt.call(i,A):A(e,t)},i.createItem=function(e,t,n){i.options.format?(e.id||void 0===e.value||(e.id=e.value),e.name||void 0===e.text||(e.name=e.text)):(e.value||void 0===e.id||(e.value=e.id),e.text||void 0===e.name||(e.text=e.name));var o={};if(o.element=document.createElement("div"),o.element.className="jdropdown-item",o.element.indexValue=i.items.length,o.data=e,t&&(o.group=t),e.id&&o.element.setAttribute("id",e.id),1==e.disabled&&o.element.setAttribute("data-disabled",!0),e.tooltip&&o.element.setAttribute("title",e.tooltip),e.image){var r=document.createElement("img");r.className="jdropdown-image",r.src=e.image,e.title||r.classList.add("jdropdown-image-small"),o.element.appendChild(r)}else if(e.icon){var l=document.createElement("span");l.className="jdropdown-icon material-icons",l.innerText=e.icon,e.title||l.classList.add("jdropdown-icon-small"),e.color&&(l.style.color=e.color),o.element.appendChild(l)}else if(e.color){var s=document.createElement("div");s.className="jdropdown-color",s.style.backgroundColor=e.color,o.element.appendChild(s)}if(i.options.format)a=e.name;else var a=e.text;var c=document.createElement("div");if(c.className="jdropdown-description",c.textContent=a||"&nbsp;",e.title){var u=document.createElement("div");u.className="jdropdown-title",u.innerText=e.title,c.appendChild(u)}if(i.options.format)d=e.id;else var d=e.value;return i.value[d]&&(o.element.classList.add("jdropdown-selected"),o.selected=!0),i.items.push(o),o.element.appendChild(c),o},i.appendData=function(e){if(e.length){for(var t=[],n=[],o=0;o<e.length;o++)e[o].group?(n[e[o].group]||(n[e[o].group]=[]),n[e[o].group].push(o)):t.push(o);var r=0,l=Object.keys(n);if(l.length>0)for(o=0;o<l.length;o++){var s=document.createElement("div");s.className="jdropdown-group";var a=document.createElement("div");a.className="jdropdown-group-name",a.textContent=l[o];var c=document.createElement("i");c.className="jdropdown-group-arrow jdropdown-group-arrow-down",a.appendChild(c);var u=document.createElement("div");u.className="jdropdown-group-items";for(var d=0;d<n[l[o]].length;d++){var p=i.createItem(e[n[l[o]][d]],s,l[o]);(0==i.options.lazyLoading||r<200)&&(u.appendChild(p.element),r++)}s.appendChild(a),s.appendChild(u),i.groups.push(s),u.children.length>0&&y.appendChild(s)}if(t.length)for(o=0;o<t.length;o++)p=i.createItem(e[t[o]]),(0==i.options.lazyLoading||r<200)&&(y.appendChild(p.element),r++)}},i.setData=function(e){if(p(),y.textContent="",i.header.value="",i.items=[],e&&e.length){for(var t=0;t<e.length;t++)"object"!=typeof e[t]&&(i.options.format?e[t]={id:e[t],name:e[t]}:e[t]={value:e[t],text:e[t]});i.appendData(e),i.options.data=e}else i.options.data=[];i.close()},i.getData=function(){return i.options.data},i.getPosition=function(e){for(var t=0;t<i.items.length;t++)if(h(t)==e)return t;return!1},i.getText=function(e){var t=b();return e?t:t.join("; ")},i.getValue=function(e){var t=m();return e?t:t.join(";")};var L=function(e){o.value!=i.options.value&&(o.value=i.options.value,"function"==typeof o.oninput&&o.oninput({type:"input",target:o,value:o.value})),"function"==typeof i.options.onchange&&i.options.onchange(o,i,e,i.options.value)};i.setValue=function(e){var t=i.getValue();Array.isArray(e)&&(e=e.join(";")),t!==e&&(f(e),L(t))},i.resetSelected=function(){i.setValue(null)},i.selectIndex=function(e,t){if(e=parseInt(e),i.items&&i.items[e]&&(!0===t||!0!==i.items[e].data.disabled))if(i.setCursor(e,!1),i.options.multiple){var n=i.options.value;i.items[e].selected?(i.items[e].element.classList.remove("jdropdown-selected"),i.items[e].selected=!1,delete i.value[h(e)]):(i.items[e].element.classList.add("jdropdown-selected"),i.items[e].selected=!0,i.value[h(e)]=g(e)),i.options.value=Object.keys(i.value).join(";"),0==i.options.autocomplete&&(i.header.value=b().join("; ")),L(n)}else i.items[e].selected?!1!==i.options.allowEmpty&&i.setValue(null):i.setValue(h(e)),i.close()},i.selectItem=function(e){i.selectIndex(e.indexValue)};var M=function(e,t){for(var n=0;n<t.length;n++)if(i.options.format){if(t[n].id==e)return!0}else if(t[n].value==e)return!0;return!1};return i.find=function(e){if(i.search==e.trim())return!1;if(i.search=e,i.setCursor(),i.groups.length)for(var t=0;t<i.groups.length;t++)i.groups[t].lastChild.textContent="";if(y.textContent="",1==i.options.remoteSearch){i.results=null;let t={url:i.options.url,method:"GET",data:{q:e},dataType:"json",success:function(e){i.items=[];var t=Object.keys(i.value);if(t.length)for(var n=0;n<t.length;n++)M(t[n],e)||(i.options.format?e.unshift({id:t[n],name:i.value[t[n]]}):e.unshift({value:t[n],text:i.value[t[n]]}));i.appendData(e),e.length?y.style.display="":y.style.display="none","function"==typeof i.options.onsearch&&i.options.onsearch(i,e)}};if("function"==typeof i.options.onbeforesearch){let e=i.options.onbeforesearch(i,t);if(!1===e)return;"object"==typeof e&&(t=e)}u(t)}else{e=new RegExp(e,"gi");var n=[];for(t=0;t<i.items.length;t++){var o=g(t),r=i.items[t].data.title||"",l=i.items[t].data.group||"",s=i.items[t].data.synonym||"";s&&(s=s.join(" ")),(null==e||1==i.items[t].selected||o.toString().match(e)||r.match(e)||l.match(e)||s.match(e))&&n.push(i.items[t])}if(n.length){y.style.display="",i.results=n;var a=n.length||0;for(1==i.options.lazyLoading&&a>200&&(a=200),t=0;t<a;t++)i.results[t].group?(i.results[t].group.parentNode||y.appendChild(i.results[t].group),i.results[t].group.lastChild.appendChild(i.results[t].element)):y.appendChild(i.results[t].element)}else y.style.display="none",i.results=null}1==i.options.autofocus&&i.first()},i.open=function(){if(!o.classList.contains("jdropdown-focus")){e.current=i,n(i,!0),o.classList.add("jdropdown-focus"),l.getWindowWidth()<800&&(null!=i.options.type&&"picker"!=i.options.type||d.slideBottom(v,1)),1==i.options.autocomplete&&(i.header.value=i.search,i.header.focus());var t=m();if(t[0]){var r=i.getPosition(t[0]);!1!==r&&i.setCursor(r)}if(!i.options.type||"default"==i.options.type){var s=o.getBoundingClientRect(),a=v.getBoundingClientRect();i.options.position?(v.style.position="fixed",window.innerHeight<s.bottom+a.height?(v.style.top="",v.style.bottom=window.innerHeight-s.top+1+"px"):(v.style.top=s.bottom+"px",v.style.bottom=""),v.style.left=s.left+"px"):window.innerHeight<s.bottom+a.height?(v.style.top="",v.style.bottom=s.height+1+"px"):(v.style.top="",v.style.bottom=""),v.style.minWidth=s.width+"px",i.options.maxWidth&&(v.style.maxWidth=i.options.maxWidth),i.items.length||1!=i.options.autocomplete?y.style.display="":y.style.display="none"}}"function"==typeof i.options.onopen&&i.options.onopen(o)},i.close=function(t){return o.classList.contains("jdropdown-focus")&&(i.header.value=i.getText(),i.setCursor(),t||"function"!=typeof i.options.onclose||i.options.onclose(o),i.header.blur&&i.header.blur(),o.classList.remove("jdropdown-focus"),n(i,!1),e.current=null),i.getValue()},i.setCursor=function(e,t){if(null!=i.currentIndex&&i.items&&i.items[i.currentIndex]&&i.items[i.currentIndex].element.classList.remove("jdropdown-cursor"),null==e)i.currentIndex=null;else if(e=parseInt(e),i.items[e].element.parentNode&&(i.items[e].element.classList.add("jdropdown-cursor"),i.currentIndex=e,!1!==t&&i.items[i.currentIndex].element)){y.scrollTop;var n=i.items[i.currentIndex].element;y.scrollTop=n.offsetTop-n.scrollTop+n.clientTop-95}},i.resetCursor=i.setCursor,i.updateCursor=i.setCursor,i.reset=function(){i.setCursor(),i.setValue(null)},i.first=function(){!0===i.options.lazyLoading&&i.loadFirst();var e=y.querySelectorAll(".jdropdown-item");if(e.length){var t=e[0].indexValue;i.setCursor(t)}},i.last=function(){!0===i.options.lazyLoading&&i.loadLast();var e=y.querySelectorAll(".jdropdown-item");if(e.length){var t=e[e.length-1].indexValue;i.setCursor(t)}},i.next=function(e){var t=null;if(e){if(1==e.length){var n=i.currentIndex||-1;e=e.toLowerCase();var o=null,r=null,l=y.querySelectorAll(".jdropdown-item");if(l.length){for(var s=0;s<l.length;s++)if(l[s].indexValue>n&&(o=i.items[l[s].indexValue])&&(r=o.element.innerText[0])&&e==(r=r.toLowerCase())){t=l[s].indexValue;break}i.setCursor(t)}}}else if(null==i.currentIndex||null==i.currentIndex)i.first();else{var a=i.items[i.currentIndex].element,c=a.nextElementSibling;c?(c.classList.contains("jdropdown-group")&&(c=c.lastChild.firstChild),t=c.indexValue):a.parentNode.classList.contains("jdropdown-group-items")&&((c=a.parentNode.parentNode.nextElementSibling)&&(c.classList.contains("jdropdown-group")?c=c.lastChild.firstChild:c.classList.contains("jdropdown-item")?t=c.indexValue:c=null),c&&(t=c.indexValue)),null!==t&&i.setCursor(t)}},i.prev=function(){var e=null;if(null===i.currentIndex)i.first();else{var t=i.items[i.currentIndex].element,n=t.previousElementSibling;n?(n.classList.contains("jdropdown-group")&&(n=n.lastChild.lastChild),e=n.indexValue):t.parentNode.classList.contains("jdropdown-group-items")&&((n=t.parentNode.parentNode.previousElementSibling)&&(n.classList.contains("jdropdown-group")?n=n.lastChild.lastChild:n.classList.contains("jdropdown-item")?e=n.indexValue:n=null),n&&(e=n.indexValue))}null!==e&&i.setCursor(e)},i.loadFirst=function(){if(i.results)var e=i.results;else e=i.items;var t=e.length||0;1==i.options.lazyLoading&&t>200&&(t=200),y.textContent="";for(var n=0;n<t;n++)e[n].group?(e[n].group.parentNode||y.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):y.appendChild(e[n].element);y.scrollTop=0},i.loadLast=function(){if(i.results)var e=i.results;else e=i.items;var t=e.length;if(t>200){t-=200,y.textContent="";for(var n=t;n<e.length;n++)e[n].group?(e[n].group.parentNode||y.appendChild(e[n].group),e[n].group.lastChild.appendChild(e[n].element)):y.appendChild(e[n].element);y.scrollTop=y.scrollHeight}},i.loadUp=function(){var e=!1;if(i.results)var t=i.results;else t=i.items;var n=y.querySelectorAll(".jdropdown-item")[0].indexValue;n=i.items[n];var o=t.indexOf(n)-1;if(o>0){for(var r=0;o>0&&t[o]&&r<200;)t[o].group?(t[o].group.parentNode||y.insertBefore(t[o].group,y.firstChild),t[o].group.lastChild.insertBefore(t[o].element,t[o].group.lastChild.firstChild)):y.insertBefore(t[o].element,y.firstChild),o--,r++;e=!0}return e},i.loadDown=function(){var e=!1;if(i.results)var t=i.results;else t=i.items;var n=y.querySelectorAll(".jdropdown-item"),o=n[n.length-1].indexValue;o=i.items[o];var r=t.indexOf(o)+1;if(r<t.length){for(var l=0;r<t.length&&t[r]&&l<200;)t[r].group?(t[r].group.parentNode||y.appendChild(t[r].group),t[r].group.lastChild.appendChild(t[r].element)):y.appendChild(t[r].element),r++,l++;e=!0}return e},function(){if(r||(r={}),"SELECT"==o.tagName){var t=e.extractFromDom(o,r);o=t.el,r=t.options}!r.placeholder&&o.getAttribute("placeholder")&&(r.placeholder=o.getAttribute("placeholder")),i.value={},i.items=[],i.groups=[],i.search="",i.results=null,o.classList.add("jdropdown"),(j=document.createElement("div")).className="jdropdown-container-header",i.header=document.createElement("input"),i.header.className="jdropdown-header jss_object",i.header.type="text",i.header.setAttribute("autocomplete","off"),i.header.onfocus=function(){"function"==typeof i.options.onfocus&&i.options.onfocus(o)},i.header.onblur=function(){"function"==typeof i.options.onblur&&i.options.onblur(o)},i.header.onkeyup=function(e){1!=i.options.autocomplete||E?i.options.autocomplete||i.next(e.key):(i.search!=i.header.value.trim()&&(E=setTimeout((function(){i.find(i.header.value.trim()),E=null}),400)),o.classList.contains("jdropdown-focus")||i.open())},e.hasEvents||(e.hasEvents=!0,document.addEventListener("keydown",e.keydown)),(v=document.createElement("div")).className="jdropdown-container",(y=document.createElement("div")).className="jdropdown-content",(x=document.createElement("div")).className="jdropdown-close",x.textContent="Done",(w=document.createElement("div")).className="jdropdown-reset",w.textContent="x",w.onclick=function(){i.reset(),i.close()},(C=document.createElement("div")).className="jdropdown-backdrop",j.appendChild(i.header),v.appendChild(y),o.appendChild(j),o.appendChild(v),o.appendChild(C),i.setOptions(r),"ontouchsend"in document.documentElement==1?o.addEventListener("touchsend",e.mouseup):o.addEventListener("mouseup",e.mouseup),1==i.options.lazyLoading&&c(y,{loadUp:i.loadUp,loadDown:i.loadDown}),y.onwheel=function(e){e.stopPropagation()},o.change=i.setValue,o.val=function(e){if(void 0===e)return i.getValue(!!i.options.multiple);i.setValue(e)},o.dropdown=i}(),i};return e.keydown=function(t){var n=null;if(n=e.current)if(13==t.which||9==t.which)n.header.value&&null==n.currentIndex&&n.options.newOptions?n.add():(null==n.currentIndex&&1==n.options.autocomplete&&""!=n.header.value&&n.find(n.header.value),n.selectIndex(n.currentIndex));else if(38==t.which)null==n.currentIndex?n.first():n.currentIndex>0&&n.prev(),t.preventDefault();else if(40==t.which)null==n.currentIndex?n.first():n.currentIndex+1<n.items.length&&n.next(),t.preventDefault();else if(36==t.which)n.first(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(35==t.which)n.last(),t.target.classList.contains("jdropdown-header")||t.preventDefault();else if(27==t.which)n.close();else if(33==t.which){if(null==n.currentIndex)n.first();else if(n.currentIndex>0)for(var o=0;o<7;o++)n.prev();t.preventDefault()}else if(34==t.which){if(null==n.currentIndex)n.first();else if(n.currentIndex+1<n.items.length)for(o=0;o<7;o++)n.next();t.preventDefault()}},e.mouseup=function(e){var t=l.findElement(e.target,"jdropdown");if(t){var n=t.dropdown;if(e.target.classList.contains("jdropdown-header"))if(t.classList.contains("jdropdown-focus")&&t.classList.contains("jdropdown-default")){var o=t.getBoundingClientRect();if(e.changedTouches&&e.changedTouches[0]){var r=e.changedTouches[0].clientX;e.changedTouches[0].clientY}else r=e.clientX,e.clientY;o.width-(r-o.left)<30?e.target.classList.contains("jdropdown-add")?n.add():n.close():0==n.options.autocomplete&&n.close()}else n.open();else if(e.target.classList.contains("jdropdown-group-name")){var i=e.target.nextSibling.children;if("none"!=e.target.nextSibling.style.display)for(var s=0;s<i.length;s++)"none"!=i[s].style.display&&n.selectItem(i[s])}else e.target.classList.contains("jdropdown-group-arrow")?e.target.classList.contains("jdropdown-group-arrow-down")?(e.target.classList.remove("jdropdown-group-arrow-down"),e.target.classList.add("jdropdown-group-arrow-up"),e.target.parentNode.nextSibling.style.display="none"):(e.target.classList.remove("jdropdown-group-arrow-up"),e.target.classList.add("jdropdown-group-arrow-down"),e.target.parentNode.nextSibling.style.display=""):e.target.classList.contains("jdropdown-item")?n.selectItem(e.target):e.target.classList.contains("jdropdown-image")||e.target.classList.contains("jdropdown-description")?n.selectItem(e.target.parentNode):e.target.classList.contains("jdropdown-title")?n.selectItem(e.target.parentNode.parentNode):(e.target.classList.contains("jdropdown-close")||e.target.classList.contains("jdropdown-backdrop"))&&n.close()}},e.extractFromDom=function(e,t){var n=e;if(t||(t={}),!e.getAttribute("multiple")||t&&null!=t.multiple||(t.multiple=!0),!e.getAttribute("placeholder")||t&&null!=t.placeholder||(t.placeholder=e.getAttribute("placeholder")),!e.getAttribute("data-autocomplete")||t&&null!=t.autocomplete||(t.autocomplete=!0),t&&null!=t.width||(t.width=e.offsetWidth),!e.value||t&&null!=t.value||(t.value=e.value),!t||null==t.data){t.data=[];for(var o=0;o<e.children.length;o++)if("OPTGROUP"==e.children[o].tagName)for(var r=0;r<e.children[o].children.length;r++)t.data.push({value:e.children[o].children[r].value,text:e.children[o].children[r].textContent,group:e.children[o].getAttribute("label")});else t.data.push({value:e.children[o].value,text:e.children[o].textContent})}t&&null!=t.onchange||(t.onchange=function(e,o,r,i){1==t.multiple?obj.items[o].classList.contains("jdropdown-selected")?n.options[o].setAttribute("selected","selected"):n.options[o].removeAttribute("selected"):n.value=i});var i=document.createElement("div");return e.parentNode.insertBefore(i,e),e.style.display="none",{el:e=i,options:t}},e}();function w(e,t){if(e.picker)return e.picker.setOptions(t,!0);var o={type:"picker",options:{}},r=null,i=null,s=function(e){return e instanceof Element||e instanceof HTMLDocument},a=function(){i.innerHTML="";for(var e=Object.keys(o.options.data),t=0;t<e.length;t++){var n=document.createElement("div");n.classList.add("jpicker-item"),n.k=e[t],n.v=o.options.data[e[t]];var r=o.getLabel(e[t],n);s(r)?n.appendChild(r):n.innerHTML=r,i.appendChild(n)}};return o.setOptions=function(e,t){var n={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};for(var l in e&&e.options&&(e.data=e.options),n)e&&e.hasOwnProperty(l)?o.options[l]=e[l]:void 0!==o.options[l]&&!0!==t||(o.options[l]=n[l]);return!1===o.options.header?r.style.display="none":r.style.display="",o.options.width?r.style.width=parseInt(o.options.width)+"px":r.style.width="",o.options.height?(i.style.maxHeight=o.options.height+"px",i.style.overflow="scroll"):i.style.overflow="",o.options.columns>0&&(o.options.grid?(i.classList.add("jpicker-grid"),i.style.gridTemplateColumns="repeat("+o.options.grid+", 1fr)"):(i.classList.add("jpicker-columns"),i.style.width=o.options.width?o.options.width:36*o.options.columns+"px")),isNaN(parseInt(o.options.value))&&(o.options.value=0),a(),o.setValue(o.options.value),o},o.getValue=function(){return o.options.value},o.setValue=function(t,n){if(o.setLabel(t),o.options.value=String(t),e.value!=o.options.value&&(e.value=o.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value})),i.children[t]&&"generic"!==i.children[t].getAttribute("type")&&o.close(),n&&"function"==typeof o.options.onchange){var r=o.options.data[t];o.options.onchange(e,o,r,r,t,n)}},o.getLabel=function(e,t){var n=o.options.data[e]||null;return"function"==typeof o.options.render&&(n=o.options.render(n,t)),n},o.setLabel=function(e){var t;t=o.options.content?'<i class="material-icons">'+o.options.content+"</i>":o.getLabel(e,null),s(t)?(r.innerHTML="",r.appendChild(t)):r.innerHTML=t},o.open=function(){if(!e.classList.contains("jpicker-focus")){n(o,!0),e.classList.add("jpicker-focus"),e.focus();var t,l=0;i.style.marginLeft="";var s=r.getBoundingClientRect(),a=i.getBoundingClientRect();t=window.innerHeight<s.bottom+a.height||o.options.bottom?-1*(a.height+4):s.height+4,!0===o.options.right&&(l=-1*a.width+s.width),a.left+l<0&&(l=l+a.left+10),a.left+a.width>window.innerWidth&&(l=-1*(10+a.left+a.width-window.innerWidth)),i.style.marginTop=parseInt(t)+"px",i.style.marginLeft=parseInt(l)+"px","function"==typeof o.options.onopen&&o.options.onopen(e,o)}},o.close=function(){e.classList.contains("jpicker-focus")&&(e.classList.remove("jpicker-focus"),n(o,!1),"function"==typeof o.options.onclose&&o.options.onclose(e,o))},e.classList.add("jpicker"),e.setAttribute("tabindex","900"),e.onmousedown=function(t){e.classList.contains("jpicker-focus")||o.open()},(r=document.createElement("div")).classList.add("jpicker-header"),(i=document.createElement("div")).classList.add("jpicker-content"),i.onclick=function(e){var t=l.findElement(e.target,"jpicker-item");t&&t.parentNode===i&&o.setValue(t.k,e)},e.appendChild(r),e.appendChild(i),e.value=t.value||0,o.setOptions(t),"function"==typeof o.options.onload&&o.options.onload(e,o),e.change=o.setValue,e.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},e.picker=o,o}function C(e,t){var o={type:"toolbar",options:{}},r={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var i in r)t&&t.hasOwnProperty(i)?o.options[i]=t[i]:o.options[i]=r[i];!e&&t.app&&t.app.el&&(e=document.createElement("div"),t.app.el.appendChild(e));var s=document.createElement("div");s.classList.add("jtoolbar-item"),s.classList.add("jtoolbar-arrow");var a=document.createElement("div");a.classList.add("jtoolbar-floating"),s.appendChild(a),o.selectItem=function(e){for(var t=c.children,n=0;n<t.length;n++)e!=t[n]&&t[n].classList.remove("jtoolbar-selected");e.classList.add("jtoolbar-selected")},o.hide=function(){d.slideBottom(e,0,(function(){e.style.display="none"}))},o.show=function(){e.style.display="",d.slideBottom(e,1)},o.get=function(){return e},o.setBadge=function(e,t){c.children[e].children[1].firstChild.innerHTML=t},o.destroy=function(){toolbar.remove(),e.innerHTML=""},o.update=function(t,n){for(var r=0;r<c.children.length;r++){var i=c.children[r];"function"==typeof i.updateState&&i.updateState(e,o,i,t,n)}for(r=0;r<a.children.length;r++)"function"==typeof(i=a.children[r]).updateState&&i.updateState(e,o,i,t,n)},o.create=function(t){c.innerHTML="";for(var n=0;n<t.length;n++){var r=document.createElement("div");if(r.classList.add("jtoolbar-item"),t[n].width&&(r.style.width=parseInt(t[n].width)+"px"),t[n].k&&(r.k=t[n].k),t[n].tooltip&&r.setAttribute("title",t[n].tooltip),t[n].id&&r.setAttribute("id",t[n].id),t[n].updateState&&(r.updateState=t[n].updateState),t[n].active&&r.classList.add("jtoolbar-active"),t[n].disabled&&r.classList.add("jtoolbar-disabled"),"select"==t[n].type||"dropdown"==t[n].type)w(r,t[n]);else if("divisor"==t[n].type)r.classList.add("jtoolbar-divisor");else if("label"==t[n].type)r.classList.add("jtoolbar-label"),r.innerHTML=t[n].content;else{var i=document.createElement("i");if(void 0===t[n].class)i.classList.add("material-icons");else for(var l=t[n].class.split(" "),s=0;s<l.length;s++)i.classList.add(l[s]);if(i.innerHTML=t[n].content?t[n].content:"",r.appendChild(i),1==o.options.badge){var a=document.createElement("div");a.classList.add("jbadge");var u=document.createElement("div");u.innerHTML=t[n].badge?t[n].badge:"",a.appendChild(u),r.appendChild(a)}if(t[n].title)if(1==o.options.title){var d=document.createElement("span");d.innerHTML=t[n].title,r.appendChild(d)}else r.setAttribute("title",t[n].title);o.options.app&&t[n].route&&(r.route=t[n].route,r.onclick=function(){o.options.app.pages(this.route)},o.options.app.pages(t[n].route,{toolbarItem:r,closed:!0})),"function"==typeof t[n].render&&t[n].render(r,t[n])}t[n].onclick&&(r.onclick=t[n].onclick.bind(t[n],e,o,r)),c.appendChild(r)}setTimeout((function(){o.refresh()}),0)},o.open=function(){s.classList.add("jtoolbar-arrow-selected"),e.getBoundingClientRect(),a.getBoundingClientRect().bottom>window.innerHeight||o.options.bottom?a.style.bottom="0":a.style.removeProperty("bottom"),a.style.right="0",s.children[0].focus(),n(o,!0)},o.close=function(){s.classList.remove("jtoolbar-arrow-selected"),n(o,!1)},o.refresh=function(){if(1==o.options.responsive){var t=e.parentNode.getBoundingClientRect();o.options.maxWidth||(o.options.maxWidth=t.width);var n=parseInt(o.options.maxWidth);for(s.parentNode&&s.parentNode.removeChild(s);a.firstChild;)c.appendChild(a.firstChild);if(n<c.offsetWidth)for(n-=50;c.lastChild&&n<c.offsetWidth;)a.insertBefore(c.lastChild,a.firstChild);a.children.length>0&&c.appendChild(s)}},o.setReadonly=function(t){t=t?"add":"remove",e.classList[t]("jtoolbar-disabled")},e.onclick=function(e){var t=l.findElement(e.target,"jtoolbar-item");t&&o.selectItem(t),e.target.classList.contains("jtoolbar-arrow")&&o.open()},window.addEventListener("resize",(function(){o.refresh()})),e.classList.add("jtoolbar"),e.innerHTML="",1==o.options.container&&e.classList.add("jtoolbar-container");var c=document.createElement("div");return e.appendChild(c),o.options.app&&e.classList.add("jtoolbar-mobile"),o.create(o.options.items),e.toolbar=o,o}var E=function(){var e=function(t,n){var o={type:"editor",options:{}},r={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];var s=null,a=null,c=[];o.el=t,"function"==typeof o.options.onclick&&(t.onclick=function(e){o.options.onclick(t,o,e)}),t.classList.add("jeditor-container");var d=document.createElement("div");d.className="jsnippet",d.setAttribute("contenteditable",!1);var p=document.createElement("div");if(p.className="jeditor-toolbar",o.editor=document.createElement("div"),o.editor.setAttribute("contenteditable",!0),o.editor.setAttribute("spellcheck",!1),o.editor.classList.add("jeditor"),o.options.placeholder&&o.editor.setAttribute("data-placeholder",o.options.placeholder),(o.options.maxHeight||o.options.height)&&(o.editor.style.overflowY="auto",o.options.maxHeight&&(o.editor.style.maxHeight=o.options.maxHeight),o.options.height&&(o.editor.style.height=o.options.height)),o.options.url)u({url:o.options.url,dataType:"html",success:function(t){o.editor.innerHTML=t,e.setCursor(o.editor,"initial"==o.options.focus)}});else if(o.options.value)o.editor.innerHTML=o.options.value;else for(var f=0;f<t.children.length;f++)o.editor.appendChild(t.children[f]);t.innerHTML="";var h=function(e){"function"==typeof o.options.onchange&&o.options.onchange(t,o,e),o.options.value=o.getData(),t.value!=o.options.value&&(t.value=o.options.value,"function"==typeof t.oninput&&t.oninput({type:"input",target:t,value:t.value}))},g=function(){var e=null;if(e=d.children[0]){e.classList.contains("jslider-grid")||e.classList.add("jslider-grid");var t=e.children.length;e.setAttribute("data-number",t>4?4:t),t>4?e.setAttribute("data-total",t-4):e.removeAttribute("data-total")}};o.appendSnippet=function(e){d.innerHTML="";for(var t=["image","title","description","host","url"],n=0;n<t.length;n++){var r=document.createElement("div");if(r.className="jsnippet-"+t[n],r.setAttribute("data-k",t[n]),d.appendChild(r),e[t[n]])if("image"==t[n]){Array.isArray(e.image)||(e.image=[e.image]);for(var i=0;i<e.image.length;i++){var l=document.createElement("img");l.src=e.image[i],r.appendChild(l)}}else r.innerHTML=e[t[n]]}o.editor.appendChild(document.createElement("br")),o.editor.appendChild(d)},o.setData=function(t){o.editor.innerHTML="object"==typeof t?t.content:t,o.options.focus&&e.setCursor(o.editor,!0),c=[]},o.getFiles=function(){for(var e=o.editor.querySelectorAll(".jfile"),t=[],n=0;n<e.length;n++)c[e[n].src]&&t.push(c[e[n].src]);return t},o.getText=function(){return o.editor.innerText},o.getData=function(e){if(e){if(u={content:""},d.innerHTML){u.snippet={};for(var t=0;t<d.children.length;t++){var n=d.children[t].getAttribute("data-k");if(n)if("image"==n){u.snippet.image||(u.snippet.image=[]);for(var r=0;r<d.children[t].children.length;r++)u.snippet.image.push(d.children[t].children[r].getAttribute("src"))}else u.snippet[n]=d.children[t].innerHTML}}var i=Object.keys(c);if(i.length)for(u.files=[],t=0;t<i.length;t++)u.files.push(c[i[t]]);var l=document.createElement("div");l.innerHTML=o.editor.innerHTML;var s=l.querySelector(".jsnippet");s&&s.remove();var a=l.innerHTML;a=(a=(a=a.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),u.content=a.trim(),k("getData",u)}else var u=o.editor.innerHTML;return u},o.reset=function(){o.editor.innerHTML="",d.innerHTML="",c=[]},o.addPdf=function(e){if("data"!=e.result.substr(0,4))console.error("Invalid source");else{var t=document.createElement("canvas");t.width=60,t.height=60;var n=new Image;t.getContext("2d").drawImage(n,0,0,t.width,t.height),t.toBlob((function(t){var n=document.createElement("img");n.src=window.URL.createObjectURL(t),n.title=e.name,n.className="jfile pdf",c[n.src]={file:n.src,extension:"pdf",content:e.result},document.execCommand("insertHtml",!1,n.outerHTML)}))}},o.addImage=function(e,t){if(o.options.acceptImages)if(e||(e=""),"data"==e.substr(0,4)||o.options.remoteParser){if("data"==e.substr(0,4)){var n=e.split(";");n=(n=n[0].split("/"))[1]}else n=e.substr(e.lastIndexOf(".")+1),e=o.options.remoteParser+e;var r=new Image;r.onload=function(){var e=document.createElement("canvas");e.width=r.width,e.height=r.height,e.getContext("2d").drawImage(r,0,0,e.width,e.height),e.toBlob((function(i){var l=document.createElement("img");l.src=window.URL.createObjectURL(i),l.classList.add("jfile"),l.setAttribute("tabindex","900"),l.setAttribute("width",r.width),l.setAttribute("height",r.height),c[l.src]={file:l.src,extension:n,content:e.toDataURL()},o.options.dropAsSnippet||t?(function(e){d.innerHTML||o.appendSnippet({}),d.children[0].appendChild(e),g()}(l),c[l.src].snippet=!0):document.execCommand("insertHtml",!1,l.outerHTML),h()}))},r.src=e}else console.error("remoteParser not defined in your initialization")},o.addFile=function(e){for(var t=[],n=0;n<e.length;n++)if(e[n].size>o.options.maxFileSize)alert("The file is too big");else{var r=e[n].type.split("/");(r="image"==r[0]?1:"pdf"==r[1]?2:0)?(t[n]=new FileReader,t[n].index=n,t[n].type=r,t[n].name=e[n].name,t[n].date=e[n].lastModified,t[n].size=e[n].size,t[n].addEventListener("load",(function(e){2==e.target.type?1==o.options.acceptFiles&&o.addPdf(e.target):o.addImage(e.target.result)}),!1),t[n].readAsDataURL(e[n])):alert("The extension is not allowed")}},o.destroy=function(){o.editor.removeEventListener("mouseup",D),o.editor.removeEventListener("mousedown",S),o.editor.removeEventListener("mousemove",O),o.editor.removeEventListener("keyup",I),o.editor.removeEventListener("keydown",T),o.editor.removeEventListener("dragstart",w),o.editor.removeEventListener("dragenter",E),o.editor.removeEventListener("dragover",A),o.editor.removeEventListener("drop",L),o.editor.removeEventListener("paste",x),o.editor.removeEventListener("blur",M),o.editor.removeEventListener("focus",N),t.editor=null,t.classList.remove("jeditor-container"),p.remove(),d.remove(),o.editor.remove()},o.upload=function(){l.click(o.file)};const m=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],b=["width","height","align","border","src","tabindex"],j=["color","font-weight","font-size","background","background-color","margin"],v=function(e){if(e.tagName&&-1===m.indexOf(e.tagName.toLowerCase())&&e.innerText&&(e.innerHTML=e.innerText),e.attributes&&e.attributes.length){let t=null,n=e.getAttribute("style");if(n){t=[];let e=n.split(";");for(let n=0;n<e.length;n++){let o=e[n].trim().split(":");if(j.indexOf(o[0].trim())>=0){let e=o.shift();o=o.join(":"),t.push(e+":"+o)}}}"IMG"===e.tagName.toUpperCase()&&(o.options.acceptImages&&e.src?(e.setAttribute("tabindex","900"),o.addImage(e.src)):e.parentNode.removeChild(e));let r=[];for(let t=0;t<e.attributes.length;t++)r.push(e.attributes[t].name);r.length&&r.forEach((function(t){-1===b.indexOf(t)?e.removeAttribute(t):e.attributes&&e.attributes[f]&&-1!==e.attributes[f].value.indexOf("<")&&e.attributes[f].value.replace("<","&#60;")})),e.style="",t&&t.length&&e.setAttribute("style",t.join(";"))}if(e.children.length)for(let t=e.children.length;t>0;t--)v(e.children[t-1])};var y=function(e){var t=window.getSelection(),n=document.createRange();n.selectNode(e),t.addRange(n)},x=function(e){if(1==o.options.filterPaste){if(e.clipboardData||e.originalEvent.clipboardData)var t=(e.originalEvent||e).clipboardData.getData("text/html"),n=(e.originalEvent||e).clipboardData.getData("text/plain"),r=(e.originalEvent||e).clipboardData.files;else window.clipboardData&&(t=window.clipboardData.getData("Html"),n=window.clipboardData.getData("Text"),r=window.clipboardData.files);if(r.length)o.addFile(r);else if(t){var i=function(e){e&&(e=e.replace(new RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var t=(new DOMParser).parseFromString(e,"text/html");v(t);var n=document.createElement("div");return n.innerHTML=t.firstChild.innerHTML,n}(t);document.execCommand("insertHtml",!1,i.innerHTML)}else t=n.split("\r\n"),e.target.innerText?(t=t.map((function(e){return"<div>"+e+"</div>"})),document.execCommand("insertText",!1,t.join(""))):t.map((function(e){var t=document.createElement("div");t.innerText=e,o.editor.appendChild(t)}));e.preventDefault()}},w=function(e){a&&a.e&&e.preventDefault()},E=function(e){a||0==o.options.dropZone||(t.classList.add("jeditor-dragging"),e.preventDefault())},A=function(e){a||0==o.options.dropZone||(s&&clearTimeout(s),s=setTimeout((function(){t.classList.remove("jeditor-dragging")}),100),e.preventDefault())},L=function(e){if(a||0==o.options.dropZone);else{var n=null;document.caretRangeFromPoint?n=document.caretRangeFromPoint(e.clientX,e.clientY):e.rangeParent&&(n=document.createRange()).setStart(e.rangeParent,e.rangeOffset);var r=window.getSelection();r.removeAllRanges(),r.addRange(n),r.anchorNode.parentNode.focus();var i=(e.originalEvent||e).dataTransfer.getData("text/html"),l=(e.originalEvent||e).dataTransfer.getData("text/plain"),s=(e.originalEvent||e).dataTransfer.files;s.length?o.addFile(s):l&&function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelectorAll("img");if(n.length)for(var r=0;r<n.length;r++)o.addImage(n[r].src)}(i),t.classList.remove("jeditor-dragging"),e.preventDefault()}},M=function(e){k("onevent",e),h(e),"function"==typeof o.options.onblur&&o.options.onblur(t,o,e)},N=function(e){"function"==typeof o.options.onfocus&&o.options.onfocus(t,o,e)},I=function(e){o.editor.innerHTML||(o.editor.innerHTML="<div><br></div>"),"function"==typeof o.options.onkeyup&&o.options.onkeyup(t,o,e)},T=function(e){if(k("onevent",e),"Delete"==e.key&&"IMG"==e.target.tagName){var n=e.target.parentNode;y(e.target),n.classList.contains("jsnippet-image")&&g()}"function"==typeof o.options.onkeydown&&o.options.onkeydown(t,o,e)},D=function(e){if(a&&a.e&&(a.e.classList.remove("resizing"),1==a.e.changed)){var t=a.e.cloneNode();t.width=parseInt(a.e.style.width)||a.e.getAttribute("width"),t.height=parseInt(a.e.style.height)||a.e.getAttribute("height"),a.e.style.width="",a.e.style.height="",y(a.e),document.execCommand("insertHtml",!1,t.outerHTML)}a=!1},S=function(e){var t=function(t){var n=t.getBoundingClientRect();n.width-(e.clientX-n.left)<40&&e.clientY-n.top<40&&(t.innerHTML="",t.remove())};if("IMG"==e.target.tagName)if(e.target.style.cursor){var n=e.target.getBoundingClientRect();a={e:e.target,x:e.clientX,y:e.clientY,w:n.width,h:n.height,d:e.target.style.cursor},e.target.getAttribute("width")||e.target.setAttribute("width",n.width),e.target.getAttribute("height")||e.target.setAttribute("height",n.height);var o=window.getSelection();if(o.rangeCount)for(var r=0;r<o.rangeCount;r++)o.removeRange(o.getRangeAt(r));e.target.classList.add("resizing")}else a=!0;else e.target.classList.contains("jsnippet")?t(e.target):e.target.parentNode.classList.contains("jsnippet")&&t(e.target.parentNode),a=!0},O=function(e){if("IMG"==e.target.tagName&&!e.target.parentNode.classList.contains("jsnippet-image")&&1==o.options.allowImageResize&&e.target.getAttribute("tabindex")){var t=e.target.getBoundingClientRect();e.clientY-t.top<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="ne-resize":e.clientX-t.left<5?e.target.style.cursor="nw-resize":e.target.style.cursor="n-resize":t.height-(e.clientY-t.top)<5?t.width-(e.clientX-t.left)<5?e.target.style.cursor="se-resize":e.clientX-t.left<5?e.target.style.cursor="sw-resize":e.target.style.cursor="s-resize":t.width-(e.clientX-t.left)<5?e.target.style.cursor="e-resize":e.clientX-t.left<5?e.target.style.cursor="w-resize":e.target.style.cursor=""}if(1==e.which&&a&&a.d){if("e-resize"==a.d||"ne-resize"==a.d||"se-resize"==a.d)if(a.e.style.width=a.w+(e.clientX-a.x),e.shiftKey){var n=(e.clientX-a.x)*(a.h/a.w);a.e.style.height=a.h+n}else n=null;n||"s-resize"!=a.d&&"se-resize"!=a.d&&"sw-resize"!=a.d||e.shiftKey||(a.e.style.height=a.h+(e.clientY-a.y)),a.e.changed=!0}},k=function(e,t){if(o.options.extensions){var n=Object.keys(o.options.extensions);if(n.length)for(var r=0;r<n.length;r++)o.options.extensions[n[r]]&&"function"==typeof o.options.extensions[n[r]][e]&&o.options.extensions[n[r]][e].call(o,t)}};if(document.addEventListener("mouseup",D),document.addEventListener("mousemove",O),o.editor.addEventListener("mousedown",S),o.editor.addEventListener("keyup",I),o.editor.addEventListener("keydown",T),o.editor.addEventListener("dragstart",w),o.editor.addEventListener("dragenter",E),o.editor.addEventListener("dragover",A),o.editor.addEventListener("drop",L),o.editor.addEventListener("paste",x),o.editor.addEventListener("focus",N),o.editor.addEventListener("blur",M),t.appendChild(o.editor),o.options.snippet&&o.appendSnippet(o.options.snippet),o.options.toolbar){if(Array.isArray(o.options.toolbar))var R={container:!0,responsive:!0,items:o.options.toolbar};else R=!0===o.options.toolbar?{container:!0,responsive:!0,items:[]}:o.options.toolbar;R.items&&R.items.length||(R.items=e.getDefaultToolbar(o)),o.options.toolbarOnTop?(t.classList.add("toolbar-on-top"),t.insertBefore(p,t.firstChild)):(o.editor.style.padding="15px",t.appendChild(p)),C(p,R),p.addEventListener("click",(function(){o.editor.focus()}))}return o.file=document.createElement("input"),o.file.style.display="none",o.file.type="file",o.file.setAttribute("accept","image/*"),o.file.onchange=function(){o.addFile(this.files)},t.appendChild(o.file),o.options.focus&&e.setCursor(o.editor,"initial"==o.options.focus),t.change=o.setData,t.val=function(e){if(void 0===e){var n="true"!==t.getAttribute("data-html");return o.getData(n)}o.setData(e)},function(){if(o.options.extensions){var e=Object.keys(o.options.extensions);if(e.length)for(var n=0;n<e.length;n++)o.options.extensions[e[n]]&&"function"==typeof o.options.extensions[e[n]]&&(o.options.extensions[e[n]]=o.options.extensions[e[n]](t,o))}}(),t.editor=o,"function"==typeof o.options.onload&&o.options.onload(t,o,o.editor),o};return e.setCursor=function(e,t){e.focus(),document.execCommand("selectAll");var n=window.getSelection(),o=n.getRangeAt(0);if(1==t)var r=o.startContainer,i=0;else i=(r=o.endContainer).length;o.setStart(r,i),o.setEnd(r,i),n.removeAllRanges(),n.addRange(o)},e.getDefaultToolbar=function(e){var t=function(e,t,n){n.color||(b(n,{onchange:function(e,t){"color"===n.k?document.execCommand("foreColor",!1,t):document.execCommand("backColor",!1,t)}}),n.color.open())},n=[];return n.push({content:"undo",onclick:function(){document.execCommand("undo")}}),n.push({content:"redo",onclick:function(){document.execCommand("redo")}}),n.push({type:"divisor"}),e.options.toolbarOnTop&&(n.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(e){return'<span style="font-family:'+e+'">'+e+"</span>"},onchange:function(e,t,n,o,r){document.execCommand("fontName",!1,o)}}),n.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(e){return'<span style="font-size:'+e+'">'+e+"</span>"},onchange:function(e,t,n,o,r){document.execCommand("fontSize",!1,parseInt(r)+1)}}),n.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(e){return'<i class="material-icons">'+e+"</i>"},onchange:function(e,t,n,o,r){document.execCommand(["JustifyLeft","justifyCenter","justifyRight","justifyFull"][r])}}),n.push({type:"divisor"}),n.push({content:"format_color_text",k:"color",onclick:t}),n.push({content:"format_color_fill",k:"background-color",onclick:t})),n.push({content:"format_bold",onclick:function(e,t,n){document.execCommand("bold"),document.queryCommandState("bold")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_italic",onclick:function(e,t,n){document.execCommand("italic"),document.queryCommandState("italic")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_underline",onclick:function(e,t,n){document.execCommand("underline"),document.queryCommandState("underline")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({type:"divisor"}),n.push({content:"format_list_bulleted",onclick:function(e,t,n){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_list_numbered",onclick:function(e,t,n){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_indent_increase",onclick:function(e,t,n){document.execCommand("indent",!0,null),document.queryCommandState("indent")?n.classList.add("selected"):n.classList.remove("selected")}}),n.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),e.options.toolbarOnTop&&(n.push({type:"divisor"}),n.push({content:"photo",onclick:function(){e.upload()}}),n.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(e,t){t&&(t.onmouseover=this.onmouseover,e=e.split("x"),t.setAttribute("data-x",e[0]),t.setAttribute("data-y",e[1]));var n=document.createElement("div");return t.style.margin="1px",t.style.border="1px solid #ddd",n},onmouseover:function(e){for(var t=parseInt(e.target.getAttribute("data-x")),n=parseInt(e.target.getAttribute("data-y")),o=0;o<e.target.parentNode.children.length;o++){var r=e.target.parentNode.children[o],i=parseInt(r.getAttribute("data-x")),l=parseInt(r.getAttribute("data-y"));i<=t&&l<=n?(r.style.backgroundColor="#cae1fc",r.style.borderColor="#2977ff"):(r.style.backgroundColor="",r.style.borderColor="#ddd")}},onchange:function(e,t,n){n=n.split("x");for(var o=document.createElement("table"),r=document.createElement("tbody"),i=0;i<=n[1];i++){for(var l=document.createElement("tr"),s=0;s<=n[0];s++){var a=document.createElement("td");a.innerHTML="",l.appendChild(a)}r.appendChild(l)}o.appendChild(r),o.setAttribute("width","100%"),o.setAttribute("cellpadding","6"),o.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,o.outerHTML)}})),n},e}();var A=function(){var e=function(t,n){var o={options:{}},r={type:"big",title:"Untitled",width:510,height:472};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];return o.state={isMinized:!1},o.setState=function(){o.state.isMinized?o.container.classList.remove("jfloating-minimized"):o.container.classList.add("jfloating-minimized"),o.state.isMinized=!o.state.isMinized},o.close=function(){Components.elements.splice(e.elements.indexOf(o.container),1),o.updatePosition(),t.remove()},o.updatePosition=function(){for(var t=0;t<e.elements.length;t++){var n=e.elements[t],o=e.elements[t-1];n.style.right=t*(o?o.offsetWidth:n.offsetWidth)*1.01+"px"}},o.init=function(){(function(){for(var e=document.createElement("div");t.children[0];)e.appendChild(t.children[0]);for(o.content=document.createElement("div"),o.content.className="jfloating_content",o.content.innerHTML=t.innerHTML;e.children[0];)o.content.appendChild(e.children[0]);o.container=document.createElement("div"),o.container.className="jfloating",o.container.appendChild(o.content),o.options.title?o.container.setAttribute("title",o.options.title):o.container.classList.add("no-title"),o.options.width&&(o.container.style.width=parseInt(o.options.width)+"px"),o.options.height&&(o.container.style.height=parseInt(o.options.height)+"px"),t.innerHTML="",t.appendChild(o.container)})(),o.container&&o.container.addEventListener("click",(function(e){var t=e.target.getBoundingClientRect();if(e.target.classList.contains("jfloating")){if(e.changedTouches&&e.changedTouches[0])var n=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY;else n=e.clientX,r=e.clientY;t.width-(n-t.left)<50&&r-t.top<50?setTimeout((function(){o.close()}),100):o.setState()}})),o.container.classList.add("jfloating-"+o.options.type),e.elements.push(o.container),o.updatePosition(),t.floating=o},o.init(),o};return e.elements=[],e}();var L=function(){const e=function(e){return!isNaN(e)&&null!==e&&("string"!=typeof e||""!==e.trim())},t={between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},"=":function(e,t){return e==t[0]},"!=":function(e,t){return e!=t[0]}},n={"valid date":function(){return!0},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"<":function(e,t){return e<t[0]},"<=":function(e,t){return e<=t[0]},">":function(e,t){return e>t[0]},">=":function(e,t){return e>=t[0]},between:function(e,t){return e>=t[0]&&e<=t[1]},"not between":function(e,t){return e<t[0]||e>t[1]}},o={contains:function(e,t){return e.includes(t[0])},"not contains":function(e,t){return!e.includes(t[0])},"begins with":function(e,t){return e.startsWith(t[0])},"ends with":function(e,t){return e.endsWith(t[0])},"=":function(e,t){return e===t[0]},"!=":function(e,t){return e!==t[0]},"valid email":function(e){return new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/).test(e)},"valid url":function(e){return new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)}},r=function(e,t){return"function"==typeof r[t.type]?!(!t.allowBlank||void 0!==e&&""!==e&&null!==e)||r[t.type].call(this,e,t):null};r.url=function(e){return!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(e)},r.email=function(e){var t=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!e||!t.test(e))},r.required=function(e){return!(!e||!e.trim())},r.empty=function(e){return null==e||"string"==typeof e&&!e.toString().trim()},r["not exist"]=r.empty,r.notEmpty=function(e){return!r.empty(e)},r.exist=r.notEmpty,r.number=function(n,o){if(!e(n))return!1;if(!o||!o.criteria)return!0;if(!t[o.criteria])return!1;let r=o.value.map((function(e){return parseFloat(e)}));return t[o.criteria](n,r)},r.login=function(e){let t=new RegExp(/^[a-zA-Z0-9._-]+$/);return!(!e||!t.test(e))},r.list=function(e,t){let n,o=typeof e;return("string"===o||"number"===o)&&(n="string"==typeof t.value[0]?t.source?t.source:t.value[0].split(","):t.value[0],!!Array.isArray(n)&&n.findIndex((function(t){return t==e}))>-1)};const i=function(){let e=new Date;return e.setHours(0,0,0,0),e},l={"one year ago":function(){let e=i();return e.setFullYear(e.getFullYear()-1),e},"one month ago":function(){let e=i();return e.setMonth(e.getMonth()-1),e},"one week ago":function(){let e=i();return e.setDate(e.getDate()-7),e},yesterday:function(){let e=i();return e.setDate(e.getDate()-1),e},today:i,tomorrow:function(){let e=i();return e.setDate(e.getDate()+1),e}};return r.date=function(t,o){if(e(t)&&t>0&&t<1e6&&(t=p.numToDate(t)),"Invalid Date"==new Date(t))return!1;if(!o||!o.criteria)return!0;if(!n[o.criteria])return!1;let r=o.value.map((function(e){return"string"==typeof e&&l[e]?l[e]().getTime():new Date(e).getTime()}));return n[o.criteria](new Date(t).getTime(),r)},r.text=function(e,t){if(null==e)e="";else if("string"!=typeof e)return!1;return!t||!t.criteria||!!o[t.criteria]&&o[t.criteria](e,t.value)},r.textLength=function(e,t){return e=e.toString(),r.number(e.length,t)},r}();var M=function(){var e=function(t,n){var o={options:{}},r={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(e,t){alert(t)}};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];o.options.validations||(o.options.validations={}),o.options.submitButton||(o.options.submitButton=t.querySelector("input[type=submit]")),o.options.submitButton&&o.options.url&&(o.options.submitButton.onclick=function(){o.save()}),o.options.validations.email||(o.options.validations.email=L.email),o.options.validations.length||(o.options.validations.length=L.length),o.options.validations.required||(o.options.validations.required=L.required),o.setUrl=function(e){o.options.url=e},o.load=function(){u({url:o.options.url,method:"GET",dataType:"json",queue:!0,success:function(n){if("function"==typeof o.options.onbeforeload){var r=o.options.onbeforeload(t,n);r&&(n=r)}e.setElements(t,n),"function"==typeof o.options.onload&&o.options.onload(t,n)}})},o.save=function(){var n=o.validate();if(n)o.options.onerror(t,n);else{var r=e.getElements(t,!0);if("function"==typeof o.options.onbeforesave&&!1===(r=o.options.onbeforesave(t,r)))return;u({url:o.options.url,method:"POST",dataType:"json",data:r,success:function(e){"function"==typeof o.options.onsave&&o.options.onsave(t,r,e)}})}},o.remove=function(){if("function"==typeof o.options.onbeforeremove&&!1===o.options.onbeforeremove(t,o))return!1;u({url:o.options.url,method:"DELETE",dataType:"json",success:function(e){"function"==typeof o.options.onremove&&o.options.onremove(t,o,e),o.reset()}})};var l=function(e){var n=!1;e.classList.remove("error"),e.removeAttribute("title");for(var r=t.querySelectorAll("input, select, textarea, div[name]"),i=0;i<r.length;i++)r[i].getAttribute("data-validation")&&r[i].classList.contains("error")&&(n=!0);o.options.submitButton&&(n?o.options.submitButton.setAttribute("disabled",!0):o.options.submitButton.removeAttribute("disabled"))};return o.validateElement=function(t){var n=!1,r=e.getValue(t),i=t.getAttribute("data-validation");return"function"!=typeof o.options.validations[i]||o.options.validations[i](r,t)?t.classList.contains("error")&&l(t):n=function(e){e.classList.add("error"),o.options.submitButton&&o.options.submitButton.setAttribute("disabled",!0);var t=e.getAttribute("data-error")||"There is an error in the form";return e.setAttribute("title",t),t}(t),n},o.reset=function(){for(var e=t.querySelectorAll("input, select, textarea, div[name]"),n=0;n<e.length;n++)e[n].getAttribute("name")&&("checkbox"==e[n].type||"radio"==e[n].type?e[n].checked=!1:"function"==typeof e[n].val?e[n].val(""):e[n].value="")},o.validate=function(){for(var e=[],n=t.querySelectorAll("input, select, textarea, div[name]"),r=0;r<n.length;r++)if(n[r].getAttribute("data-validation")){var i=o.validateElement(n[r]);i&&e.push(i)}return e.length>0&&e.join("<br>")},o.getError=function(){return!!o.validation()},o.setHash=function(){return o.getHash(e.getElements(t))},o.getHash=function(e){var t,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n},o.isChanged=function(){var e=o.setHash();return o.options.currentHash!=e},o.resetTracker=function(){o.options.currentHash=o.setHash(),o.options.ignore=!1},o.setIgnore=function(e){o.options.ignore=!!e},setTimeout((function(){o.options.currentHash=o.setHash()}),1e3),t.addEventListener("keyup",(function(e){e.target.getAttribute("data-validation")&&o.validateElement(e.target)})),e.hasEvents||(window.addEventListener("beforeunload",(function(e){if(o.isChanged()&&0==o.options.ignore){var t=o.options.message?o.options.message:"o/";return t?(void 0===e&&(e=window.event),e&&(e.returnValue=t),t):void 0}})),e.hasEvents=!0),t.form=o,o};return e.getValue=function(e){var t=null;if("checkbox"==e.type)1==e.checked&&(t=e.value||!0);else if("radio"==e.type)1==e.checked&&(t=e.value);else if("file"==e.type)t=e.files;else if("select"==e.tagName&&1==e.multiple){t=[];for(var n=e.querySelectorAll("options[selected]"),o=0;o<n.length;o++)t.push(n[o].value)}else t="function"==typeof e.val?e.val():e.value||"";return t},e.getElements=function(t,n){for(var o={},r=null,i=t.querySelectorAll("input, select, textarea, div[name]"),l=0;l<i.length;l++)(r=i[l].getAttribute("name"))&&(o[r]=e.getValue(i[l])||"");return 1==n?o:JSON.stringify(o)},e.setElements=function(e,t){for(var n=null,o=null,r=e.querySelectorAll("input, select, textarea, div[name]"),i=0;i<r.length;i++){var l=r[i].getAttribute("type");if(n=r[i].getAttribute("name")){if(o=null,(n=n.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)){var a=s.call(t,n)||"";void 0!==a&&(o=a)}else void 0!==t[n]&&(o=t[n]);null!==o&&("checkbox"==l||"radio"==l?r[i].checked=!!o:"file"==l||("function"==typeof r[i].val?r[i].val(o):r[i].value=o))}}},e}();var N=function(){var e=function(){var e=null;document.addEventListener("keydown",(function(e){if(27==e.which)for(var t=document.querySelectorAll(".jmodal"),n=0;n<t.length;n++)t[n].parentNode.modal.close()})),document.addEventListener("mouseup",(function(t){let n=t.composedPath();var o=l.findElement(n[0],"jmodal");if(o){var r=o.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var i=t.changedTouches[0].clientX,s=t.changedTouches[0].clientY;else i=t.clientX,s=t.clientY;r.width-(i-r.left)<50&&s-r.top<50&&o.parentNode.modal.close()}e&&(e.element.style.cursor="auto",e=null)})),document.addEventListener("mousedown",(function(t){let n=t.composedPath();var o=l.findElement(n[0],"jmodal");if(o){var r=o.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0])var i=t.changedTouches[0].clientX,s=t.changedTouches[0].clientY;else i=t.clientX,s=t.clientY;r.width-(i-r.left)<50&&s-r.top<50||s-r.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),e={left:r.left,top:r.top,x:t.clientX,y:t.clientY,width:r.width,height:r.height,element:o})}})),document.addEventListener("mousemove",(function(t){if(e){if((t=t||window.event).buttons)var n=t.buttons;else n=t.button?t.button:t.which;n?(e.element.style.top=e.top+(t.clientY-e.y)+e.height/2+"px",e.element.style.left=e.left+(t.clientX-e.x)+e.width/2+"px",e.element.style.cursor="move"):e.element.style.cursor="auto"}}))};return function(t,n){var o={options:{}},r={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];!o.options.title&&t.getAttribute("title")&&(o.options.title=t.getAttribute("title"));for(var s=document.createElement("div");t.children[0];)s.appendChild(t.children[0]);for(o.title=document.createElement("div"),o.title.className="jmodal_title",o.options.icon&&o.title.setAttribute("data-icon",o.options.icon),o.content=document.createElement("div"),o.content.className="jmodal_content",o.content.innerHTML=t.innerHTML;s.children[0];)o.content.appendChild(s.children[0]);if(o.container=document.createElement("div"),o.container.className="jmodal",o.container.appendChild(o.title),o.container.appendChild(o.content),o.options.padding&&(o.content.style.padding=o.options.padding),o.options.width&&(o.container.style.width=o.options.width),o.options.height&&(o.container.style.height=o.options.height),o.options.title){var a=document.createElement("h4");a.innerText=o.options.title,o.title.appendChild(a)}if(t.innerHTML="",t.style.display="none",t.appendChild(o.container),o.options.backdrop){var c=document.createElement("div");c.className="jmodal_backdrop",c.onclick=function(){o.close()},t.appendChild(c)}return o.open=function(){t.style.display="block";var e=o.container.getBoundingClientRect();l.getWindowWidth()<e.width?(o.container.style.top="",o.container.style.left="",o.container.classList.add("jmodal_fullscreen"),d.slideBottom(o.container,1)):o.options.backdrop&&(c.style.display="block"),"function"==typeof o.options.onopen&&o.options.onopen(t,o)},o.resetPosition=function(){o.container.style.top="",o.container.style.left=""},o.isOpen=function(){return"none"!=t.style.display},o.close=function(){o.isOpen()&&(t.style.display="none",o.options.backdrop&&(c.style.display=""),o.container.classList.remove("jmodal_fullscreen"),"function"==typeof o.options.onclose&&o.options.onclose(t,o))},o.options.url?u({url:o.options.url,method:"GET",dataType:"text/html",success:function(e){o.content.innerHTML=e,o.options.closed||o.open(),"function"==typeof o.options.onload&&o.options.onload(o)}}):(o.options.closed||o.open(),"function"==typeof o.options.onload&&o.options.onload(o)),t.modal=o,e(),e=function(){},o}}();var I=function(){var e=function(e){var t={options:{}},n={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var o in n)e&&e.hasOwnProperty(o)?t.options[o]=e[o]:t.options[o]=n[o];var r=document.createElement("div");r.className="jnotification",t.options.error&&r.classList.add("jnotification-error");var i=document.createElement("div");i.className="jnotification-container",r.appendChild(i);var s=document.createElement("div");s.className="jnotification-header",i.appendChild(s);var a=document.createElement("div");if(a.className="jnotification-image",s.appendChild(a),t.options.icon){var c=document.createElement("img");c.src=t.options.icon,a.appendChild(c)}var u=document.createElement("div");if(u.className="jnotification-name",u.innerHTML=t.options.name,s.appendChild(u),1==t.options.closeable){var p=document.createElement("div");p.className="jnotification-close",p.onclick=function(){t.hide()},s.appendChild(p)}var f=document.createElement("div");f.className="jnotification-date",s.appendChild(f);var h=document.createElement("div");if(h.className="jnotification-content",i.appendChild(h),t.options.title){var g=document.createElement("div");g.className="jnotification-title",g.innerHTML=t.options.title,h.appendChild(g)}var m=document.createElement("div");if(m.className="jnotification-message",m.innerHTML=t.options.message,h.appendChild(m),t.show=function(){document.body.appendChild(r),l.getWindowWidth()>800?d.fadeIn(r):d.slideTop(r,1)},t.hide=function(){l.getWindowWidth()>800?d.fadeOut(r,(function(){r.parentNode&&(r.parentNode.removeChild(r),b&&clearTimeout(b))})):d.slideTop(r,0,(function(){r.parentNode&&(r.parentNode.removeChild(r),b&&clearTimeout(b))}))},t.show(),1==t.options.autoHide)var b=setTimeout((function(){t.hide()}),t.options.timeout);return l.getWindowWidth()<800&&r.addEventListener("swipeup",(function(e){t.hide(),e.preventDefault(),e.stopPropagation()})),t};return e.isVisible=function(){var e=document.querySelector(".jnotification");return!(!e||!e.parentNode)},e}();function T(e,t){if(e.search)return e.search;var n=null,o=function(t){if("function"==typeof i.options.onsearch){var n=i.options.onsearch(i,t);n&&(t=n)}if(s.innerHTML="",t.length){e.style.display="block";for(var o=t.length<11?t.length:10,r=0;r<o;r++){if("string"==typeof t[r])var l=t[r],a=t[r];else!(l=t[r].text)&&t[r].name&&(l=t[r].name),!(a=t[r].value)&&t[r].id&&(a=t[r].id);var c=document.createElement("div");c.setAttribute("data-value",a),c.setAttribute("data-text",l),c.className="jsearch_item",t[r].id&&c.setAttribute("id",t[r].id),i.options.forceSelect&&0==r&&c.classList.add("selected");var u=document.createElement("img");t[r].image?u.src=t[r].image:u.style.display="none",c.appendChild(u);var d=document.createElement("div");d.innerHTML=l,c.appendChild(d),s.appendChild(c)}}else e.style.display=""},r=null,i=function(e){r&&clearTimeout(r),r=setTimeout((function(){!function(e){if(e!=i.terms)if(i.terms=e,n=i.options.forceSelect?0:null,Array.isArray(i.options.data)){var t=function(t){if("string"==typeof t){if((""+t).toLowerCase().search(e.toLowerCase())>=0)return!0}else for(var n in t)if((""+t[n]).toLowerCase().search(e.toLowerCase())>=0)return!0;return!1},r=i.options.data.filter((function(e){return t(e)}));o(r)}else u({url:i.options.data+e,method:"GET",dataType:"json",success:function(e){o(e)}})}(e)}),500)};null===t.forceSelect&&(t.forceSelect=!0),i.options={data:t.data||null,input:t.input||null,searchByNode:t.searchByNode||null,onselect:t.onselect||null,forceSelect:t.forceSelect,onsearch:t.onsearch||null,onbeforesearch:t.onbeforesearch||null},i.selectIndex=function(e){var t=e.getAttribute("id"),n=e.getAttribute("data-text"),o=e.getAttribute("data-value"),r=e.children[0].src||"";"function"==typeof i.options.onselect&&i.options.onselect(i,n,o,t,r),i.close()},i.open=function(){e.style.display="block"},i.close=function(){r&&clearTimeout(r),i.terms="",s.innerHTML="",e.style.display=""},i.isOpened=function(){return!!e.style.display},i.keydown=function(e){i.isOpened()&&("Enter"==e.key?null!==n&&s.children[n]?(i.selectIndex(s.children[n]),e.preventDefault()):i.close():"ArrowUp"===e.key?(null!==n&&s.children[0]&&(s.children[n].classList.remove("selected"),i.options.forceSelect||0!==n?(n=Math.max(0,n-1),s.children[n].classList.add("selected")):n=null),e.preventDefault()):"ArrowDown"===e.key&&(null==n?n=-1:s.children[n].classList.remove("selected"),n<9&&s.children[n+1]&&n++,s.children[n].classList.add("selected"),e.preventDefault()))},i.keyup=function(e){if(!i.options.searchByNode&&i.options.input)if("DIV"===i.options.input.tagName)var t=i.options.input.innerText;else t=i.options.input.value;else{var n=l.getNode();n&&(t=n.innerText)}if("function"==typeof i.options.onbeforesearch){var o=i.options.onbeforesearch(i,t);if(o)t=o;else if(!1===o)return}i(t)},i.blur=function(e){i.close()},i.options.input&&(i.options.input.addEventListener("keyup",i.keyup),i.options.input.addEventListener("keydown",i.keydown),i.options.input.addEventListener("blur",i.blur));var s=document.createElement("div");return s.classList.add("jsearch_container"),s.onmousedown=function(e){if(e.target.classList.contains("jsearch_item"))var t=e.target;else t=e.target.parentNode;i.selectIndex(t),e.preventDefault()},e.appendChild(s),e.classList.add("jsearch"),e.search=i,i}function D(e,n){var o={options:{}},r={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var i in r)n&&n.hasOwnProperty(i)?o.options[i]=n[i]:o.options[i]=r[i];1==o.options.multiple&&e.setAttribute("data-multiple",!0),e.content=[],e.classList.add("jupload"),1==o.options.input&&e.classList.add("input"),o.add=function(t){if(0==o.options.multiple&&(e.content=[],e.innerText=""),"image"==o.options.type){var n=document.createElement("img");n.setAttribute("src",t.file),n.setAttribute("tabindex",-1),e.getAttribute("name")||(n.className="jfile",n.content=t),e.appendChild(n)}else{if(t.name)var r=t.name;else r=t.file;var i=document.createElement("div");i.innerText=r||o.options.type,i.classList.add("jupload-item"),i.setAttribute("tabindex",-1),e.appendChild(i)}t.content&&(t.file=l.guid()),e.content.push(t),"function"==typeof o.options.onchange&&o.options.onchange(e,t)},o.addFromFile=function(e){if(e.type.split("/")[0]==o.options.type){var n=new FileReader;n.addEventListener("load",(function(t){var n={file:t.srcElement.result,extension:e.name.substr(e.name.lastIndexOf(".")+1),name:e.name,size:e.size,lastmodified:e.lastModified,content:t.srcElement.result};o.add(n)})),n.readAsDataURL(e)}else alert(t.translate("This extension is not allowed"))},o.addFromUrl=function(e){if("data"==e.substr(0,4)||o.options.remoteParser)if("data"==e.substr(0,4)){var t=e.split(";");if((t=t[0].split("/"))[0].replace("data:","")==o.options.type){var n={file:e,name:"",extension:t[1],content:e};o.add(n)}else alert(o.options.text.extensionNotAllowed)}else t=e.substr(e.lastIndexOf(".")+1),e=o.options.remoteParser+e,u({url:e,type:"GET",dataType:"blob",success:function(e){}});else console.error("remoteParser not defined in your initialization")};var s=o.options.type+"/"+o.options.extension,a=document.createElement("input");a.type="file",a.setAttribute("accept",s),a.onchange=function(){for(var e=0;e<this.files.length;e++)o.addFromFile(this.files[e])},1==o.options.multiple&&a.setAttribute("multiple",!0);var c=null;return e.addEventListener("click",(function(t){c=null,e.children.length&&t.target!==e?t.target.parentNode==e&&(c=t.target):l.click(a)})),e.addEventListener("dblclick",(function(e){l.click(a)})),e.addEventListener("dragenter",(function(t){e.style.border="1px dashed #000"})),e.addEventListener("dragleave",(function(t){e.style.border="1px solid #eee"})),e.addEventListener("dragstop",(function(t){e.style.border="1px solid #eee"})),e.addEventListener("dragover",(function(e){e.preventDefault()})),e.addEventListener("keydown",(function(t){if(c&&46==t.which){var n=Array.prototype.indexOf.call(e.children,c);n>=0&&(e.content.splice(n,1),c.remove(),c=null)}})),e.addEventListener("drop",(function(t){t.preventDefault(),t.stopPropagation();var n=(t.originalEvent||t).dataTransfer.getData("text/html");if((t.originalEvent||t).dataTransfer.files.length)for(var r=0;r<t.dataTransfer.files.length;r++)o.addFromFile(t.dataTransfer.files[r]);else if(n){0==o.options.multiple&&(e.innerText="");var i=document.createElement("div");i.innerHTML=n;var l=i.querySelectorAll("img");if(l.length)for(r=0;r<l.length;r++)o.addFromUrl(l[r].src)}return e.style.border="1px solid #eee",!1})),e.val=function(t){if(void 0===t)return e.content&&e.content.length?e.content:null;if(e.innerText="",e.content=[],t)if(Array.isArray(t))for(var n=0;n<t.length;n++)"string"==typeof t[n]?o.add({file:t[n]}):o.add(t[n]);else"string"==typeof t&&o.add({file:t})},e.upload=e.image=o,o}var S=o(195),O=o.n(S),k={...t,...l,version:"5.8.0",setExtensions:function(e){if("object"==typeof e)for(var t=Object.keys(e),n=0;n<t.length;n++)k[t[n]]=e[t[n]]},tracking:n,path:s,sorting:a,lazyLoading:c,ajax:u,animation:d,calendar:h,color:b,contextmenu:j,dropdown:v,editor:E,floating:A,form:M,mask:f,modal:N,notification:I,palette:g,picker:w,progressbar:function(e,t){var n={options:{}},o={value:0,onchange:null,width:null};for(var r in o)t&&t.hasOwnProperty(r)?n.options[r]=t[r]:n.options[r]=o[r];e.classList.add("jprogressbar"),e.setAttribute("tabindex",1),e.setAttribute("data-value",n.options.value);var i=document.createElement("div");i.style.width=n.options.value+"%",i.style.color="#fff",e.appendChild(i),n.options.width&&(e.style.width=n.options.width),n.setValue=function(t){t=parseInt(t),n.options.value=t,i.style.width=t+"%",e.setAttribute("data-value",t+"%"),e.style.color=t<6?"#000":"#fff",n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},n.getValue=function(){return n.options.value};var l=function(t){if(t.which){var o=e.getBoundingClientRect();if(t.changedTouches&&t.changedTouches[0]){var r=t.changedTouches[0].clientX;t.changedTouches[0].clientY}else r=t.clientX,t.clientY;n.setValue(Math.round((r-o.left)/o.width*100))}};return"touchstart"in document.documentElement==1?(e.addEventListener("touchstart",l),e.addEventListener("touchend",l)):(e.addEventListener("mousedown",l),e.addEventListener("mousemove",l)),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.progressbar=n,n},rating:function(e,t){if(e.rating)return e.rating.setOptions(t,!0);var n={options:{},setOptions:function(t,o){var r={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var i in r)t&&t.hasOwnProperty(i)?n.options[i]=t[i]:void 0!==n.options[i]&&!0!==o||(n.options[i]=r[i]);e.innerHTML="";for(var l=0;l<n.options.number;l++){var s=document.createElement("div");s.setAttribute("data-index",l+1),s.setAttribute("title",n.options.tooltip[l]),e.appendChild(s)}if(n.options.value)for(l=0;l<n.options.number;l++)l<n.options.value&&e.children[l].classList.add("jrating-selected");return n},setValue:function(t){for(var o=0;o<n.options.number;o++)o<t?e.children[o].classList.add("jrating-selected"):(e.children[o].classList.remove("jrating-over"),e.children[o].classList.remove("jrating-selected"));n.options.value=t,"function"==typeof n.options.onchange&&n.options.onchange(e,t),e.value!=n.options.value&&(e.value=n.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))},getValue:function(){return n.options.value}};return n.setOptions(t),e.classList.add("jrating"),e.addEventListener("click",(function(e){var t=e.target.getAttribute("data-index");null!=t&&(t==n.options.value?n.setValue(0):n.setValue(t))})),e.addEventListener("mouseover",(function(t){for(var o=t.target.getAttribute("data-index"),r=0;r<n.options.number;r++)r<o?e.children[r].classList.add("jrating-over"):e.children[r].classList.remove("jrating-over")})),e.addEventListener("mouseout",(function(t){for(var o=0;o<n.options.number;o++)e.children[o].classList.remove("jrating-over")})),e.change=n.setValue,e.val=function(e){if(void 0===e)return n.getValue();n.setValue(e)},e.rating=n,n},search:T,slider:function(e,t){var n={options:{},currentImage:null};if(t&&(n.options=t),e.setAttribute("tabindex","900"),n.options.items=[],!e.classList.contains("jslider")){if(e.classList.add("jslider"),e.classList.add("unselectable"),n.options.height&&(e.style.minHeight=parseInt(n.options.height)+"px"),n.options.width&&(e.style.width=parseInt(n.options.width)+"px"),n.options.grid){e.classList.add("jslider-grid");var o=e.children.length;o>4&&e.setAttribute("data-total",o-4),e.setAttribute("data-number",o>4?4:o)}var r=document.createElement("div");if(r.classList.add("jslider-counter"),e.children.length>0)for(var i=0;i<e.children.length;i++){n.options.items.push(e.children[i]);var l=document.createElement("div");l.onclick=function(){var e=Array.prototype.slice.call(r.children).indexOf(this);n.show(n.currentImage=n.options.items[e])},r.appendChild(l)}var s=document.createElement("div");s.className="jslider-caption";var a=document.createElement("div"),c=document.createElement("div");c.className="jslider-close",c.innerHTML="",c.onclick=function(){n.close()},a.appendChild(s),a.appendChild(c)}n.updateCounter=function(e){for(var t=0;t<r.children.length;t++)if(r.children[t].classList.contains("jslider-counter-focus")){r.children[t].classList.remove("jslider-counter-focus");break}r.children[e].classList.add("jslider-counter-focus")},n.show=function(t){t||(t=e.children[0]),e.classList.add("jslider-focus"),e.classList.remove("jslider-grid"),e.appendChild(a),e.appendChild(r);var o=n.options.items.indexOf(t);n.updateCounter(o);for(var i=0;i<e.children.length;i++)e.children[i].style.display="";t.style.display="block",t.previousElementSibling?e.classList.add("jslider-left"):e.classList.remove("jslider-left"),t.nextElementSibling&&"IMG"==t.nextElementSibling.tagName?e.classList.add("jslider-right"):e.classList.remove("jslider-right"),n.currentImage=t,n.currentImage.offsetHeight>n.currentImage.offsetWidth&&n.currentImage.classList.add("jslider-vertical"),a.children[0].innerText=n.currentImage.getAttribute("title")},n.open=function(){n.show(),"function"==typeof n.options.onopen&&n.options.onopen(e)},n.close=function(){e.classList.remove("jslider-focus"),e.classList.remove("jslider-left"),e.classList.remove("jslider-right"),n.options.grid&&e.classList.add("jslider-grid");for(var t=0;t<e.children.length;t++)e.children[t].style.display="";r.remove(),a.remove(),n.currentImage=null,"function"==typeof n.options.onclose&&n.options.onclose(e)},n.reset=function(){e.innerHTML=""},n.next=function(){var e=n.currentImage.nextElementSibling;e&&"IMG"===e.tagName&&n.show(n.currentImage.nextElementSibling)},n.prev=function(){n.currentImage.previousElementSibling&&n.show(n.currentImage.previousElementSibling)};var u=function(e){if("IMG"==e.target.tagName)n.show(e.target);else if(!e.target.classList.contains("jslider-close")&&!e.target.parentNode.classList.contains("jslider-counter")&&!e.target.classList.contains("jslider-counter")){var t=e.offsetX||e.changedTouches[0].clientX;e.target.clientWidth-t<40?n.next():t<40&&n.prev()}};return"ontouchend"in document.documentElement==1?e.addEventListener("touchend",u):e.addEventListener("mouseup",u),e.addEventListener("swipeleft",(function(e){n.next(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("swiperight",(function(e){n.prev(),e.preventDefault(),e.stopPropagation()})),e.addEventListener("keydown",(function(e){27==e.which&&n.close()})),e.slider=n,n},tabs:m,tags:function(e,n){if(e.tags)return e.tags.setOptions(n,!0);var o={type:"tags",options:{}},r=function(){return!!(o.options.limit&&e.children.length>=o.options.limit)},i=null,s=null;o.setOptions=function(t,n){var r={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var l in r)t&&t.hasOwnProperty(l)?o.options[l]=t[l]:void 0!==o.options[l]&&!0!==n||(o.options[l]=r[l]);return o.options.placeholder?e.setAttribute("data-placeholder",o.options.placeholder):e.removeAttribute("data-placeholder"),e.placeholder=o.options.placeholder,o.setValue(o.options.value),d(),o.options.search?s||(s=document.createElement("div"),e.parentNode.insertBefore(s,e.nextSibling),i=T(s,{data:o.options.search,onselect:function(e,t,n){o.selectIndex(t,n)}})):s&&(i=null,s.remove(),s=null),o},o.add=function(n,s){if("function"==typeof o.options.onbeforechange){var d=o.options.onbeforechange(e,o,o.options.value,n);if(!1===d)return!1;null!=d&&(n=d)}if(i&&i.close(),r())"function"==typeof o.options.onlimit?o.options.onlimit(o,o.options.limit):alert(t.translate("You reach the limit number of entries")+" "+o.options.limit);else{var p=l.getNode();if(!(p&&p.parentNode&&p.parentNode.classList.contains("jtags")&&p.nextSibling)||p.nextSibling.innerText&&p.nextSibling.innerText.trim()){if(e.lastChild&&(e.lastChild.innerText.trim()||e.removeChild(e.lastChild)),n&&"string"!=typeof n){for(var f=0;f<=n.length;f++)if(!r()){if(n[f]&&"string"!=typeof n[f])h=n[f].text,g=n[f].value;else var h=n[f]||"",g=null;m=c(h,g)}}else var m=c(n,n,p);u()}else m=p.nextSibling;s&&a(m)}},o.setLimit=function(t){for(o.options.limit=t,e.children.length;e.children.length>t;)e.removeChild(e.lastChild)},o.remove=function(t){t.parentNode.removeChild(t),e.children.length?u():o.add("",!0),"function"==typeof o.options.onremoveitem&&o.options.onremoveitem(e,o,t)},o.getData=function(){for(var t=[],n=0;n<e.children.length;n++){var o=e.children[n].innerText.replace("\n",""),r=e.children[n].getAttribute("data-value");r||(r=o),(o||r)&&t.push({text:o,value:r})}return t},o.getValue=function(t){var n=null;if(null!=t)(n=e.children[t].getAttribute("data-value"))||(n=e.children[t].innerText.replace("\n",""));else{for(var r=[],i=0;i<e.children.length;i++)(n=e.children[i].innerText.replace("\n",""))&&r.push(o.getValue(i));n=r.join(",")}return n},o.setValue=function(t){if(t){if(e.value!=t)if(Array.isArray(t))o.add(t);else{var n=(""+t).trim(),r=f(n);e.innerHTML="",o.add(r)}}else o.reset()},o.reset=function(){e.classList.add("jtags-empty"),e.innerHTML="<div></div>",u()},o.isValid=function(){for(var t=0,n=0;n<e.children.length;n++)e.children[n].classList.contains("jtags_error")&&t++;return 0==t},o.selectIndex=function(e,t){var n=l.getNode();n&&(n.innerText=e,t&&n.setAttribute("data-value",t),n.classList.remove("jtags_error"),r()||o.add("",!0))},o.search=function(e){e.innerText},o.destroy=function(){e.removeEventListener("mouseup",j),e.removeEventListener("keydown",g),e.removeEventListener("keyup",m),e.removeEventListener("paste",b),e.removeEventListener("focus",v),e.removeEventListener("blur",y),e.parentNode.removeChild(e)};var a=function(t){if(e.children.length){var n=document.createRange(),o=window.getSelection();t||(t=e.childNodes[e.childNodes.length-1]),n.setStart(t,t.length),n.collapse(!0),o.removeAllRanges(),o.addRange(n),e.scrollLeft=e.scrollWidth}},c=function(t,n,o){var r=document.createElement("div");return r.textContent=t||"",n&&r.setAttribute("data-value",n),o&&o.parentNode.classList.contains("jtags")?e.insertBefore(r,o.nextSibling):e.appendChild(r),r},u=function(){var t=o.getValue();t!=o.options.value&&(o.options.value=t,"function"==typeof o.options.onchange&&o.options.onchange(e,o,o.options.value),e.value!=o.options.value&&(e.value=o.options.value,"function"==typeof e.oninput&&e.oninput({type:"input",target:e,value:e.value}))),d()},d=function(){for(var t=0;t<e.children.length;t++)"DIV"===e.children[t].tagName&&(o.getValue(t)?(e.children[t].classList.add("jtags_label"),"function"==typeof o.options.validation&&o.getValue(t)?o.options.validation(e.children[t],e.children[t].innerText,e.children[t].getAttribute("data-value"))?e.children[t].classList.remove("jtags_error"):e.children[t].classList.add("jtags_error"):e.children[t].classList.remove("jtags_error")):e.children[t].classList.remove("jtags_label"));p()},p=function(){e.innerText.trim()?e.classList.remove("jtags-empty"):e.children.length&&"BR"!==e.children[0].tagName||(e.innerHTML="",a(c()))},f=function(e){var t=[],n="";if(e=e.trim()){for(var o=0;o<e.length;o++)","==e[o]||";"==e[o]||"\n"==e[o]?n&&(t.push(n.trim()),n=""):n+=e[o];n&&t.push(n)}return t},h=0,g=function(t){if(h=window.getSelection().anchorOffset,p(),"Tab"===t.key||";"===t.key||","===t.key){var n=window.getSelection().anchorOffset;n>1&&(r()?"function"==typeof o.options.onlimit&&o.options.onlimit(o,o.options.limit):o.add("",!0)),t.preventDefault()}else"Enter"==t.key?i&&i.isOpened()||((n=window.getSelection().anchorOffset)>1&&(r()||o.add("",!0)),t.preventDefault()):"Backspace"==t.key&&1==e.children.length&&window.getSelection().anchorOffset<1&&t.preventDefault();i&&i.keydown(t),p()},m=function(e){if(39==e.which){var t=window.getSelection().anchorOffset;t>1&&t==h&&o.add("",!0)}else 13==e.which||38==e.which||40==e.which?e.preventDefault():i&&i.keyup(e);d()},b=function(t){if(t.clipboardData||t.originalEvent.clipboardData)var n=(t.originalEvent||t).clipboardData.getData("text/plain");else window.clipboardData&&(n=window.clipboardData.getData("Text"));var r=f(n);if("function"==typeof o.options.onbeforepaste){var i=o.options.onbeforepaste(e,o,r);if(!1===i)return t.preventDefault(),!1;i&&(r=i)}r.length>1?(o.add(r,!0),t.preventDefault()):r[0]&&(document.execCommand("insertText",!1,r[0]),t.preventDefault())},j=function(t){if(t.target.parentNode&&t.target.parentNode.classList.contains("jtags")&&(t.target.classList.contains("jtags_label")||t.target.classList.contains("jtags_error"))){var n=t.target.getBoundingClientRect();n.width-(t.clientX-n.left)<16&&o.remove(t.target)}t.target==e&&a()},v=function(){e.classList.contains("jtags-focus")||(e.children.length&&!o.getValue(e.children.length-1)||r()||c(""),"function"==typeof o.options.onfocus&&o.options.onfocus(e,o,o.getValue()),e.classList.add("jtags-focus"))},y=function(){if(e.classList.contains("jtags-focus")){i&&i.close();for(var t=0;t<e.children.length-1;t++)o.getValue(t)||e.removeChild(e.children[t]);u(),e.classList.remove("jtags-focus"),"function"==typeof o.options.onblur&&o.options.onblur(e,o,o.getValue())}};return"touchend"in document.documentElement==1?e.addEventListener("touchend",j):e.addEventListener("mouseup",j),e.addEventListener("keydown",g),e.addEventListener("keyup",m),e.addEventListener("paste",b),e.addEventListener("focus",v),e.addEventListener("blur",y),e.setAttribute("contenteditable",!0),e.classList.add("jtags"),o.setOptions(n),"function"==typeof o.options.onload&&o.options.onload(e,o),e.change=o.setValue,e.val=function(e){if(void 0===e)return o.getValue();o.setValue(e)},e.tags=o,o},toolbar:C,upload:D,validations:L};k.image=D,k.image.create=function(e){var t=document.createElement("img");return t.setAttribute("src",e.file),t.className="jfile",t.setAttribute("tabindex",-1),t.content=e,t},k.tracker=M,k.loading=d.loading,k.sha512=O();"undefined"!=typeof document&&function(){if(void 0!==window.jSuitesStateControl)return;window.jSuitesStateControl=[];const e=function(t,n){return!(!t[n.type]||t[n.type]!=n)||!(!t.component||t.component!=n)||!!t.parentNode&&e(t.parentNode,n)},t=function(t){let n=window.jSuitesStateControl;if(n&&n.length>0)for(let o=0;o<n.length;o++)n[o]&&!e(t,n[o])&&n[o].close()};let n=15,o=!1,r={x:null,y:null},i=document.createElement("div");i.classList.add("jtooltip");const l=function(e){return e&&(e.shadowRoot||e.tagName&&e.tagName.includes("-"))},s=function(e){let t,n,o=e.path||e.composedPath&&e.composedPath();return o?(n=o[0],n&&l(n)&&!n.shadowRoot&&e.toElement&&(n=e.toElement)):(t=e.target&&l(e.target)?e.target.shadowRoot:document,n=t.elementFromPoint(x,y)),n};let a,c=["n","ne","e","se","s","sw","w","nw","rotate"];c.forEach((function(e,t){c[t]=document.createElement("div"),c[t].classList.add("jpanel-action"),"rotate"===e?c[t].setAttribute("data-action","rotate"):(c[t].setAttribute("data-action","resize"),c[t].setAttribute("data-position",e+"-resize"))}));const u=function(e){let t=s(e),n=k.findElement(t,"jpanel");n&&!n.classList.contains("readonly")&&n.classList.contains("jpanel-controls")?(n.append(...c),n.classList.contains("jpanel-rotate")||c[c.length-1].remove(),a=n):d(e)},d=function(e){a&&(c.forEach((function(e){e.remove()})),a=null)};document.addEventListener("focusin",u),document.addEventListener("mouseup",(function(e){o&&o.e&&("function"==typeof o.e.refresh&&r.actioned&&o.e.refresh(),o.e.style.cursor=""),r={x:null,y:null},o=!1})),document.addEventListener("mousedown",(function(e){if(e.changedTouches&&e.changedTouches[0])var n=e.changedTouches[0].clientX,r=e.changedTouches[0].clientY;else n=e.clientX,r=e.clientY;let i=s(e),l=i&&"DIV"===i.tagName&&i.getAttribute("contentEditable"),a=k.findElement(i,"jpanel");if(!a||a.classList.contains("readonly")||l)o=!1;else{let e=a.getBoundingClientRect(),t=0;a.style.rotate&&(t=parseFloat(a.style.rotate));let l="move";i.getAttribute("data-action")?l=i.getAttribute("data-action"):a.style.cursor?l="resize":a.style.cursor="move",o={action:l,a:t,e:a,x:n,y:r,l:e.left,t:e.top,b:e.bottom,r:e.right,w:e.width,h:e.height,d:a.style.cursor,actioned:!1},a.style.width||(a.style.width=e.width+"px"),a.style.height||(a.style.height=e.height+"px")}t(i),u(e)})),document.addEventListener("mousemove",(function(e){if(o){let n=e.clientX||e.pageX,s=e.clientY||e.pageY;if(null==r.x&&null==r.y&&(r.x=n,r.y=s),"move"===o.action){var t=n-r.x,i=s-r.y,l=o.e.offsetTop+i,a=o.e.offsetLeft+t;o.e.style.top=l+"px",o.e.style.left=a+"px","function"==typeof o.e.refresh&&(r.actioned=!0,o.e.refresh("position",l,a))}else if("rotate"===o.action){let e=function(e,t,n,o,r,i){const l=n-e,s=o-t,a=r-e,c=i-t;let u=Math.atan2(s,l),d=Math.atan2(c,a)-u;return d*=180/Math.PI,d<0&&(d+=360),d}(o.l+o.w/2,o.t+o.h/2,o.x,o.y,n,s);e+=o.a%360,e=2*Math.round(e/2),o.e.style.rotate=`${e}deg`,"function"==typeof o.e.refresh&&(r.actioned=!0,o.e.refresh("rotate",e))}else if("resize"===o.action){let t=null,i=null,l=null,a=null;"e-resize"==o.d||"ne-resize"==o.d||"se-resize"==o.d?(l=o.e.offsetWidth+(n-r.x),e.shiftKey&&(a=o.e.offsetHeight+(n-r.x)*(o.e.offsetHeight/o.e.offsetWidth))):"w-resize"!==o.d&&"nw-resize"!=o.d&&"sw-resize"!=o.d||(i=o.e.offsetLeft+(n-r.x),l=o.e.offsetLeft+o.e.offsetWidth-i,e.shiftKey&&(a=o.e.offsetHeight-(n-r.x)*(o.e.offsetHeight/o.e.offsetWidth))),"s-resize"==o.d||"se-resize"==o.d||"sw-resize"==o.d?a||(a=o.e.offsetHeight+(s-r.y)):"n-resize"!==o.d&&"ne-resize"!=o.d&&"nw-resize"!=o.d||(t=o.e.offsetTop+(s-r.y),a=o.e.offsetTop+o.e.offsetHeight-t),t&&(o.e.style.top=t+"px"),i&&(o.e.style.left=i+"px"),l&&(o.e.style.width=l+"px"),a&&(o.e.style.height=a+"px"),"function"==typeof o.e.refresh&&(r.actioned=!0,o.e.refresh("dimensions",l,a))}r.x=n,r.y=s}else{let t=s(e),o=k.findElement(t,"jpanel");if(o)if(o.classList.contains("jpanel-controls")){let e=t.getAttribute("data-position");o.style.cursor=e||""}else if(o.getAttribute("tabindex")){let t=o.getBoundingClientRect();e.clientY-t.top<n?t.width-(e.clientX-t.left)<n?o.style.cursor="ne-resize":e.clientX-t.left<n?o.style.cursor="nw-resize":o.style.cursor="n-resize":t.height-(e.clientY-t.top)<n?t.width-(e.clientX-t.left)<n?o.style.cursor="se-resize":e.clientX-t.left<n?o.style.cursor="sw-resize":o.style.cursor="s-resize":t.width-(e.clientX-t.left)<n?o.style.cursor="e-resize":e.clientX-t.left<n?o.style.cursor="w-resize":o.style.cursor=""}}})),document.addEventListener("mouseover",(function(e){var t=s(e).getAttribute("data-tooltip");if(t){if(i.innerText=t,e.changedTouches&&e.changedTouches[0])var n=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY;else n=e.clientX,o=e.clientY;i.style.top=o+"px",i.style.left=n+"px",document.body.appendChild(i)}else i.innerText&&(i.innerText="",document.body.removeChild(i))})),document.addEventListener("keydown",(function(e){let t=document.activeElement;t&&"Delete"===e.key&&"function"==typeof t.delete&&(t.delete(),e.preventDefault(),e.stopImmediatePropagation());let n=window.jSuitesStateControl;n&&n.length>0&&(t=n[n.length-1],t&&"Escape"===e.key&&"function"==typeof t.isOpened&&"function"==typeof t.close&&t.isOpened()&&(t.close(),e.preventDefault(),e.stopImmediatePropagation()))})),document.addEventListener("contextmenu",(function(e){var t=document.activeElement;if(t&&"function"==typeof t.contextmenu)t.contextmenu(e),e.preventDefault(),e.stopImmediatePropagation();else if(t=k.findElement(e.target,(function(e){return e.tagName&&e.getAttribute("aria-contextmenu-id")})),t){var n=document.querySelector("#"+t);n?(n.contextmenu.open(e),e.preventDefault(),e.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+t)}})),document.addEventListener("input",(function(e){(e.target.getAttribute("data-mask")||e.target.mask)&&k.mask(e)}))}();var R=k}(),e=r.default}(),e}()}}]);