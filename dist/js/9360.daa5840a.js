"use strict";(self.webpackChunkconstruction_commercial_search_frontend=self.webpackChunkconstruction_commercial_search_frontend||[]).push([[9360],{39360:function(t,a,e){e.r(a),e.d(a,{default:function(){return n}});var s=(e(44114),{components:{ClassicTable:()=>e.e(440).then(e.bind(e,30440)),GeneralButton:()=>e.e(695).then(e.bind(e,90695)),DownloadAndView:()=>e.e(1004).then(e.bind(e,71004))},props:{companyData:{type:Object,required:!0},marketResearchData:{type:Object,required:!0},searchQuery:{type:String,default:""}},data:()=>({followUpHeaders:[{key:"updateDate",value:"Last Update",sortable:!1},{key:"note",value:"Note",sortable:!1}],headers:[{key:"productName",value:"Product Name",sortable:!1},{key:"dateOfPriceAdded",value:"Date Input",sortable:!1},{key:"price",value:"Price",sortable:!1},{key:"unit",value:"Unit",sortable:!1},{key:"score",value:"Score",sortable:!1},{key:"quotation",value:"Quotation",sortable:!1}],productStatus:Object.freeze({NOT_ADDED:"To be added",NOT_PRODUCED:"Not produced",AVAILABLE:"Available"})}),methods:{getProductDetailsStatus(t){let a={dateOfPriceAdded:this.productStatus.NOT_ADDED,price:this.productStatus.NOT_ADDED,unit:this.productStatus.NOT_ADDED,score:this.productStatus.NOT_ADDED,quotation:this.productStatus.NOT_ADDED};if(isNaN(parseFloat(t?.quotation?.price))||(a.price=a.unit=this.productStatus.AVAILABLE),t?.quotation?.score&&(a.score=this.productStatus.AVAILABLE),t?.quotation?.quotationFile&&(a.quotation=this.productStatus.AVAILABLE),t?.quotation?.dateOfPriceAdded&&(a.dateOfPriceAdded=this.productStatus.AVAILABLE),!t?.doesCompanySell)for(const t in a)a[t]=this.productStatus.NOT_PRODUCED;return a},startFollowUp(t){this.openStatusUpdateModal(t)},goToCompanyDetailsPage(t){this.$router.push(`/dashboard/companies/${t}`)},openStatusUpdateModal(t){this.$bus.$emit("research-status-modal",{showModal:!0,companyData:t,marketResearchId:this.marketResearchData?._id,marketResearchSettings:{...this.marketResearchData?.settings,dateStart:this.marketResearchData?.dateStart},statusOptions:this.marketResearchData?.statusOptions})},addPriceForProduct(t,a){this.$bus.$emit("research-status-modal",{showModal:!0,companyData:t,marketResearchId:this.marketResearchData?._id,productId:a?.productId,marketResearchSettings:{...this.marketResearchData?.settings,dateStart:this.marketResearchData?.dateStart},statusOptions:this.marketResearchData?.statusOptions})},showMoreFollowUps(t){this.$bus.$emit("more-follow-ups-modal",{showModal:!0,companyId:t?.companyId,marketResearchId:this.marketResearchData?._id})}}}),o=s,r=(0,e(81656).A)(o,(function(){var t=this,a=t._self._c;return a("div",{staticClass:"mb-spacing-500 flex flex-col-reverse gap-spacing-200 py-spacing-100 ipadPro:flex-row ipadPro:gap-spacing-0",attrs:{id:`company-${t.companyData?.companyId}`}},[a("div",{staticClass:"flex flex-[0.4] flex-col"},[0===t.companyData?.followUpHistory?.recentFollowUps?.length?a("div",{staticClass:"flex flex-1 items-center justify-center"},[a("div",{on:{click:function(a){return t.startFollowUp(t.companyData)}}},[a("GeneralButton",{attrs:{"button-type":"button",type:"brand",size:"small",emphasis:"secondary","icon-position":"none",label:"Start Follow Up"}})],1)]):a("div",[a("div",{staticClass:"flex flex-col gap-spacing-100 px-spacing-200 py-spacing-100 ipad:px-spacing-300"},[a("div",{staticClass:"flex items-center gap-spacing-100"},[a("p",{staticClass:"text-body/l/relaxed/400 text-content-on-neutral-secondary"},[t._v(" Status: ")]),a("p",{staticClass:"text-body/l/relaxed/400 text-content-on-neutral-primary"},[t._v(" "+t._s(t.companyData?.followUpHistory?.status)+" ")])]),a("div",{staticClass:"flex items-center justify-between"},[a("div",{staticClass:"flex items-center gap-spacing-100"},[a("p",{staticClass:"text-body/l/relaxed/400 text-content-on-neutral-secondary"},[t._v(" Next Follow Up: ")]),a("p",{staticClass:"text-body/l/relaxed/400 text-content-on-neutral-primary"},[t._v(" "+t._s(t._f("toDate")(t.companyData?.followUpHistory?.nextFollowUpDate))+" ")])]),a("div",{on:{click:function(a){return t.startFollowUp(t.companyData)}}},[a("GeneralButton",{attrs:{"button-type":"button",type:"success",size:"small",emphasis:"secondary","icon-position":"none",label:"Add"}})],1)])]),a("div",{staticClass:"mx-spacing-200 my-spacing-100 border-b border-constant-brand-primary ipad:mx-spacing-300"}),a("div",{staticClass:"flex gap-spacing-200"},[a("ClassicTable",{attrs:{headers:t.followUpHeaders,"bg-class":"bg-transparent"},scopedSlots:t._u([{key:"table-body",fn:function(){return t._l(t.companyData?.followUpHistory?.recentFollowUps,(function(e,s){return a("tr",{key:s,staticClass:"text-left text-body/m/relaxed/400 text-content-on-neutral-primary nexus:text-body/l/relaxed/400"},[a("td",{staticClass:"flex flex-col gap-spacing-25 py-spacing-100 pr-spacing-100"},[t._v(" "+t._s(t._f("toDate")(e?.date))+" ")]),a("td",{staticClass:"py-spacing-100 pr-spacing-100"},[t._v(" "+t._s(e?.note||"------------")+" ")])])}))},proxy:!0}])})],1),t.companyData?.followUpHistory?.hasMoreFollowUps?a("div",{staticClass:"mt-spacing-100 px-spacing-200 ipad:px-spacing-300",on:{click:function(a){return t.showMoreFollowUps(t.companyData)}}},[a("GeneralButton",{attrs:{"button-type":"button",type:"brand",size:"large",emphasis:"tertiary","icon-position":"none",label:"View More"}})],1):t._e()])]),a("div",{staticClass:"hidden w-0 border-r border-stroke-bold ipad:block"}),a("div",{staticClass:"flex-[0.6] text-body/l/relaxed/400 text-content-on-neutral-primary"},[a("p",{staticClass:"mb-spacing-150 flex items-center gap-spacing-100 px-spacing-200 text-body/l/relaxed/500 ipad:px-spacing-300"},[a("span",{staticClass:"cursor-pointer hover:text-hover-constant-brand-primary",domProps:{innerHTML:t._s(t.$highlightMatch(t.companyData?.companyName,t.searchQuery))},on:{click:function(a){return a.stopPropagation(),t.goToCompanyDetailsPage(t.companyData?.companyId)}}}),a("span",{staticClass:"h-0 flex-1 border-b border-constant-brand-primary"})]),a("ClassicTable",{attrs:{headers:t.headers,"bg-class":"bg-transparent","header-class":"first:pl-spacing-200 ipad:first:pl-spacing-300","horizontal-padding":"px-spacing-0"},scopedSlots:t._u([{key:"table-body",fn:function(){return t._l(t.companyData?.products,(function(e,s){return a("tr",{key:s,staticClass:"text-left text-body/m/relaxed/400 text-content-on-neutral-primary nexus:text-body/l/relaxed/400",class:{"cursor-pointer hover:bg-bg-neutral-sunken":t.getProductDetailsStatus(e)?.price===t.productStatus.AVAILABLE||t.getProductDetailsStatus(e)?.price===t.productStatus.NOT_ADDED},attrs:{id:e?.quotation?.variableId?`company-${t.companyData?.companyId}-product-${e?.quotation?.variableId?._id}`:`company-${t.companyData?.companyId}-product-${e?.productId}`},on:{click:function(a){e?.doesCompanySell&&t.addPriceForProduct(t.companyData,e)}}},[a("td",{staticClass:"py-spacing-100 pl-spacing-200 pr-spacing-100 ipad:pl-spacing-300"},[a("div",{staticClass:"flex flex-col gap-spacing-25"},[a("span",{class:{"text-content-on-neutral-tertiary":t.getProductDetailsStatus(e)?.price===t.productStatus.NOT_PRODUCED,"text-content-on-status-on-warning":t.getProductDetailsStatus(e)?.price===t.productStatus.NOT_ADDED}},[t._v(t._s(e?.productName))]),a("p",{staticClass:"min-h-spacing-100"},e?.quotation?.variableId?[a("span",{staticClass:"text-body/s/relaxed/400 italic nexus:text-body/m/relaxed/400",class:{"text-content-on-neutral-secondary":t.getProductDetailsStatus(e)?.price===t.productStatus.AVAILABLE,"text-content-on-neutral-tertiary":t.getProductDetailsStatus(e)?.price===t.productStatus.NOT_PRODUCED,"text-content-on-status-on-warning":t.getProductDetailsStatus(e)?.price===t.productStatus.NOT_ADDED}},[t._v(" ["+t._s(e?.quotation?.variableId?.name)+", "+t._s(e?.quotation?.variableId?.coefficient)+"] ")])]:[a("span",{staticClass:"text-body/s/relaxed/400 italic nexus:text-body/m/relaxed/400",class:{"text-content-on-neutral-secondary":t.getProductDetailsStatus(e)?.price===t.productStatus.AVAILABLE,"text-content-on-neutral-tertiary":t.getProductDetailsStatus(e)?.price===t.productStatus.NOT_PRODUCED,"text-content-on-status-on-warning":t.getProductDetailsStatus(e)?.price===t.productStatus.NOT_ADDED}},[t._v(" [default, 1] ")])])])]),t.getProductDetailsStatus(e)?.dateOfPriceAdded===t.productStatus.AVAILABLE?a("td",{staticClass:"py-spacing-100 pr-spacing-100"},[t._v(" "+t._s(t._f("toDate")(e?.quotation?.dateOfPriceAdded))+" ")]):t.getProductDetailsStatus(e)?.dateOfPriceAdded===t.productStatus.NOT_PRODUCED?a("td",{staticClass:"py-spacing-100 pr-spacing-100 text-content-on-neutral-tertiary"},[t._v(" "+t._s(t.productStatus.NOT_PRODUCED)+" ")]):t.getProductDetailsStatus(e)?.dateOfPriceAdded===t.productStatus.NOT_ADDED?a("td",{staticClass:"py-spacing-100 pr-spacing-100 text-content-on-status-on-warning"},[t._v(" "+t._s(t.productStatus.NOT_ADDED)+" ")]):t._e(),t.getProductDetailsStatus(e)?.price===t.productStatus.AVAILABLE?a("td",{staticClass:"py-spacing-100 pr-spacing-100"},[t._v(" "+t._s(t._f("toCurrency")(e?.quotation?.price))+" ")]):t.getProductDetailsStatus(e)?.price===t.productStatus.NOT_PRODUCED?a("td",{staticClass:"py-spacing-100 pr-spacing-100 text-content-on-neutral-tertiary"},[t._v(" "+t._s(t.productStatus.NOT_PRODUCED)+" ")]):t.getProductDetailsStatus(e)?.price===t.productStatus.NOT_ADDED?a("td",{staticClass:"py-spacing-100 pr-spacing-100 text-content-on-status-on-warning"},[t._v(" "+t._s(t.productStatus.NOT_ADDED)+" ")]):t._e(),t.getProductDetailsStatus(e)?.unit===t.productStatus.AVAILABLE?a("td",{staticClass:"py-spacing-100 pr-spacing-100"},[t._v(" "+t._s(t._f("toCurrency")(e?.productUnit))+" ")]):t.getProductDetailsStatus(e)?.unit===t.productStatus.NOT_PRODUCED?a("td",{staticClass:"py-spacing-100 pr-spacing-100 text-content-on-neutral-tertiary"},[t._v(" "+t._s(t.productStatus.NOT_PRODUCED)+" ")]):t.getProductDetailsStatus(e)?.unit===t.productStatus.NOT_ADDED?a("td",{staticClass:"py-spacing-100 pr-spacing-100 text-content-on-status-on-warning"},[t._v(" "+t._s(t.productStatus.NOT_ADDED)+" ")]):t._e(),t.getProductDetailsStatus(e)?.score===t.productStatus.AVAILABLE?a("td",{staticClass:"py-spacing-100 pr-spacing-100"},[t._v(" "+t._s(t._f("toPercentage")(e?.quotation?.score,!0))+" ")]):t.getProductDetailsStatus(e)?.score===t.productStatus.NOT_PRODUCED?a("td",{staticClass:"py-spacing-100 pr-spacing-100 text-content-on-neutral-tertiary"},[t._v(" "+t._s(t.productStatus.NOT_PRODUCED)+" ")]):t.getProductDetailsStatus(e)?.score===t.productStatus.NOT_ADDED?a("td",{staticClass:"py-spacing-100 pr-spacing-100 text-content-on-status-on-warning"},[t._v(" "+t._s(t.productStatus.NOT_ADDED)+" ")]):t._e(),t.getProductDetailsStatus(e)?.quotation===t.productStatus.AVAILABLE?a("td",{staticClass:"py-spacing-100 pr-spacing-100"},[a("DownloadAndView",{attrs:{file:e?.quotation?.quotationFile}})],1):t.getProductDetailsStatus(e)?.quotation===t.productStatus.NOT_PRODUCED?a("td",{staticClass:"py-spacing-100 pr-spacing-100 text-content-on-neutral-tertiary"},[t._v(" "+t._s(t.productStatus.NOT_PRODUCED)+" ")]):t.getProductDetailsStatus(e)?.quotation===t.productStatus.NOT_ADDED?a("td",{staticClass:"py-spacing-100 pr-spacing-100 text-content-on-status-on-warning"},[t._v(" "+t._s(t.productStatus.NOT_ADDED)+" ")]):t._e()])}))},proxy:!0}])})],1)])}),[],!1,null,null,null),n=r.exports}}]);