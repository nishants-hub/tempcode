"use strict";(self.webpackChunkconstruction_commercial_search_frontend=self.webpackChunkconstruction_commercial_search_frontend||[]).push([[9007],{29007:function(t,e,o){o.r(e),o.d(e,{default:function(){return c}});var n=o(78626),i=o(32378),s={components:{FormInput:()=>o.e(6342).then(o.bind(o,96342)),GeneralRemovableItem:()=>o.e(7349).then(o.bind(o,57349))},props:{dropdownLabel:{type:String,required:!0},dropdownId:{type:String,required:!0},locations:{type:Array,required:!1,default:()=>[]},selectedLocation:{type:Object,required:!1,default:null},isMultiSelect:{type:Boolean,required:!1,default:!1}},data(){return{location:this.selectedLocation?.display_name,locationSuggestions:[],isLocationSuggestionsFetching:!1,fetchDebouncedLocationSuggestions:(0,n.debounce)(this.fetchLocationSuggestions,300)}},watch:{selectedLocation(){this.location=this.selectedLocation?.display_name}},methods:{async fetchLocationSuggestions(t){if(t.length<2)return void(this.locationSuggestions=[]);this.isLocationSuggestionsFetching=!0;const e=`https://nominatim.openstreetmap.org/search?q=${encodeURIComponent(t)}&format=json`,o=await i.A.get(e);this.locationSuggestions=o.data?.map((t=>({display_name:t?.display_name,lat:t?.lat,lon:t?.lon}))),this.isLocationSuggestionsFetching=!1},handleSelect(t){this.isMultiSelect?this.addLocationToSelection(t):this.setLocation(t)},addLocationToSelection(t){if(!this.locations.some((e=>e.lat===t.lat&&e.lon===t.lon))){let e=[...this.locations,t];this.$emit("on-locations-update",e)}this.location=""},removeLocationFromSelection(t){let e=this.locations.filter((e=>e.lat!==t.lat||e.lon!==t.lon));this.$emit("on-locations-update",e)},handleReset(t){this.isMultiSelect&&!t||(this.locationSuggestions=[])},setLocation(t){this.location=t?.display_name,this.$emit("on-location-update",t)},handleClearButtonPress(){this.$emit("on-location-update",null)}}},a=s,l=(0,o(81656).A)(a,(function(){var t=this,e=t._self._c;return e("div",[t.isMultiSelect&&t.locations.length>0?e("div",{staticClass:"mb-spacing-250 flex w-full flex-wrap gap-spacing-150"},t._l(t.locations,(function(o){return e("GeneralRemovableItem",{key:o.lat+o.lon,attrs:{"item-name":o?.display_name},on:{"on-item-removed":function(e){return t.removeLocationFromSelection(o)}}})})),1):t._e(),e("FormInput",{attrs:{label:t.dropdownLabel,"input-type":"searchable-input",inputId:t.dropdownId,"prevent-v-model":!0,"clear-button":!!t.location,suggestions:t.locationSuggestions,"is-suggestions-fetching":t.isLocationSuggestionsFetching},on:{"set-suggestion":t.handleSelect,"reset-suggestions":t.handleReset,"fetch-suggestions":t.fetchDebouncedLocationSuggestions,"enter-pressed":function(e){return t.$emit("enter-pressed")},"clear-button-press":t.handleClearButtonPress},model:{value:t.location,callback:function(e){t.location=e},expression:"location"}})],1)}),[],!1,null,null,null),c=l.exports}}]);