"use strict";(self.webpackChunkconstruction_commercial_search_frontend=self.webpackChunkconstruction_commercial_search_frontend||[]).push([[7084,6277],{76277:function(t,e,a){a.r(e),a.d(e,{default:function(){return s}});var n={props:{heading:{type:String,required:!1},subHeading:{type:String,required:!1},showCloseButton:{type:Boolean,default:!0},showBackButton:{type:Boolean,default:!1},showSubmitButton:{type:Boolean,default:!0},submitButtonLabel:{type:String,default:"Add"},submitButtonType:{type:String,default:"success"},submitButtonDisabled:{type:Boolean,default:!1,required:!1},isFormSubmitting:{type:Boolean,default:!1},formType:{type:String,default:"input"},customButtons:{type:Array,default:()=>[]},showCustomButtons:{type:Boolean,default:!1}},components:{IconX:()=>a.e(6847).then(a.bind(a,96847)),IconArrowLeft:()=>a.e(8625).then(a.bind(a,78625)),GeneralButton:()=>a.e(695).then(a.bind(a,90695))},methods:{handleSubmit(t){t?this.$emit("form-submitted",t):this.$emit("form-submitted")},handleBack(){this.$emit("back-pressed")},handleClose(){this.$emit("close-pressed")}}},o=n,i=(0,a(81656).A)(o,(function(){var t=this,e=t._self._c;return e("form",{staticClass:"relative flex h-full w-full flex-col bg-bg-neutral-default ipad:max-h-[90dvh]",on:{submit:function(e){return e.preventDefault(),t.handleSubmit()}}},[e("div",{staticClass:"sticky top-spacing-0 z-[100] w-full bg-bg-neutral-default px-spacing-200 pb-spacing-200 pt-spacing-300 ipad:px-spacing-300 ipad:pt-spacing-400"},[t.showBackButton?e("div",{staticClass:"absolute left-spacing-200 top-spacing-300 cursor-pointer ipad:left-spacing-300",on:{click:function(e){return t.handleBack()}}},[e("IconArrowLeft",{staticClass:"h-spacing-300 w-spacing-300 text-content-on-neutral-secondary hover:text-content-on-neutral-primary"})],1):t._e(),t.heading?e("h2",{staticClass:"m-auto max-w-[85%] text-center text-overline/l/relaxed/500 text-content-on-neutral-secondary ipad:text-overline/xl/relaxed/500"},[t._v(" "+t._s(t.heading?.toUpperCase())+" "),t.subHeading?e("p",{staticClass:"text-body/m/relaxed/400 text-content-on-neutral-tertiary"},[t._v(" "+t._s(t.subHeading)+" ")]):t._e()]):t._e(),t.showCloseButton?e("div",{staticClass:"absolute right-spacing-200 top-spacing-300 cursor-pointer ipad:right-spacing-300",on:{click:function(e){return t.handleClose()}}},[e("IconX",{staticClass:"h-spacing-300 w-spacing-300 text-content-on-neutral-secondary hover:text-content-on-neutral-primary"})],1):t._e()]),e("div",{staticClass:"relative flex-1 overflow-y-auto px-spacing-200 py-spacing-50 ipad:px-spacing-300"},[t._t("form-body")],2),t.showSubmitButton&&!t.showCustomButtons?e("div",{staticClass:"sticky bottom-0 z-[100] flex w-full items-center gap-spacing-200 bg-bg-neutral-default px-spacing-200 pb-spacing-200 pt-spacing-200 ipad:px-spacing-300"},["delete"===t.formType?e("div",{staticClass:"flex-1",on:{click:function(e){return t.handleClose()}}},[e("GeneralButton",{attrs:{"button-type":"button",type:"neutral",size:"large",emphasis:"primary","icon-position":"none",label:"Cancel","is-loading":!1,"is-disabled":!1}})],1):t._e(),e("div",{staticClass:"flex-1",on:{click:function(e){return t.handleSubmit()}}},[e("GeneralButton",{attrs:{"button-type":"button",type:t.submitButtonType,size:"large",emphasis:"primary","icon-position":"none",label:t.submitButtonLabel,"is-loading":t.isFormSubmitting,"is-disabled":t.submitButtonDisabled}})],1)]):t.showCustomButtons&&t.customButtons?.length>0?e("div",{staticClass:"sticky bottom-0 z-[100] flex w-full items-center gap-spacing-200 bg-bg-neutral-default px-spacing-200 pb-spacing-200 pt-spacing-200 ipad:px-spacing-300"},t._l(t.customButtons,(function(a,n){return e("GeneralButton",{key:n,staticClass:"flex-1",attrs:{"button-type":"button",type:a?.type,size:"large",emphasis:a?.emphasis,"icon-position":"none",label:a?.label,"is-loading":t.isFormSubmitting,"is-disabled":a?.isDisabled},nativeOn:{click:function(e){return t.handleSubmit(a?.payload)}}})})),1):t._e()])}),[],!1,null,null,null),s=i.exports},11645:function(t,e,a){a.r(e),a.d(e,{default:function(){return p}});var n=(a(44114),a(76277)),o=a(66886),i=a.n(o),s=a(91943),l=a(94373),r=a(78626),c={props:{mapContainerId:{type:String,required:!0},selectedLocationCoords:{type:Object,required:!1,default:()=>({})}},data:()=>({map:null,markers:[],userLocation:[],selectedLocation:null,selectionMarker:null,update:!1}),components:{GeneralForm:n.default},async mounted(){try{await this.initMap()}catch(t){this.$toast.error("Error initializing the map. Please try again."),console.error("Error initializing map:",t)}},methods:{async initMap(){try{if(this.map=(0,s.Ls)(this.mapContainerId),!this.map)throw new Error("Map initialization failed");this.userLocation=await(0,s.Lu)(),this.addMarker(this.userLocation,"You are here",!0),this.selectedLocationCoords?.lat&&this.selectedLocationCoords?.lon&&(this.selectedLocation={lat:this.selectedLocationCoords.lat,lon:this.selectedLocationCoords.lon},await this.fetchLocation(this.selectedLocationCoords.lat,this.selectedLocationCoords.lon)),this.map.on("click",this.onMapClick)}catch(t){this.$toast.error(t)}},clearMarkers(){this.markers.forEach((t=>this.map.removeLayer(t))),this.markers=[]},addMarker(t,e,a=!1){const n=i().marker(t).addTo(this.map);n.bindPopup(`<div class="text-content-on-neutral-primary text-body/l/relaxed/500 bg-bg-neutral-raised w-full h-full font-sans">${e}</div>`),a&&n.openPopup(),this.markers.push(n)},onMapClick(t){const{lat:e,lng:a}=t.latlng;this.selectedLocation={lat:e,lon:a},this.debouncedFetchLocation(e,a)},async fetchLocation(t,e){try{this.updateSelectionMarker([t,e],'<span class="text-constant-brand-primary">Fetching Location...</span>');const{data:a}=await l.A.get("https://nominatim.openstreetmap.org/reverse",{params:{lat:t,lon:e,format:"json"}}),n=a?.display_name||`Lat: ${t?.toFixed(5)}, Long: ${e?.toFixed(5)}`;this.selectedLocation={lat:t,lon:e,display_name:n},this.updateSelectionMarker([t,e],`Selected Location: <br/><span class="text-body/m/relaxed/400">${n}</span>`)}catch(a){this.$toast.error("Failed to fetch the location details. Please try again."),this.selectedLocation={lat:t,lon:e,display_name:null},this.updateSelectionMarker([t,e],`Lat: ${t?.toFixed(5)}, Long: ${e?.toFixed(5)}`)}},debouncedFetchLocation:(0,r.debounce)((function(t,e){this.fetchLocation(t,e)}),500),updateSelectionMarker(t,e){this.selectionMarker&&this.map.removeLayer(this.selectionMarker),this.selectionMarker=i().marker(t,{draggable:!0}).addTo(this.map),this.selectionMarker.bindPopup(`<div class="text-content-on-neutral-primary text-body/l/relaxed/500 bg-bg-neutral-raised w-full h-full font-sans">${e}</div>`).openPopup(),this.selectionMarker.on("dragend",(t=>{const{lat:e,lng:a}=t?.target?.getLatLng();this.selectedLocation={lat:e,lon:a},this.debouncedFetchLocation(e,a)}))},handleSubmit(){this.selectedLocation?(this.$bus.$emit("set-company-location",this.selectedLocation),this.handleClose()):this.$toast.error("Please select a location before submitting.")},handleClose(){this.$bus.$emit("company-map-modal",!1)}},beforeDestroy(){this.map&&(this.map.off(),this.map.remove())}},d=c,u=(0,a(81656).A)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex h-full min-h-[90dvh] w-full flex-col"},[e("GeneralForm",{staticClass:"flex-1",attrs:{heading:t.update?"Update Location":"Select Location","sub-heading":"Click on map to select a location",showCloseButton:!1,"submit-button-label":"Confirm"},on:{"form-submitted":t.handleSubmit},scopedSlots:t._u([{key:"form-body",fn:function(){return[t.selectedLocation?e("p",{staticClass:"mb-spacing-200 text-body/m/relaxed/400 text-content-on-neutral-primary"},[e("span",{staticClass:"text-body/l/relaxed/500"},[t._v("Selected Location: ")]),t._v(" "+t._s(`${t.selectedLocation?.display_name||""} (Lat: ${Number(t.selectedLocation?.lat)?.toFixed(2)}, Long: ${Number(t.selectedLocation?.lon)?.toFixed(2)})`)+" ")]):t._e(),e("div",{staticClass:"pointer-events-auto h-full w-full flex-1 cursor-default rounded-12 shadow-card",attrs:{id:t.mapContainerId}})]},proxy:!0}])})],1)}),[],!1,null,null,null),p=u.exports}}]);