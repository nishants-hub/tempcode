"use strict";(self.webpackChunkconstruction_commercial_search_frontend=self.webpackChunkconstruction_commercial_search_frontend||[]).push([[8118],{98118:function(t,e,s){s.r(e),s.d(e,{default:function(){return u}});var i=s(78626),o=s(93518),r={components:{GeneralRemovableItem:()=>s.e(7349).then(s.bind(s,57349)),FormInput:()=>s.e(6342).then(s.bind(s,96342)),ProductSelectModal:()=>s.e(1212).then(s.bind(s,11212))},props:{products:{type:Array,required:!1,default:()=>[]},selectedProduct:{type:Object,required:!1,default:null},dropdownLabel:{type:String,required:!0},dropdownId:{type:String,required:!0},isMultiSelect:{type:Boolean,required:!1,default:!1},showSelectedList:{type:Boolean,required:!1,default:!0},showError:{type:Boolean,required:!1,default:!0},verticalPadding:{type:String,required:!1},blackListed:{type:Array,required:!1,default:()=>[]},companyId:{type:String},showSelectButton:{type:Boolean,required:!1,default:!0}},data(){return{product:this.selectedProduct?.originalTitle||"",productSuggestions:[],isProductSuggestionsFetching:!1,fetchDebouncedProductSuggestions:(0,i.debounce)(this.fetchProductSuggestions,300),selectHandler:null,id:Date.now()}},mounted(){this.selectHandler=t=>{t?.products&&t?.id===this.id&&this.$emit("on-products-update",t?.products)},this.showSelectButton&&this.isMultiSelect&&this.$bus.$on("selected-products-from-product-select",this.selectHandler)},watch:{selectedProduct(){this.product=this.selectedProduct?.originalTitle}},computed:{getFilteredProductSuggestions(){let t;return t=this.isMultiSelect?this.productSuggestions?.filter((t=>!this.products?.some((e=>e?._id===t?._id)))):this.productSuggestions?.filter((t=>this.selectedProduct?._id!==t?._id)),this.blackListed?.length>0&&(t=t?.filter((t=>!this.blackListed.includes(t?._id)))),t}},methods:{...(0,o.i0)("category",["getProductSuggestions"]),openProductSelectModal(){this.$bus.$emit("product-select-modal",{showModal:!0,products:[...this.products],id:this.id})},async fetchProductSuggestions(t){if(""===t)return void(this.productSuggestions=[]);this.isProductSuggestionsFetching=!0;const e=await this.getProductSuggestions({params:{searchTerm:t?.trim(),companyId:this.companyId?this.companyId:void 0}});this.productSuggestions=e?.map((t=>({display_name:t?.title,_id:t?.id,tree_view:!0,is_html:!0,path:t?.path,originalTitle:t?.originalTitle}))),this.isProductSuggestionsFetching=!1},handleReset(t){this.isMultiSelect&&!t||(this.productSuggestions=[])},handleSelect(t){this.isMultiSelect?this.addProductToProducts(t):this.selectProduct(t)},selectProduct(t){this.product=t?.display_name,this.$emit("on-product-update",t)},addProductToProducts(t){let e=[...this.products,t];this.$emit("on-products-update",e)},removeProductFromProducts(t){let e=this.products.filter((e=>e?._id!==t?._id));this.$emit("on-products-update",e)}},beforeDestroy(){this.$bus.$off("selected-products-from-product-select",this.selectHandler),this.selectHandler=null}},d=r,c=(0,s(81656).A)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-full"},[t.isMultiSelect&&t.showSelectedList&&t.products?.length>0?e("div",{staticClass:"mb-spacing-250 flex w-full flex-wrap gap-spacing-150"},t._l(t.products,(function(s){return e("GeneralRemovableItem",{key:s?._id,attrs:{"item-name":s?.originalTitle},on:{"on-item-removed":function(e){return t.removeProductFromProducts(s)}}})})),1):t._e(),e("div",{staticClass:"flex items-stretch gap-spacing-200"},[e("FormInput",{attrs:{label:t.dropdownLabel,"input-type":"searchable-input",inputId:t.dropdownId,"prevent-v-model":!0,"clear-button":!!t.product,suggestions:t.getFilteredProductSuggestions,"vertical-padding":t.verticalPadding,"show-error":t.showError,"is-suggestions-fetching":t.isProductSuggestionsFetching},on:{"set-suggestion":t.handleSelect,"reset-suggestions":t.handleReset,"fetch-suggestions":t.fetchDebouncedProductSuggestions,"enter-pressed":function(e){return t.$emit("enter-pressed")}},model:{value:t.product,callback:function(e){t.product=e},expression:"product"}}),t.showSelectButton&&t.isMultiSelect?e("div",{staticClass:"flex max-h-spacing-500 cursor-pointer items-center justify-center",on:{click:t.openProductSelectModal}},[e("i",{staticClass:"fa-solid fa-list-ul relative scale-[1.2] text-constant-brand-primary hover:text-hover-constant-brand-primary"})]):t._e()],1),e("ProductSelectModal")],1)}),[],!1,null,null,null),u=c.exports}}]);