{"version":3,"file":"js/537.36630f7c.js","mappings":"2NAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,YAAY,qDAAqDC,MAAM,CAAC,GAAKL,EAAIM,iBAC9J,EACIC,EAAkB,G,0CCatB,GACAC,MAAA,CACAC,YAAA,CACAC,KAAAC,MACAC,QAAAA,IAAA,IAEAN,eAAA,CACAI,KAAAG,OACAC,UAAA,IAGAC,IAAAA,GACA,OACAC,IAAA,KACAC,QAAA,GACAC,MAAA,GACAC,aAAA,GAEA,EACAC,MAAA,CACAX,WAAAA,GACA,KAAAO,KACA,KAAAK,kBAEA,GAEA,aAAAC,GACA,KAAAhB,sBACA,KAAAiB,SAEA,EACAC,QAAA,CACA,aAAAD,GACA,IACA,KAAAP,KAAAS,EAAAA,EAAAA,IAAA,KAAAnB,gBACA,KAAAa,mBAAAO,EAAAA,EAAAA,MACA,MAAAC,EAAAC,IAAAA,OAAA,KAAAT,cAAAU,MAAA,KAAAb,KACAW,EACAG,UACA,wIAEAC,YACA,KAAAV,kBACA,OAAAW,GACA,CAEA,EAEA,sBAAAX,GAEA,KAAAJ,QAAAgB,SAAAC,GAAA,KAAAlB,IAAAmB,YAAAD,KACA,KAAAhB,MAAAe,SAAAG,GAAA,KAAApB,IAAAmB,YAAAC,KACA,KAAAnB,QAAA,GACA,KAAAC,MAAA,GAEA,UAAAmB,KAAA,KAAA5B,YACA,GAAA4B,EAAAC,KAAAD,EAAAE,KAAA,CACA,MAAAC,EAAA,CAAAH,EAAAC,IAAAD,EAAAE,MACAL,EAAAN,IAAAA,OAAAY,GAAAX,MAAA,KAAAb,KAEA,IAAAyB,EAAA,EACA,QAAAtB,cAAAuB,OAAA,CACAD,QAAAE,EAAAA,EAAAA,GACAH,EACA,KAAArB,cAEA,MAAAiB,EAAAR,IAAAA,SAAA,MAAAT,aAAAqB,GAAA,CACAI,MAAA,kCACAf,MAAA,KAAAb,KACA,KAAAE,MAAA2B,KAAAT,EACA,CAEAF,EAAAJ,UACA,wHACAO,EAAAS,aAAA,sDAEAL,EAAAM,QAAA,qCACAV,EAAAA,UAAA,eAEA,KAAApB,QAAA4B,KAAAX,EACA,CAGA,QAAAjB,QAAAyB,OAAA,GACA,MAAAM,EAAA,IAAApB,IAAAA,cAAA,KAAAX,SACA,KAAAD,IAAAiC,UAAAD,EAAAE,YACA,CACA,GAEAC,aAAAA,GACA,KAAAnC,MACA,KAAAA,IAAAoC,MACA,KAAApC,IAAAqC,SAEA,GC7G6P,I,WCOzPC,GAAY,OACd,EACAvD,EACAQ,GACA,EACA,KACA,KACA,MAIF,EAAe+C,EAAiB,O","sources":["webpack://construction-commercial-search-frontend/./src/components/MapComponent/index.vue","webpack://construction-commercial-search-frontend/src/components/MapComponent/index.vue","webpack://construction-commercial-search-frontend/./src/components/MapComponent/index.vue?3710","webpack://construction-commercial-search-frontend/./src/components/MapComponent/index.vue?00ad"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"h-full min-h-[90dvh] w-full rounded-12 shadow-card\",attrs:{\"id\":_vm.mapContainerId}})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div\r\n    :id=\"mapContainerId\"\r\n    class=\"h-full min-h-[90dvh] w-full rounded-12 shadow-card\"\r\n  ></div>\r\n</template>\r\n\r\n<script>\r\nimport L from \"leaflet\";\r\nimport {\r\n  getCurrentLocation,\r\n  calculateDistanceTo,\r\n  initializeMap,\r\n} from \"@/utilities/helpers/locationServices\";\r\n\r\nexport default {\r\n  props: {\r\n    markersData: {\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    mapContainerId: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      map: null,\r\n      markers: [],\r\n      lines: [],\r\n      userLocation: [],\r\n    };\r\n  },\r\n  watch: {\r\n    markersData() {\r\n      if (this.map) {\r\n        this.updateMapMarkers();\r\n      }\r\n    },\r\n  },\r\n  async mounted() {\r\n    if (this.mapContainerId) {\r\n      await this.initMap();\r\n    }\r\n  },\r\n  methods: {\r\n    async initMap() {\r\n      try {\r\n        this.map = initializeMap(this.mapContainerId);\r\n        this.userLocation = await getCurrentLocation();\r\n        const userMarker = L.marker(this.userLocation).addTo(this.map);\r\n        userMarker\r\n          .bindPopup(\r\n            `<div class=\"text-content-on-neutral-primary text-body/l/relaxed/500 bg-bg-neutral-raised w-full h-full font-sans\">You are here</div>`,\r\n          )\r\n          .openPopup();\r\n        this.updateMapMarkers();\r\n      } catch (error) {\r\n        // this.$toast.error(error);\r\n      }\r\n    },\r\n\r\n    async updateMapMarkers() {\r\n      // Clear old markers and lines\r\n      this.markers.forEach((marker) => this.map.removeLayer(marker));\r\n      this.lines.forEach((line) => this.map.removeLayer(line));\r\n      this.markers = [];\r\n      this.lines = [];\r\n\r\n      for (const location of this.markersData) {\r\n        if (location.lat && location.long) {\r\n          const companyLocation = [location.lat, location.long];\r\n          const marker = L.marker(companyLocation).addTo(this.map);\r\n\r\n          let distance = 0;\r\n          if (this.userLocation?.length) {\r\n            distance = await calculateDistanceTo(\r\n              companyLocation,\r\n              this.userLocation,\r\n            );\r\n            const line = L.polyline([this.userLocation, companyLocation], {\r\n              color: \"var(--constant-brand-primary)\",\r\n            }).addTo(this.map);\r\n            this.lines.push(line);\r\n          }\r\n\r\n          marker.bindPopup(\r\n            `<div class=\"text-content-on-neutral-primary text-body/l/relaxed/500 bg-bg-neutral-raised w-full h-full font-sans\"><b>${\r\n              location.companyName || \"Name Unavailable\"\r\n            }</b>\r\n            <br/>Distance: ${distance.toFixed(2)} km\r\n            <br/>Location: ${location.location || \"N/A\"}</div>`,\r\n          );\r\n          this.markers.push(marker);\r\n        }\r\n      }\r\n\r\n      if (this.markers.length > 0) {\r\n        const group = new L.featureGroup(this.markers);\r\n        this.map.fitBounds(group.getBounds());\r\n      }\r\n    },\r\n  },\r\n  beforeDestroy() {\r\n    if (this.map) {\r\n      this.map.off();\r\n      this.map.remove();\r\n    }\r\n  },\r\n};\r\n</script>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=a3f4ae70\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","mapContainerId","staticRenderFns","props","markersData","type","Array","default","String","required","data","map","markers","lines","userLocation","watch","updateMapMarkers","mounted","initMap","methods","initializeMap","getCurrentLocation","userMarker","L","addTo","bindPopup","openPopup","error","forEach","marker","removeLayer","line","location","lat","long","companyLocation","distance","length","calculateDistanceTo","color","push","companyName","toFixed","group","fitBounds","getBounds","beforeDestroy","off","remove","component"],"sourceRoot":""}